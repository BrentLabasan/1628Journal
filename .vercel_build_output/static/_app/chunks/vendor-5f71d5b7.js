var t=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function r(){}const i=t=>t;function o(t,e){for(const n in e)t[n]=e[n];return t}function s(t){return t()}function a(){return Object.create(null)}function u(t){t.forEach(s)}function c(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function h(t,e,n){t.$$.on_destroy.push(function(t,...e){if(null==t)return r;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}(e,n))}function f(t,e,n,r){if(t){const i=d(t,e,n,r);return t[0](i)}}function d(t,e,n,r){return t[1]&&r?o(n.ctx.slice(),t[1](r(e))):n.ctx}function p(t,e,n,r,i,o,s){const a=function(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|i[r];return t}return e.dirty|i}return e.dirty}(e,r,i,o);if(a){const i=d(e,n,r,s);t.p(i,a)}}function m(t){return t&&c(t.destroy)?t.destroy:r}const y="undefined"!=typeof window;let g=y?()=>window.performance.now():()=>Date.now(),v=y?t=>requestAnimationFrame(t):r;const b=new Set;function w(t){b.forEach((e=>{e.c(t)||(b.delete(e),e.f())})),0!==b.size&&v(w)}function T(t){let e;return 0===b.size&&v(w),{promise:new Promise((n=>{b.add(e={c:t,f:n})})),abort(){b.delete(e)}}}function E(t,e){t.appendChild(e)}function I(t,e,n){t.insertBefore(e,n||null)}function S(t){t.parentNode.removeChild(t)}function _(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function k(t){return document.createElement(t)}function N(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function D(t){return document.createTextNode(t)}function O(){return D(" ")}function A(){return D("")}function C(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function M(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function x(t,e,n){e in t?t[e]="boolean"==typeof t[e]&&""===n||n:M(t,e,n)}function L(t){return Array.from(t.childNodes)}function P(t,e,n,r){for(let i=0;i<t.length;i+=1){const r=t[i];if(r.nodeName===e){let e=0;const o=[];for(;e<r.attributes.length;){const t=r.attributes[e++];n[t.name]||o.push(t.name)}for(let t=0;t<o.length;t++)r.removeAttribute(o[t]);return t.splice(i,1)[0]}}return r?N(e):k(e)}function R(t,e){for(let n=0;n<t.length;n+=1){const r=t[n];if(3===r.nodeType)return r.data=""+e,t.splice(n,1)[0]}return D(e)}function F(t){return R(t," ")}function V(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function q(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function U(t,e,n){t.classList[n?"add":"remove"](e)}function j(t,e=document.body){return Array.from(e.querySelectorAll(t))}const B=new Set;let z,$=0;function K(t,e,n,r,i,o,s,a=0){const u=16.666/r;let c="{\n";for(let y=0;y<=1;y+=u){const t=e+(n-e)*o(y);c+=100*y+`%{${s(t,1-t)}}\n`}const l=c+`100% {${s(n,1-n)}}\n}`,h=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(l)}_${a}`,f=t.ownerDocument;B.add(f);const d=f.__svelte_stylesheet||(f.__svelte_stylesheet=f.head.appendChild(k("style")).sheet),p=f.__svelte_rules||(f.__svelte_rules={});p[h]||(p[h]=!0,d.insertRule(`@keyframes ${h} ${l}`,d.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?`${m}, `:""}${h} ${r}ms linear ${i}ms 1 both`,$+=1,h}function G(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),$-=i,$||v((()=>{$||(B.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),B.clear())})))}function W(t,e,n,o){if(!e)return r;const s=t.getBoundingClientRect();if(e.left===s.left&&e.right===s.right&&e.top===s.top&&e.bottom===s.bottom)return r;const{delay:a=0,duration:u=300,easing:c=i,start:l=g()+a,end:h=l+u,tick:f=r,css:d}=n(t,{from:e,to:s},o);let p,m=!0,y=!1;function v(){d&&G(t,p),m=!1}return T((t=>{if(!y&&t>=l&&(y=!0),y&&t>=h&&(f(1,0),v()),!m)return!1;if(y){const e=0+1*c((t-l)/u);f(e,1-e)}return!0})),d&&(p=K(t,0,1,u,a,c,d)),a||(y=!0),f(0,1),v}function H(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:r}=e,i=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=r,Q(t,i)}}function Q(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const r=getComputedStyle(t),i="none"===r.transform?"":r.transform;t.style.transform=`${i} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}function Z(t){z=t}function Y(){if(!z)throw new Error("Function called outside component initialization");return z}function J(t){Y().$$.on_mount.push(t)}function X(t){Y().$$.after_update.push(t)}function tt(t,e){Y().$$.context.set(t,e)}function et(t){return Y().$$.context.get(t)}const nt=[],rt=[],it=[],ot=[],st=Promise.resolve();let at=!1;function ut(t){it.push(t)}let ct=!1;const lt=new Set;function ht(){if(!ct){ct=!0;do{for(let t=0;t<nt.length;t+=1){const e=nt[t];Z(e),ft(e.$$)}for(Z(null),nt.length=0;rt.length;)rt.pop()();for(let t=0;t<it.length;t+=1){const e=it[t];lt.has(e)||(lt.add(e),e())}it.length=0}while(nt.length);for(;ot.length;)ot.pop()();at=!1,ct=!1,lt.clear()}}function ft(t){if(null!==t.fragment){t.update(),u(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ut)}}let dt;function pt(t,e,n){t.dispatchEvent(function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(`${e?"intro":"outro"}${n}`))}const mt=new Set;let yt;function gt(){yt={r:0,c:[],p:yt}}function vt(){yt.r||u(yt.c),yt=yt.p}function bt(t,e){t&&t.i&&(mt.delete(t),t.i(e))}function wt(t,e,n,r){if(t&&t.o){if(mt.has(t))return;mt.add(t),yt.c.push((()=>{mt.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const Tt={duration:0};function Et(t,e,n,o){let s=e(t,n),a=o?0:1,l=null,h=null,f=null;function d(){f&&G(t,f)}function p(t,e){const n=t.b-a;return e*=Math.abs(n),{a:a,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function m(e){const{delay:n=0,duration:o=300,easing:c=i,tick:m=r,css:y}=s||Tt,v={start:g()+n,b:e};e||(v.group=yt,yt.r+=1),l||h?h=v:(y&&(d(),f=K(t,a,e,o,n,c,y)),e&&m(0,1),l=p(v,o),ut((()=>pt(t,e,"start"))),T((e=>{if(h&&e>h.start&&(l=p(h,o),h=null,pt(t,l.b,"start"),y&&(d(),f=K(t,a,l.b,l.duration,0,c,s.css))),l)if(e>=l.end)m(a=l.b,1-a),pt(t,l.b,"end"),h||(l.b?d():--l.group.r||u(l.group.c)),l=null;else if(e>=l.start){const t=e-l.start;a=l.a+l.d*c(t/l.duration),m(a,1-a)}return!(!l&&!h)})))}return{run(t){c(s)?(dt||(dt=Promise.resolve(),dt.then((()=>{dt=null}))),dt).then((()=>{s=s(),m(t)})):m(t)},end(){d(),l=h=null}}}function It(t,e){t.f(),function(t,e){wt(t,1,1,(()=>{e.delete(t.key)}))}(t,e)}function St(t,e,n,r,i,o,s,a,u,c,l,h){let f=t.length,d=o.length,p=f;const m={};for(;p--;)m[t[p].key]=p;const y=[],g=new Map,v=new Map;for(p=d;p--;){const t=h(i,o,p),a=n(t);let u=s.get(a);u?r&&u.p(t,e):(u=c(a,t),u.c()),g.set(a,y[p]=u),a in m&&v.set(a,Math.abs(p-m[a]))}const b=new Set,w=new Set;function T(t){bt(t,1),t.m(a,l),s.set(t.key,t),l=t.first,d--}for(;f&&d;){const e=y[d-1],n=t[f-1],r=e.key,i=n.key;e===n?(l=e.first,f--,d--):g.has(i)?!s.has(r)||b.has(r)?T(e):w.has(i)?f--:v.get(r)>v.get(i)?(w.add(r),T(e)):(b.add(i),f--):(u(n,s),f--)}for(;f--;){const e=t[f];g.has(e.key)||u(e,s)}for(;d;)T(y[d-1]);return y}function _t(t,e){const n={},r={},i={$$scope:1};let o=t.length;for(;o--;){const s=t[o],a=e[o];if(a){for(const t in s)t in a||(r[t]=1);for(const t in a)i[t]||(n[t]=a[t],i[t]=1);t[o]=a}else for(const t in s)i[t]=1}for(const s in r)s in n||(n[s]=void 0);return n}function kt(t){return"object"==typeof t&&null!==t?t:{}}function Nt(t){t&&t.c()}function Dt(t,e){t&&t.l(e)}function Ot(t,e,n,r){const{fragment:i,on_mount:o,on_destroy:a,after_update:l}=t.$$;i&&i.m(e,n),r||ut((()=>{const e=o.map(s).filter(c);a?a.push(...e):u(e),t.$$.on_mount=[]})),l.forEach(ut)}function At(t,e){const n=t.$$;null!==n.fragment&&(u(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ct(t,e){-1===t.$$.dirty[0]&&(nt.push(t),at||(at=!0,st.then(ht)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Mt(t,e,n,i,o,s,c=[-1]){const l=z;Z(t);const h=t.$$={fragment:null,ctx:null,props:s,update:r,not_equal:o,bound:a(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:e.context||[]),callbacks:a(),dirty:c,skip_bound:!1};let f=!1;if(h.ctx=n?n(t,e.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return h.ctx&&o(h.ctx[e],h.ctx[e]=i)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](i),f&&Ct(t,e)),n})):[],h.update(),f=!0,u(h.before_update),h.fragment=!!i&&i(h.ctx),e.target){if(e.hydrate){const t=L(e.target);h.fragment&&h.fragment.l(t),t.forEach(S)}else h.fragment&&h.fragment.c();e.intro&&bt(t.$$.fragment),Ot(t,e.target,e.anchor,e.customElement),ht()}Z(l)}class xt{$destroy(){At(this,1),this.$destroy=r}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Lt=[];function Pt(t,e=r){let n;const i=[];function o(e){if(l(t,e)&&(t=e,n)){const e=!Lt.length;for(let n=0;n<i.length;n+=1){const e=i[n];e[1](),Lt.push(e,t)}if(e){for(let t=0;t<Lt.length;t+=2)Lt[t][0](Lt[t+1]);Lt.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(s,a=r){const u=[s,a];return i.push(u),1===i.length&&(n=e(o)||r),s(t),()=>{const t=i.indexOf(u);-1!==t&&i.splice(t,1),0===i.length&&(n(),n=null)}}}}function Rt(t){const e=t-1;return e*e*e+1}function Ft(t){return"[object Date]"===Object.prototype.toString.call(t)}function Vt(t,e,n,r){if("number"==typeof n||Ft(n)){const i=r-n,o=(n-e)/(t.dt||1/60),s=(o+(t.opts.stiffness*i-t.opts.damping*o)*t.inv_mass)*t.dt;return Math.abs(s)<t.opts.precision&&Math.abs(i)<t.opts.precision?r:(t.settled=!1,Ft(n)?new Date(n.getTime()+s):n+s)}if(Array.isArray(n))return n.map(((i,o)=>Vt(t,e[o],n[o],r[o])));if("object"==typeof n){const i={};for(const o in n)i[o]=Vt(t,e[o],n[o],r[o]);return i}throw new Error(`Cannot spring ${typeof n} values`)}function qt(t,e={}){const n=Pt(t),{stiffness:r=.15,damping:i=.8,precision:o=.01}=e;let s,a,u,c=t,l=t,h=1,f=0,d=!1;function p(e,r={}){l=e;const i=u={};if(null==t||r.hard||m.stiffness>=1&&m.damping>=1)return d=!0,s=g(),c=e,n.set(t=l),Promise.resolve();if(r.soft){const t=!0===r.soft?.5:+r.soft;f=1/(60*t),h=0}return a||(s=g(),d=!1,a=T((e=>{if(d)return d=!1,a=null,!1;h=Math.min(h+f,1);const r={inv_mass:h,opts:m,settled:!0,dt:60*(e-s)/1e3},i=Vt(r,c,t,l);return s=e,c=t,n.set(t=i),r.settled&&(a=null),!r.settled}))),new Promise((t=>{a.promise.then((()=>{i===u&&t()}))}))}const m={set:p,update:(e,n)=>p(e(l,t),n),subscribe:n.subscribe,stiffness:r,damping:i,precision:o};return m}class Ut extends Error{}class jt extends Ut{constructor(t){super(`Invalid DateTime: ${t.toMessage()}`)}}class Bt extends Ut{constructor(t){super(`Invalid Interval: ${t.toMessage()}`)}}class zt extends Ut{constructor(t){super(`Invalid Duration: ${t.toMessage()}`)}}class $t extends Ut{}class Kt extends Ut{constructor(t){super(`Invalid unit ${t}`)}}class Gt extends Ut{}class Wt extends Ut{constructor(){super("Zone is an abstract class")}}const Ht="numeric",Qt="short",Zt="long",Yt={year:Ht,month:Ht,day:Ht},Jt={year:Ht,month:Qt,day:Ht},Xt={year:Ht,month:Qt,day:Ht,weekday:Qt},te={year:Ht,month:Zt,day:Ht},ee={year:Ht,month:Zt,day:Ht,weekday:Zt},ne={hour:Ht,minute:Ht},re={hour:Ht,minute:Ht,second:Ht},ie={hour:Ht,minute:Ht,second:Ht,timeZoneName:Qt},oe={hour:Ht,minute:Ht,second:Ht,timeZoneName:Zt},se={hour:Ht,minute:Ht,hour12:!1},ae={hour:Ht,minute:Ht,second:Ht,hour12:!1},ue={hour:Ht,minute:Ht,second:Ht,hour12:!1,timeZoneName:Qt},ce={hour:Ht,minute:Ht,second:Ht,hour12:!1,timeZoneName:Zt},le={year:Ht,month:Ht,day:Ht,hour:Ht,minute:Ht},he={year:Ht,month:Ht,day:Ht,hour:Ht,minute:Ht,second:Ht},fe={year:Ht,month:Qt,day:Ht,hour:Ht,minute:Ht},de={year:Ht,month:Qt,day:Ht,hour:Ht,minute:Ht,second:Ht},pe={year:Ht,month:Qt,day:Ht,weekday:Qt,hour:Ht,minute:Ht},me={year:Ht,month:Zt,day:Ht,hour:Ht,minute:Ht,timeZoneName:Qt},ye={year:Ht,month:Zt,day:Ht,hour:Ht,minute:Ht,second:Ht,timeZoneName:Qt},ge={year:Ht,month:Zt,day:Ht,weekday:Zt,hour:Ht,minute:Ht,timeZoneName:Zt},ve={year:Ht,month:Zt,day:Ht,weekday:Zt,hour:Ht,minute:Ht,second:Ht,timeZoneName:Zt};function be(t){return void 0===t}function we(t){return"number"==typeof t}function Te(t){return"number"==typeof t&&t%1==0}function Ee(){try{return"undefined"!=typeof Intl&&Intl.DateTimeFormat}catch(Ww){return!1}}function Ie(){return!be(Intl.DateTimeFormat.prototype.formatToParts)}function Se(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(Ww){return!1}}function _e(t,e,n){if(0!==t.length)return t.reduce(((t,r)=>{const i=[e(r),r];return t&&n(t[0],i[0])===t[0]?t:i}),null)[1]}function ke(t,e){return e.reduce(((e,n)=>(e[n]=t[n],e)),{})}function Ne(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function De(t,e,n){return Te(t)&&t>=e&&t<=n}function Oe(t,e=2){const n=t<0?"-":"",r=n?-1*t:t;let i;return i=r.toString().length<e?("0".repeat(e)+r).slice(-e):r.toString(),`${n}${i}`}function Ae(t){return be(t)||null===t||""===t?void 0:parseInt(t,10)}function Ce(t){if(!be(t)&&null!==t&&""!==t){const e=1e3*parseFloat("0."+t);return Math.floor(e)}}function Me(t,e,n=!1){const r=10**e;return(n?Math.trunc:Math.round)(t*r)/r}function xe(t){return t%4==0&&(t%100!=0||t%400==0)}function Le(t){return xe(t)?366:365}function Pe(t,e){const n=(r=e-1)-(i=12)*Math.floor(r/i)+1;var r,i;return 2===n?xe(t+(e-n)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function Re(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(e.getUTCFullYear()-1900)),+e}function Fe(t){const e=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7,n=t-1,r=(n+Math.floor(n/4)-Math.floor(n/100)+Math.floor(n/400))%7;return 4===e||3===r?53:52}function Ve(t){return t>99?t:t>60?1900+t:2e3+t}function qe(t,e,n,r=null){const i=new Date(t),o={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(o.timeZone=r);const s=Object.assign({timeZoneName:e},o),a=Ee();if(a&&Ie()){const t=new Intl.DateTimeFormat(n,s).formatToParts(i).find((t=>"timezonename"===t.type.toLowerCase()));return t?t.value:null}if(a){const t=new Intl.DateTimeFormat(n,o).format(i);return new Intl.DateTimeFormat(n,s).format(i).substring(t.length).replace(/^[, \u200e]+/,"")}return null}function Ue(t,e){let n=parseInt(t,10);Number.isNaN(n)&&(n=0);const r=parseInt(e,10)||0;return 60*n+(n<0||Object.is(n,-0)?-r:r)}function je(t){const e=Number(t);if("boolean"==typeof t||""===t||Number.isNaN(e))throw new Gt(`Invalid unit value ${t}`);return e}function Be(t,e,n){const r={};for(const i in t)if(Ne(t,i)){if(n.indexOf(i)>=0)continue;const o=t[i];if(null==o)continue;r[e(i)]=je(o)}return r}function ze(t,e){const n=Math.trunc(Math.abs(t/60)),r=Math.trunc(Math.abs(t%60)),i=t>=0?"+":"-";switch(e){case"short":return`${i}${Oe(n,2)}:${Oe(r,2)}`;case"narrow":return`${i}${n}${r>0?`:${r}`:""}`;case"techie":return`${i}${Oe(n,2)}${Oe(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function $e(t){return ke(t,["hour","minute","second","millisecond"])}const Ke=/[A-Za-z_+-]{1,256}(:?\/[A-Za-z_+-]{1,256}(\/[A-Za-z_+-]{1,256})?)?/;function Ge(t){return JSON.stringify(t,Object.keys(t).sort())}const We=["January","February","March","April","May","June","July","August","September","October","November","December"],He=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Qe=["J","F","M","A","M","J","J","A","S","O","N","D"];function Ze(t){switch(t){case"narrow":return[...Qe];case"short":return[...He];case"long":return[...We];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const Ye=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Je=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Xe=["M","T","W","T","F","S","S"];function tn(t){switch(t){case"narrow":return[...Xe];case"short":return[...Je];case"long":return[...Ye];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const en=["AM","PM"],nn=["Before Christ","Anno Domini"],rn=["BC","AD"],on=["B","A"];function sn(t){switch(t){case"narrow":return[...on];case"short":return[...rn];case"long":return[...nn];default:return null}}function an(t,e){let n="";for(const r of t)r.literal?n+=r.val:n+=e(r.val);return n}const un={D:Yt,DD:Jt,DDD:te,DDDD:ee,t:ne,tt:re,ttt:ie,tttt:oe,T:se,TT:ae,TTT:ue,TTTT:ce,f:le,ff:fe,fff:me,ffff:ge,F:he,FF:de,FFF:ye,FFFF:ve};class cn{static create(t,e={}){return new cn(t,e)}static parseFormat(t){let e=null,n="",r=!1;const i=[];for(let o=0;o<t.length;o++){const s=t.charAt(o);"'"===s?(n.length>0&&i.push({literal:r,val:n}),e=null,n="",r=!r):r||s===e?n+=s:(n.length>0&&i.push({literal:!1,val:n}),n=s,e=s)}return n.length>0&&i.push({literal:r,val:n}),i}static macroTokenToFormatOpts(t){return un[t]}constructor(t,e){this.opts=e,this.loc=t,this.systemLoc=null}formatWithSystemDefault(t,e){null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem());return this.systemLoc.dtFormatter(t,Object.assign({},this.opts,e)).format()}formatDateTime(t,e={}){return this.loc.dtFormatter(t,Object.assign({},this.opts,e)).format()}formatDateTimeParts(t,e={}){return this.loc.dtFormatter(t,Object.assign({},this.opts,e)).formatToParts()}resolvedOptions(t,e={}){return this.loc.dtFormatter(t,Object.assign({},this.opts,e)).resolvedOptions()}num(t,e=0){if(this.opts.forceSimple)return Oe(t,e);const n=Object.assign({},this.opts);return e>0&&(n.padTo=e),this.loc.numberFormatter(n).format(t)}formatDateTimeFromString(t,e){const n="en"===this.loc.listingMode(),r=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar&&Ie(),i=(e,n)=>this.loc.extract(t,e,n),o=e=>t.isOffsetFixed&&0===t.offset&&e.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,e.format):"",s=()=>n?function(t){return en[t.hour<12?0:1]}(t):i({hour:"numeric",hour12:!0},"dayperiod"),a=(e,r)=>n?function(t,e){return Ze(e)[t.month-1]}(t,e):i(r?{month:e}:{month:e,day:"numeric"},"month"),u=(e,r)=>n?function(t,e){return tn(e)[t.weekday-1]}(t,e):i(r?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday"),c=e=>{const n=cn.macroTokenToFormatOpts(e);return n?this.formatWithSystemDefault(t,n):e},l=e=>n?function(t,e){return sn(e)[t.year<0?0:1]}(t,e):i({era:e},"era");return an(cn.parseFormat(e),(e=>{switch(e){case"S":return this.num(t.millisecond);case"u":case"SSS":return this.num(t.millisecond,3);case"s":return this.num(t.second);case"ss":return this.num(t.second,2);case"m":return this.num(t.minute);case"mm":return this.num(t.minute,2);case"h":return this.num(t.hour%12==0?12:t.hour%12);case"hh":return this.num(t.hour%12==0?12:t.hour%12,2);case"H":return this.num(t.hour);case"HH":return this.num(t.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:this.loc.locale});case"z":return t.zoneName;case"a":return s();case"d":return r?i({day:"numeric"},"day"):this.num(t.day);case"dd":return r?i({day:"2-digit"},"day"):this.num(t.day,2);case"c":return this.num(t.weekday);case"ccc":return u("short",!0);case"cccc":return u("long",!0);case"ccccc":return u("narrow",!0);case"E":return this.num(t.weekday);case"EEE":return u("short",!1);case"EEEE":return u("long",!1);case"EEEEE":return u("narrow",!1);case"L":return r?i({month:"numeric",day:"numeric"},"month"):this.num(t.month);case"LL":return r?i({month:"2-digit",day:"numeric"},"month"):this.num(t.month,2);case"LLL":return a("short",!0);case"LLLL":return a("long",!0);case"LLLLL":return a("narrow",!0);case"M":return r?i({month:"numeric"},"month"):this.num(t.month);case"MM":return r?i({month:"2-digit"},"month"):this.num(t.month,2);case"MMM":return a("short",!1);case"MMMM":return a("long",!1);case"MMMMM":return a("narrow",!1);case"y":return r?i({year:"numeric"},"year"):this.num(t.year);case"yy":return r?i({year:"2-digit"},"year"):this.num(t.year.toString().slice(-2),2);case"yyyy":return r?i({year:"numeric"},"year"):this.num(t.year,4);case"yyyyyy":return r?i({year:"numeric"},"year"):this.num(t.year,6);case"G":return l("short");case"GG":return l("long");case"GGGGG":return l("narrow");case"kk":return this.num(t.weekYear.toString().slice(-2),2);case"kkkk":return this.num(t.weekYear,4);case"W":return this.num(t.weekNumber);case"WW":return this.num(t.weekNumber,2);case"o":return this.num(t.ordinal);case"ooo":return this.num(t.ordinal,3);case"q":return this.num(t.quarter);case"qq":return this.num(t.quarter,2);case"X":return this.num(Math.floor(t.ts/1e3));case"x":return this.num(t.ts);default:return c(e)}}))}formatDurationFromString(t,e){const n=t=>{switch(t[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"M":return"month";case"y":return"year";default:return null}},r=cn.parseFormat(e),i=r.reduce(((t,{literal:e,val:n})=>e?t:t.concat(n)),[]);return an(r,(t=>e=>{const r=n(e);return r?this.num(t.get(r),e.length):e})(t.shiftTo(...i.map(n).filter((t=>t)))))}}class ln{constructor(t,e){this.reason=t,this.explanation=e}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}class hn{get type(){throw new Wt}get name(){throw new Wt}get universal(){throw new Wt}offsetName(t,e){throw new Wt}formatOffset(t,e){throw new Wt}offset(t){throw new Wt}equals(t){throw new Wt}get isValid(){throw new Wt}}let fn=null;class dn extends hn{static get instance(){return null===fn&&(fn=new dn),fn}get type(){return"local"}get name(){return Ee()?(new Intl.DateTimeFormat).resolvedOptions().timeZone:"local"}get universal(){return!1}offsetName(t,{format:e,locale:n}){return qe(t,e,n)}formatOffset(t,e){return ze(this.offset(t),e)}offset(t){return-new Date(t).getTimezoneOffset()}equals(t){return"local"===t.type}get isValid(){return!0}}const pn=RegExp(`^${Ke.source}$`);let mn={};const yn={year:0,month:1,day:2,hour:3,minute:4,second:5};let gn={};class vn extends hn{static create(t){return gn[t]||(gn[t]=new vn(t)),gn[t]}static resetCache(){gn={},mn={}}static isValidSpecifier(t){return!(!t||!t.match(pn))}static isValidZone(t){try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch(Ww){return!1}}static parseGMTOffset(t){if(t){const e=t.match(/^Etc\/GMT(0|[+-]\d{1,2})$/i);if(e)return-60*parseInt(e[1])}return null}constructor(t){super(),this.zoneName=t,this.valid=vn.isValidZone(t)}get type(){return"iana"}get name(){return this.zoneName}get universal(){return!1}offsetName(t,{format:e,locale:n}){return qe(t,e,n,this.name)}formatOffset(t,e){return ze(this.offset(t),e)}offset(t){const e=new Date(t);if(isNaN(e))return NaN;const n=(c=this.name,mn[c]||(mn[c]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:c,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),mn[c]),[r,i,o,s,a,u]=n.formatToParts?function(t,e){const n=t.formatToParts(e),r=[];for(let i=0;i<n.length;i++){const{type:t,value:e}=n[i],o=yn[t];be(o)||(r[o]=parseInt(e,10))}return r}(n,e):function(t,e){const n=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n),[,i,o,s,a,u,c]=r;return[s,i,o,a,u,c]}(n,e);var c;let l=+e;const h=l%1e3;return l-=h>=0?h:1e3+h,(Re({year:r,month:i,day:o,hour:24===s?0:s,minute:a,second:u,millisecond:0})-l)/6e4}equals(t){return"iana"===t.type&&t.name===this.name}get isValid(){return this.valid}}let bn=null;class wn extends hn{static get utcInstance(){return null===bn&&(bn=new wn(0)),bn}static instance(t){return 0===t?wn.utcInstance:new wn(t)}static parseSpecifier(t){if(t){const e=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(e)return new wn(Ue(e[1],e[2]))}return null}constructor(t){super(),this.fixed=t}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${ze(this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(t,e){return ze(this.fixed,e)}get universal(){return!0}offset(){return this.fixed}equals(t){return"fixed"===t.type&&t.fixed===this.fixed}get isValid(){return!0}}class Tn extends hn{constructor(t){super(),this.zoneName=t}get type(){return"invalid"}get name(){return this.zoneName}get universal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function En(t,e){let n;if(be(t)||null===t)return e;if(t instanceof hn)return t;if("string"==typeof t){const r=t.toLowerCase();return"local"===r?e:"utc"===r||"gmt"===r?wn.utcInstance:null!=(n=vn.parseGMTOffset(t))?wn.instance(n):vn.isValidSpecifier(r)?vn.create(t):wn.parseSpecifier(r)||new Tn(t)}return we(t)?wn.instance(t):"object"==typeof t&&t.offset&&"number"==typeof t.offset?t:new Tn(t)}let In=()=>Date.now(),Sn=null,_n=null,kn=null,Nn=null,Dn=!1;class On{static get now(){return In}static set now(t){In=t}static get defaultZoneName(){return On.defaultZone.name}static set defaultZoneName(t){Sn=t?En(t):null}static get defaultZone(){return Sn||dn.instance}static get defaultLocale(){return _n}static set defaultLocale(t){_n=t}static get defaultNumberingSystem(){return kn}static set defaultNumberingSystem(t){kn=t}static get defaultOutputCalendar(){return Nn}static set defaultOutputCalendar(t){Nn=t}static get throwOnInvalid(){return Dn}static set throwOnInvalid(t){Dn=t}static resetCaches(){Un.resetCache(),vn.resetCache()}}let An={};function Cn(t,e={}){const n=JSON.stringify([t,e]);let r=An[n];return r||(r=new Intl.DateTimeFormat(t,e),An[n]=r),r}let Mn={};let xn={};function Ln(r,i={}){const o=i,{base:s}=o,a=((r,i)=>{var o={};for(var s in r)e.call(r,s)&&i.indexOf(s)<0&&(o[s]=r[s]);if(null!=r&&t)for(var s of t(r))i.indexOf(s)<0&&n.call(r,s)&&(o[s]=r[s]);return o})(o,["base"]),u=JSON.stringify([r,a]);let c=xn[u];return c||(c=new Intl.RelativeTimeFormat(r,i),xn[u]=c),c}let Pn=null;function Rn(t,e,n,r,i){const o=t.listingMode(n);return"error"===o?null:"en"===o?r(e):i(e)}class Fn{constructor(t,e,n){if(this.padTo=n.padTo||0,this.floor=n.floor||!1,!e&&Ee()){const e={useGrouping:!1};n.padTo>0&&(e.minimumIntegerDigits=n.padTo),this.inf=function(t,e={}){const n=JSON.stringify([t,e]);let r=Mn[n];return r||(r=new Intl.NumberFormat(t,e),Mn[n]=r),r}(t,e)}}format(t){if(this.inf){const e=this.floor?Math.floor(t):t;return this.inf.format(e)}return Oe(this.floor?Math.floor(t):Me(t,3),this.padTo)}}class Vn{constructor(t,e,n){let r;if(this.opts=n,this.hasIntl=Ee(),t.zone.universal&&this.hasIntl){const e=t.offset/60*-1,i=e>=0?`Etc/GMT+${e}`:`Etc/GMT${e}`,o=vn.isValidZone(i);0!==t.offset&&o?(r=i,this.dt=t):(r="UTC",n.timeZoneName?this.dt=t:this.dt=0===t.offset?t:Fi.fromMillis(t.ts+60*t.offset*1e3))}else"local"===t.zone.type?this.dt=t:(this.dt=t,r=t.zone.name);if(this.hasIntl){const t=Object.assign({},this.opts);r&&(t.timeZone=r),this.dtf=Cn(e,t)}}format(){if(this.hasIntl)return this.dtf.format(this.dt.toJSDate());{const t=function(t){const e="EEEE, LLLL d, yyyy, h:mm a";switch(Ge(ke(t,["weekday","era","year","month","day","hour","minute","second","timeZoneName","hour12"]))){case Ge(Yt):return"M/d/yyyy";case Ge(Jt):return"LLL d, yyyy";case Ge(Xt):return"EEE, LLL d, yyyy";case Ge(te):return"LLLL d, yyyy";case Ge(ee):return"EEEE, LLLL d, yyyy";case Ge(ne):return"h:mm a";case Ge(re):return"h:mm:ss a";case Ge(ie):case Ge(oe):return"h:mm a";case Ge(se):return"HH:mm";case Ge(ae):return"HH:mm:ss";case Ge(ue):case Ge(ce):return"HH:mm";case Ge(le):return"M/d/yyyy, h:mm a";case Ge(fe):return"LLL d, yyyy, h:mm a";case Ge(me):return"LLLL d, yyyy, h:mm a";case Ge(ge):return e;case Ge(he):return"M/d/yyyy, h:mm:ss a";case Ge(de):return"LLL d, yyyy, h:mm:ss a";case Ge(pe):return"EEE, d LLL yyyy, h:mm a";case Ge(ye):return"LLLL d, yyyy, h:mm:ss a";case Ge(ve):return"EEEE, LLLL d, yyyy, h:mm:ss a";default:return e}}(this.opts),e=Un.create("en-US");return cn.create(e).formatDateTimeFromString(this.dt,t)}}formatToParts(){return this.hasIntl&&Ie()?this.dtf.formatToParts(this.dt.toJSDate()):[]}resolvedOptions(){return this.hasIntl?this.dtf.resolvedOptions():{locale:"en-US",numberingSystem:"latn",outputCalendar:"gregory"}}}class qn{constructor(t,e,n){this.opts=Object.assign({style:"long"},n),!e&&Se()&&(this.rtf=Ln(t,n))}format(t,e){return this.rtf?this.rtf.format(t,e):function(t,e,n="always",r=!1){const i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},o=-1===["hours","minutes","seconds"].indexOf(t);if("auto"===n&&o){const n="days"===t;switch(e){case 1:return n?"tomorrow":`next ${i[t][0]}`;case-1:return n?"yesterday":`last ${i[t][0]}`;case 0:return n?"today":`this ${i[t][0]}`}}const s=Object.is(e,-0)||e<0,a=Math.abs(e),u=1===a,c=i[t],l=r?u?c[1]:c[2]||c[1]:u?i[t][0]:t;return s?`${a} ${l} ago`:`in ${a} ${l}`}(e,t,this.opts.numeric,"long"!==this.opts.style)}formatToParts(t,e){return this.rtf?this.rtf.formatToParts(t,e):[]}}class Un{static fromOpts(t){return Un.create(t.locale,t.numberingSystem,t.outputCalendar,t.defaultToEN)}static create(t,e,n,r=!1){const i=t||On.defaultLocale,o=i||(r?"en-US":function(){if(Pn)return Pn;if(Ee()){const t=(new Intl.DateTimeFormat).resolvedOptions().locale;return Pn=t&&"und"!==t?t:"en-US",Pn}return Pn="en-US",Pn}()),s=e||On.defaultNumberingSystem,a=n||On.defaultOutputCalendar;return new Un(o,s,a,i)}static resetCache(){Pn=null,An={},Mn={},xn={}}static fromObject({locale:t,numberingSystem:e,outputCalendar:n}={}){return Un.create(t,e,n)}constructor(t,e,n,r){const[i,o,s]=function(t){const e=t.indexOf("-u-");if(-1===e)return[t];{let n;const r=t.substring(0,e);try{n=Cn(t).resolvedOptions()}catch(Ww){n=Cn(r).resolvedOptions()}const{numberingSystem:i,calendar:o}=n;return[r,i,o]}}(t);this.locale=i,this.numberingSystem=e||o||null,this.outputCalendar=n||s||null,this.intl=function(t,e,n){return Ee()?n||e?(t+="-u",n&&(t+=`-ca-${n}`),e&&(t+=`-nu-${e}`),t):t:[]}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=r,this.fastNumbersCached=null}get fastNumbers(){var t;return null==this.fastNumbersCached&&(this.fastNumbersCached=(!(t=this).numberingSystem||"latn"===t.numberingSystem)&&("latn"===t.numberingSystem||!t.locale||t.locale.startsWith("en")||Ee()&&"latn"===new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}listingMode(t=!0){const e=Ee()&&Ie(),n=this.isEnglish(),r=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return e||n&&r||t?!e||n&&r?"en":"intl":"error"}clone(t){return t&&0!==Object.getOwnPropertyNames(t).length?Un.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,t.defaultToEN||!1):this}redefaultToEN(t={}){return this.clone(Object.assign({},t,{defaultToEN:!0}))}redefaultToSystem(t={}){return this.clone(Object.assign({},t,{defaultToEN:!1}))}months(t,e=!1,n=!0){return Rn(this,t,n,Ze,(()=>{const n=e?{month:t,day:"numeric"}:{month:t},r=e?"format":"standalone";return this.monthsCache[r][t]||(this.monthsCache[r][t]=function(t){const e=[];for(let n=1;n<=12;n++){const r=Fi.utc(2016,n,1);e.push(t(r))}return e}((t=>this.extract(t,n,"month")))),this.monthsCache[r][t]}))}weekdays(t,e=!1,n=!0){return Rn(this,t,n,tn,(()=>{const n=e?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},r=e?"format":"standalone";return this.weekdaysCache[r][t]||(this.weekdaysCache[r][t]=function(t){const e=[];for(let n=1;n<=7;n++){const r=Fi.utc(2016,11,13+n);e.push(t(r))}return e}((t=>this.extract(t,n,"weekday")))),this.weekdaysCache[r][t]}))}meridiems(t=!0){return Rn(this,void 0,t,(()=>en),(()=>{if(!this.meridiemCache){const t={hour:"numeric",hour12:!0};this.meridiemCache=[Fi.utc(2016,11,13,9),Fi.utc(2016,11,13,19)].map((e=>this.extract(e,t,"dayperiod")))}return this.meridiemCache}))}eras(t,e=!0){return Rn(this,t,e,sn,(()=>{const e={era:t};return this.eraCache[t]||(this.eraCache[t]=[Fi.utc(-40,1,1),Fi.utc(2017,1,1)].map((t=>this.extract(t,e,"era")))),this.eraCache[t]}))}extract(t,e,n){const r=this.dtFormatter(t,e).formatToParts().find((t=>t.type.toLowerCase()===n));return r?r.value:null}numberFormatter(t={}){return new Fn(this.intl,t.forceSimple||this.fastNumbers,t)}dtFormatter(t,e={}){return new Vn(t,this.intl,e)}relFormatter(t={}){return new qn(this.intl,this.isEnglish(),t)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||Ee()&&new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar}}function jn(...t){const e=t.reduce(((t,e)=>t+e.source),"");return RegExp(`^${e}$`)}function Bn(...t){return e=>t.reduce((([t,n,r],i)=>{const[o,s,a]=i(e,r);return[Object.assign(t,o),n||s,a]}),[{},null,1]).slice(0,2)}function zn(t,...e){if(null==t)return[null,null];for(const[n,r]of e){const e=n.exec(t);if(e)return r(e)}return[null,null]}function $n(...t){return(e,n)=>{const r={};let i;for(i=0;i<t.length;i++)r[t[i]]=Ae(e[n+i]);return[r,null,n+i]}}const Kn=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Gn=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Wn=RegExp(`${Gn.source}${Kn.source}?`),Hn=RegExp(`(?:T${Wn.source})?`),Qn=$n("weekYear","weekNumber","weekDay"),Zn=$n("year","ordinal"),Yn=RegExp(`${Gn.source} ?(?:${Kn.source}|(${Ke.source}))?`),Jn=RegExp(`(?: ${Yn.source})?`);function Xn(t,e,n){const r=t[e];return be(r)?n:Ae(r)}function tr(t,e){return[{year:Xn(t,e),month:Xn(t,e+1,1),day:Xn(t,e+2,1)},null,e+3]}function er(t,e){return[{hours:Xn(t,e,0),minutes:Xn(t,e+1,0),seconds:Xn(t,e+2,0),milliseconds:Ce(t[e+3])},null,e+4]}function nr(t,e){const n=!t[e]&&!t[e+1],r=Ue(t[e+1],t[e+2]);return[{},n?null:wn.instance(r),e+3]}function rr(t,e){return[{},t[e]?vn.create(t[e]):null,e+1]}const ir=RegExp(`^T?${Gn.source}$`),or=/^-?P(?:(?:(-?\d{1,9})Y)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})W)?(?:(-?\d{1,9})D)?(?:T(?:(-?\d{1,9})H)?(?:(-?\d{1,9})M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,9}))?S)?)?)$/;function sr(t){const[e,n,r,i,o,s,a,u,c]=t,l="-"===e[0],h=u&&"-"===u[0],f=(t,e=!1)=>void 0!==t&&(e||t&&l)?-t:t;return[{years:f(Ae(n)),months:f(Ae(r)),weeks:f(Ae(i)),days:f(Ae(o)),hours:f(Ae(s)),minutes:f(Ae(a)),seconds:f(Ae(u),"-0"===u),milliseconds:f(Ce(c),h)}]}const ar={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function ur(t,e,n,r,i,o,s){const a={year:2===e.length?Ve(Ae(e)):Ae(e),month:He.indexOf(n)+1,day:Ae(r),hour:Ae(i),minute:Ae(o)};return s&&(a.second=Ae(s)),t&&(a.weekday=t.length>3?Ye.indexOf(t)+1:Je.indexOf(t)+1),a}const cr=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function lr(t){const[,e,n,r,i,o,s,a,u,c,l,h]=t,f=ur(e,i,r,n,o,s,a);let d;return d=u?ar[u]:c?0:Ue(l,h),[f,new wn(d)]}const hr=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,fr=/^(Monday|Tuesday|Wedsday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,dr=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function pr(t){const[,e,n,r,i,o,s,a]=t;return[ur(e,i,r,n,o,s,a),wn.utcInstance]}function mr(t){const[,e,n,r,i,o,s,a]=t;return[ur(e,a,n,r,i,o,s),wn.utcInstance]}const yr=jn(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Hn),gr=jn(/(\d{4})-?W(\d\d)(?:-?(\d))?/,Hn),vr=jn(/(\d{4})-?(\d{3})/,Hn),br=jn(Wn),wr=Bn(tr,er,nr),Tr=Bn(Qn,er,nr),Er=Bn(Zn,er),Ir=Bn(er,nr);const Sr=Bn(er);const _r=jn(/(\d{4})-(\d\d)-(\d\d)/,Jn),kr=jn(Yn),Nr=Bn(tr,er,nr,rr),Dr=Bn(er,nr,rr);const Or={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},Ar=Object.assign({years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},Or),Cr=Object.assign({years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},Or),Mr=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],xr=Mr.slice(0).reverse();function Lr(t,e,n=!1){const r={values:n?e.values:Object.assign({},t.values,e.values||{}),loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy};return new Rr(r)}function Pr(t,e,n,r,i){const o=t[i][n],s=e[n]/o,a=!(Math.sign(s)===Math.sign(r[i]))&&0!==r[i]&&Math.abs(s)<=1?(u=s)<0?Math.floor(u):Math.ceil(u):Math.trunc(s);var u;r[i]+=a,e[n]-=a*o}class Rr{constructor(t){const e="longterm"===t.conversionAccuracy||!1;this.values=t.values,this.loc=t.loc||Un.create(),this.conversionAccuracy=e?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=e?Cr:Ar,this.isLuxonDuration=!0}static fromMillis(t,e){return Rr.fromObject(Object.assign({milliseconds:t},e))}static fromObject(t){if(null==t||"object"!=typeof t)throw new Gt("Duration.fromObject: argument expected to be an object, got "+(null===t?"null":typeof t));return new Rr({values:Be(t,Rr.normalizeUnit,["locale","numberingSystem","conversionAccuracy","zone"]),loc:Un.fromObject(t),conversionAccuracy:t.conversionAccuracy})}static fromISO(t,e){const[n]=zn(t,[or,sr]);if(n){const t=Object.assign(n,e);return Rr.fromObject(t)}return Rr.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static fromISOTime(t,e){const[n]=zn(t,[ir,Sr]);if(n){const t=Object.assign(n,e);return Rr.fromObject(t)}return Rr.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static invalid(t,e=null){if(!t)throw new Gt("need to specify a reason the Duration is invalid");const n=t instanceof ln?t:new ln(t,e);if(On.throwOnInvalid)throw new zt(n);return new Rr({invalid:n})}static normalizeUnit(t){const e={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t?t.toLowerCase():t];if(!e)throw new Kt(t);return e}static isDuration(t){return t&&t.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(t,e={}){const n=Object.assign({},e,{floor:!1!==e.round&&!1!==e.floor});return this.isValid?cn.create(this.loc,n).formatDurationFromString(this,t):"Invalid Duration"}toObject(t={}){if(!this.isValid)return{};const e=Object.assign({},this.values);return t.includeConfig&&(e.conversionAccuracy=this.conversionAccuracy,e.numberingSystem=this.loc.numberingSystem,e.locale=this.loc.locale),e}toISO(){if(!this.isValid)return null;let t="P";return 0!==this.years&&(t+=this.years+"Y"),0===this.months&&0===this.quarters||(t+=this.months+3*this.quarters+"M"),0!==this.weeks&&(t+=this.weeks+"W"),0!==this.days&&(t+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(t+="T"),0!==this.hours&&(t+=this.hours+"H"),0!==this.minutes&&(t+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(t+=Me(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===t&&(t+="T0S"),t}toISOTime(t={}){if(!this.isValid)return null;const e=this.toMillis();if(e<0||e>=864e5)return null;t=Object.assign({suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended"},t);const n=this.shiftTo("hours","minutes","seconds","milliseconds");let r="basic"===t.format?"hhmm":"hh:mm";t.suppressSeconds&&0===n.seconds&&0===n.milliseconds||(r+="basic"===t.format?"ss":":ss",t.suppressMilliseconds&&0===n.milliseconds||(r+=".SSS"));let i=n.toFormat(r);return t.includePrefix&&(i="T"+i),i}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(t){if(!this.isValid)return this;const e=Fr(t),n={};for(const r of Mr)(Ne(e.values,r)||Ne(this.values,r))&&(n[r]=e.get(r)+this.get(r));return Lr(this,{values:n},!0)}minus(t){if(!this.isValid)return this;const e=Fr(t);return this.plus(e.negate())}mapUnits(t){if(!this.isValid)return this;const e={};for(const n of Object.keys(this.values))e[n]=je(t(this.values[n],n));return Lr(this,{values:e},!0)}get(t){return this[Rr.normalizeUnit(t)]}set(t){if(!this.isValid)return this;return Lr(this,{values:Object.assign(this.values,Be(t,Rr.normalizeUnit,[]))})}reconfigure({locale:t,numberingSystem:e,conversionAccuracy:n}={}){const r={loc:this.loc.clone({locale:t,numberingSystem:e})};return n&&(r.conversionAccuracy=n),Lr(this,r)}as(t){return this.isValid?this.shiftTo(t).get(t):NaN}normalize(){if(!this.isValid)return this;const t=this.toObject();return function(t,e){xr.reduce(((n,r)=>be(e[r])?n:(n&&Pr(t,e,n,e,r),r)),null)}(this.matrix,t),Lr(this,{values:t},!0)}shiftTo(...t){if(!this.isValid)return this;if(0===t.length)return this;t=t.map((t=>Rr.normalizeUnit(t)));const e={},n={},r=this.toObject();let i;for(const o of Mr)if(t.indexOf(o)>=0){i=o;let t=0;for(const e in n)t+=this.matrix[e][o]*n[e],n[e]=0;we(r[o])&&(t+=r[o]);const s=Math.trunc(t);e[o]=s,n[o]=t-s;for(const n in r)Mr.indexOf(n)>Mr.indexOf(o)&&Pr(this.matrix,r,n,e,o)}else we(r[o])&&(n[o]=r[o]);for(const o in n)0!==n[o]&&(e[i]+=o===i?n[o]:n[o]/this.matrix[i][o]);return Lr(this,{values:e},!0).normalize()}negate(){if(!this.isValid)return this;const t={};for(const e of Object.keys(this.values))t[e]=-this.values[e];return Lr(this,{values:t},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(t){if(!this.isValid||!t.isValid)return!1;if(!this.loc.equals(t.loc))return!1;for(const r of Mr)if(e=this.values[r],n=t.values[r],!(void 0===e||0===e?void 0===n||0===n:e===n))return!1;var e,n;return!0}}function Fr(t){if(we(t))return Rr.fromMillis(t);if(Rr.isDuration(t))return t;if("object"==typeof t)return Rr.fromObject(t);throw new Gt(`Unknown duration argument ${t} of type ${typeof t}`)}const Vr="Invalid Interval";class qr{constructor(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}static invalid(t,e=null){if(!t)throw new Gt("need to specify a reason the Interval is invalid");const n=t instanceof ln?t:new ln(t,e);if(On.throwOnInvalid)throw new Bt(n);return new qr({invalid:n})}static fromDateTimes(t,e){const n=Vi(t),r=Vi(e),i=function(t,e){return t&&t.isValid?e&&e.isValid?e<t?qr.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null:qr.invalid("missing or invalid end"):qr.invalid("missing or invalid start")}(n,r);return null==i?new qr({start:n,end:r}):i}static after(t,e){const n=Fr(e),r=Vi(t);return qr.fromDateTimes(r,r.plus(n))}static before(t,e){const n=Fr(e),r=Vi(t);return qr.fromDateTimes(r.minus(n),r)}static fromISO(t,e){const[n,r]=(t||"").split("/",2);if(n&&r){let t,o,s,a;try{t=Fi.fromISO(n,e),o=t.isValid}catch(i){o=!1}try{s=Fi.fromISO(r,e),a=s.isValid}catch(i){a=!1}if(o&&a)return qr.fromDateTimes(t,s);if(o){const n=Rr.fromISO(r,e);if(n.isValid)return qr.after(t,n)}else if(a){const t=Rr.fromISO(n,e);if(t.isValid)return qr.before(s,t)}}return qr.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static isInterval(t){return t&&t.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(t="milliseconds"){return this.isValid?this.toDuration(t).get(t):NaN}count(t="milliseconds"){if(!this.isValid)return NaN;const e=this.start.startOf(t),n=this.end.startOf(t);return Math.floor(n.diff(e,t).get(t))+1}hasSame(t){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,t))}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(t){return!!this.isValid&&this.s>t}isBefore(t){return!!this.isValid&&this.e<=t}contains(t){return!!this.isValid&&(this.s<=t&&this.e>t)}set({start:t,end:e}={}){return this.isValid?qr.fromDateTimes(t||this.s,e||this.e):this}splitAt(...t){if(!this.isValid)return[];const e=t.map(Vi).filter((t=>this.contains(t))).sort(),n=[];let{s:r}=this,i=0;for(;r<this.e;){const t=e[i]||this.e,o=+t>+this.e?this.e:t;n.push(qr.fromDateTimes(r,o)),r=o,i+=1}return n}splitBy(t){const e=Fr(t);if(!this.isValid||!e.isValid||0===e.as("milliseconds"))return[];let n,{s:r}=this,i=1;const o=[];for(;r<this.e;){const t=this.start.plus(e.mapUnits((t=>t*i)));n=+t>+this.e?this.e:t,o.push(qr.fromDateTimes(r,n)),r=n,i+=1}return o}divideEqually(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]}overlaps(t){return this.e>t.s&&this.s<t.e}abutsStart(t){return!!this.isValid&&+this.e==+t.s}abutsEnd(t){return!!this.isValid&&+t.e==+this.s}engulfs(t){return!!this.isValid&&(this.s<=t.s&&this.e>=t.e)}equals(t){return!(!this.isValid||!t.isValid)&&(this.s.equals(t.s)&&this.e.equals(t.e))}intersection(t){if(!this.isValid)return this;const e=this.s>t.s?this.s:t.s,n=this.e<t.e?this.e:t.e;return e>=n?null:qr.fromDateTimes(e,n)}union(t){if(!this.isValid)return this;const e=this.s<t.s?this.s:t.s,n=this.e>t.e?this.e:t.e;return qr.fromDateTimes(e,n)}static merge(t){const[e,n]=t.sort(((t,e)=>t.s-e.s)).reduce((([t,e],n)=>e?e.overlaps(n)||e.abutsStart(n)?[t,e.union(n)]:[t.concat([e]),n]:[t,n]),[[],null]);return n&&e.push(n),e}static xor(t){let e=null,n=0;const r=[],i=t.map((t=>[{time:t.s,type:"s"},{time:t.e,type:"e"}])),o=Array.prototype.concat(...i).sort(((t,e)=>t.time-e.time));for(const s of o)n+="s"===s.type?1:-1,1===n?e=s.time:(e&&+e!=+s.time&&r.push(qr.fromDateTimes(e,s.time)),e=null);return qr.merge(r)}difference(...t){return qr.xor([this].concat(t)).map((t=>this.intersection(t))).filter((t=>t&&!t.isEmpty()))}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:Vr}toISO(t){return this.isValid?`${this.s.toISO(t)}/${this.e.toISO(t)}`:Vr}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Vr}toISOTime(t){return this.isValid?`${this.s.toISOTime(t)}/${this.e.toISOTime(t)}`:Vr}toFormat(t,{separator:e=" – "}={}){return this.isValid?`${this.s.toFormat(t)}${e}${this.e.toFormat(t)}`:Vr}toDuration(t,e){return this.isValid?this.e.diff(this.s,t,e):Rr.invalid(this.invalidReason)}mapEndpoints(t){return qr.fromDateTimes(t(this.s),t(this.e))}}class Ur{static hasDST(t=On.defaultZone){const e=Fi.now().setZone(t).set({month:12});return!t.universal&&e.offset!==e.set({month:6}).offset}static isValidIANAZone(t){return vn.isValidSpecifier(t)&&vn.isValidZone(t)}static normalizeZone(t){return En(t,On.defaultZone)}static months(t="long",{locale:e=null,numberingSystem:n=null,locObj:r=null,outputCalendar:i="gregory"}={}){return(r||Un.create(e,n,i)).months(t)}static monthsFormat(t="long",{locale:e=null,numberingSystem:n=null,locObj:r=null,outputCalendar:i="gregory"}={}){return(r||Un.create(e,n,i)).months(t,!0)}static weekdays(t="long",{locale:e=null,numberingSystem:n=null,locObj:r=null}={}){return(r||Un.create(e,n,null)).weekdays(t)}static weekdaysFormat(t="long",{locale:e=null,numberingSystem:n=null,locObj:r=null}={}){return(r||Un.create(e,n,null)).weekdays(t,!0)}static meridiems({locale:t=null}={}){return Un.create(t).meridiems()}static eras(t="short",{locale:e=null}={}){return Un.create(e,null,"gregory").eras(t)}static features(){let t=!1,e=!1,n=!1,r=!1;if(Ee()){t=!0,e=Ie(),r=Se();try{n="America/New_York"===new Intl.DateTimeFormat("en",{timeZone:"America/New_York"}).resolvedOptions().timeZone}catch(Ww){n=!1}}return{intl:t,intlTokens:e,zones:n,relative:r}}}function jr(t,e){const n=t=>t.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=n(e)-n(t);return Math.floor(Rr.fromMillis(r).as("days"))}function Br(t,e,n,r){let[i,o,s,a]=function(t,e,n){const r=[["years",(t,e)=>e.year-t.year],["quarters",(t,e)=>e.quarter-t.quarter],["months",(t,e)=>e.month-t.month+12*(e.year-t.year)],["weeks",(t,e)=>{const n=jr(t,e);return(n-n%7)/7}],["days",jr]],i={};let o,s;for(const[a,u]of r)if(n.indexOf(a)>=0){o=a;let n=u(t,e);s=t.plus({[a]:n}),s>e?(t=t.plus({[a]:n-1}),n-=1):t=s,i[a]=n}return[t,i,s,o]}(t,e,n);const u=e-i,c=n.filter((t=>["hours","minutes","seconds","milliseconds"].indexOf(t)>=0));0===c.length&&(s<e&&(s=i.plus({[a]:1})),s!==i&&(o[a]=(o[a]||0)+u/(s-i)));const l=Rr.fromObject(Object.assign(o,r));return c.length>0?Rr.fromMillis(u,r).shiftTo(...c).plus(l):l}const zr={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},$r={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Kr=zr.hanidec.replace(/[\[|\]]/g,"").split("");function Gr({numberingSystem:t},e=""){return new RegExp(`${zr[t||"latn"]}${e}`)}function Wr(t,e=(t=>t)){return{regex:t,deser:([t])=>e(function(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);if(-1!==t[n].search(zr.hanidec))e+=Kr.indexOf(t[n]);else for(const t in $r){const[n,i]=$r[t];r>=n&&r<=i&&(e+=r-n)}}return parseInt(e,10)}return e}(t))}}const Hr=`( |${String.fromCharCode(160)})`,Qr=new RegExp(Hr,"g");function Zr(t){return t.replace(/\./g,"\\.?").replace(Qr,Hr)}function Yr(t){return t.replace(/\./g,"").replace(Qr," ").toLowerCase()}function Jr(t,e){return null===t?null:{regex:RegExp(t.map(Zr).join("|")),deser:([n])=>t.findIndex((t=>Yr(n)===Yr(t)))+e}}function Xr(t,e){return{regex:t,deser:([,t,e])=>Ue(t,e),groups:e}}function ti(t){return{regex:t,deser:([t])=>t}}const ei={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"}};let ni=null;function ri(t,e){if(t.literal)return t;const n=cn.macroTokenToFormatOpts(t.val);if(!n)return t;const r=cn.create(e,n).formatDateTimeParts((ni||(ni=Fi.fromMillis(1555555555555)),ni)).map((t=>function(t,e,n){const{type:r,value:i}=t;if("literal"===r)return{literal:!0,val:i};const o=n[r];let s=ei[r];return"object"==typeof s&&(s=s[o]),s?{literal:!1,val:s}:void 0}(t,0,n)));return r.includes(void 0)?t:r}function ii(t,e,n){const r=function(t,e){return Array.prototype.concat(...t.map((t=>ri(t,e))))}(cn.parseFormat(n),t),i=r.map((e=>function(t,e){const n=Gr(e),r=Gr(e,"{2}"),i=Gr(e,"{3}"),o=Gr(e,"{4}"),s=Gr(e,"{6}"),a=Gr(e,"{1,2}"),u=Gr(e,"{1,3}"),c=Gr(e,"{1,6}"),l=Gr(e,"{1,9}"),h=Gr(e,"{2,4}"),f=Gr(e,"{4,6}"),d=t=>{return{regex:RegExp((e=t.val,e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:([t])=>t,literal:!0};var e},p=(p=>{if(t.literal)return d(p);switch(p.val){case"G":return Jr(e.eras("short",!1),0);case"GG":return Jr(e.eras("long",!1),0);case"y":return Wr(c);case"yy":return Wr(h,Ve);case"yyyy":return Wr(o);case"yyyyy":return Wr(f);case"yyyyyy":return Wr(s);case"M":return Wr(a);case"MM":return Wr(r);case"MMM":return Jr(e.months("short",!0,!1),1);case"MMMM":return Jr(e.months("long",!0,!1),1);case"L":return Wr(a);case"LL":return Wr(r);case"LLL":return Jr(e.months("short",!1,!1),1);case"LLLL":return Jr(e.months("long",!1,!1),1);case"d":return Wr(a);case"dd":return Wr(r);case"o":return Wr(u);case"ooo":return Wr(i);case"HH":return Wr(r);case"H":return Wr(a);case"hh":return Wr(r);case"h":return Wr(a);case"mm":return Wr(r);case"m":case"q":return Wr(a);case"qq":return Wr(r);case"s":return Wr(a);case"ss":return Wr(r);case"S":return Wr(u);case"SSS":return Wr(i);case"u":return ti(l);case"a":return Jr(e.meridiems(),0);case"kkkk":return Wr(o);case"kk":return Wr(h,Ve);case"W":return Wr(a);case"WW":return Wr(r);case"E":case"c":return Wr(n);case"EEE":return Jr(e.weekdays("short",!1,!1),1);case"EEEE":return Jr(e.weekdays("long",!1,!1),1);case"ccc":return Jr(e.weekdays("short",!0,!1),1);case"cccc":return Jr(e.weekdays("long",!0,!1),1);case"Z":case"ZZ":return Xr(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return Xr(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return ti(/[a-z_+-/]{1,256}?/i);default:return d(p)}})(t)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"};return p.token=t,p}(e,t))),o=i.find((t=>t.invalidReason));if(o)return{input:e,tokens:r,invalidReason:o.invalidReason};{const[t,n]=function(t){return[`^${t.map((t=>t.regex)).reduce(((t,e)=>`${t}(${e.source})`),"")}$`,t]}(i),o=RegExp(t,"i"),[s,a]=function(t,e,n){const r=t.match(e);if(r){const t={};let e=1;for(const i in n)if(Ne(n,i)){const o=n[i],s=o.groups?o.groups+1:1;!o.literal&&o.token&&(t[o.token.val[0]]=o.deser(r.slice(e,e+s))),e+=s}return[r,t]}return[r,{}]}(e,o,n),[u,c]=a?function(t){let e;return e=be(t.Z)?be(t.z)?null:vn.create(t.z):new wn(t.Z),be(t.q)||(t.M=3*(t.q-1)+1),be(t.h)||(t.h<12&&1===t.a?t.h+=12:12===t.h&&0===t.a&&(t.h=0)),0===t.G&&t.y&&(t.y=-t.y),be(t.u)||(t.S=Ce(t.u)),[Object.keys(t).reduce(((e,n)=>{const r=(t=>{switch(t){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}})(n);return r&&(e[r]=t[n]),e}),{}),e]}(a):[null,null];if(Ne(a,"a")&&Ne(a,"H"))throw new $t("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:r,regex:o,rawMatches:s,matches:a,result:u,zone:c}}}const oi=[0,31,59,90,120,151,181,212,243,273,304,334],si=[0,31,60,91,121,152,182,213,244,274,305,335];function ai(t,e){return new ln("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function ui(t,e,n){const r=new Date(Date.UTC(t,e-1,n)).getUTCDay();return 0===r?7:r}function ci(t,e,n){return n+(xe(t)?si:oi)[e-1]}function li(t,e){const n=xe(t)?si:oi,r=n.findIndex((t=>t<e));return{month:r+1,day:e-n[r]}}function hi(t){const{year:e,month:n,day:r}=t,i=ci(e,n,r),o=ui(e,n,r);let s,a=Math.floor((i-o+10)/7);return a<1?(s=e-1,a=Fe(s)):a>Fe(e)?(s=e+1,a=1):s=e,Object.assign({weekYear:s,weekNumber:a,weekday:o},$e(t))}function fi(t){const{weekYear:e,weekNumber:n,weekday:r}=t,i=ui(e,1,4),o=Le(e);let s,a=7*n+r-i-3;a<1?(s=e-1,a+=Le(s)):a>o?(s=e+1,a-=Le(e)):s=e;const{month:u,day:c}=li(s,a);return Object.assign({year:s,month:u,day:c},$e(t))}function di(t){const{year:e,month:n,day:r}=t,i=ci(e,n,r);return Object.assign({year:e,ordinal:i},$e(t))}function pi(t){const{year:e,ordinal:n}=t,{month:r,day:i}=li(e,n);return Object.assign({year:e,month:r,day:i},$e(t))}function mi(t){const e=Te(t.year),n=De(t.month,1,12),r=De(t.day,1,Pe(t.year,t.month));return e?n?!r&&ai("day",t.day):ai("month",t.month):ai("year",t.year)}function yi(t){const{hour:e,minute:n,second:r,millisecond:i}=t,o=De(e,0,23)||24===e&&0===n&&0===r&&0===i,s=De(n,0,59),a=De(r,0,59),u=De(i,0,999);return o?s?a?!u&&ai("millisecond",i):ai("second",r):ai("minute",n):ai("hour",e)}const gi="Invalid DateTime";function vi(t){return new ln("unsupported zone",`the zone "${t.name}" is not supported`)}function bi(t){return null===t.weekData&&(t.weekData=hi(t.c)),t.weekData}function wi(t,e){const n={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new Fi(Object.assign({},n,e,{old:n}))}function Ti(t,e,n){let r=t-60*e*1e3;const i=n.offset(r);if(e===i)return[r,e];r-=60*(i-e)*1e3;const o=n.offset(r);return i===o?[r,i]:[t-60*Math.min(i,o)*1e3,Math.max(i,o)]}function Ei(t,e){const n=new Date(t+=60*e*1e3);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function Ii(t,e,n){return Ti(Re(t),e,n)}function Si(t,e){const n=t.o,r=t.c.year+Math.trunc(e.years),i=t.c.month+Math.trunc(e.months)+3*Math.trunc(e.quarters),o=Object.assign({},t.c,{year:r,month:i,day:Math.min(t.c.day,Pe(r,i))+Math.trunc(e.days)+7*Math.trunc(e.weeks)}),s=Rr.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=Re(o);let[u,c]=Ti(a,n,t.zone);return 0!==s&&(u+=s,c=t.zone.offset(u)),{ts:u,o:c}}function _i(t,e,n,r,i){const{setZone:o,zone:s}=n;if(t&&0!==Object.keys(t).length){const r=e||s,i=Fi.fromObject(Object.assign(t,n,{zone:r,setZone:void 0}));return o?i:i.setZone(s)}return Fi.invalid(new ln("unparsable",`the input "${i}" can't be parsed as ${r}`))}function ki(t,e,n=!0){return t.isValid?cn.create(Un.create("en-US"),{allowZ:n,forceSimple:!0}).formatDateTimeFromString(t,e):null}function Ni(t,{suppressSeconds:e=!1,suppressMilliseconds:n=!1,includeOffset:r,includePrefix:i=!1,includeZone:o=!1,spaceZone:s=!1,format:a="extended"}){let u="basic"===a?"HHmm":"HH:mm";e&&0===t.second&&0===t.millisecond||(u+="basic"===a?"ss":":ss",n&&0===t.millisecond||(u+=".SSS")),(o||r)&&s&&(u+=" "),o?u+="z":r&&(u+="basic"===a?"ZZZ":"ZZ");let c=ki(t,u);return i&&(c="T"+c),c}const Di={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Oi={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Ai={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Ci=["year","month","day","hour","minute","second","millisecond"],Mi=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],xi=["year","ordinal","hour","minute","second","millisecond"];function Li(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new Kt(t);return e}function Pi(t,e){for(const a of Ci)be(t[a])&&(t[a]=Di[a]);const n=mi(t)||yi(t);if(n)return Fi.invalid(n);const r=On.now(),i=e.offset(r),[o,s]=Ii(t,i,e);return new Fi({ts:o,zone:e,o:s})}function Ri(t,e,n){const r=!!be(n.round)||n.round,i=(t,i)=>{t=Me(t,r||n.calendary?0:2,!0);return e.loc.clone(n).relFormatter(n).format(t,i)},o=r=>n.calendary?e.hasSame(t,r)?0:e.startOf(r).diff(t.startOf(r),r).get(r):e.diff(t,r).get(r);if(n.unit)return i(o(n.unit),n.unit);for(const s of n.units){const t=o(s);if(Math.abs(t)>=1)return i(t,s)}return i(t>e?-0:0,n.units[n.units.length-1])}class Fi{constructor(t){const e=t.zone||On.defaultZone;let n=t.invalid||(Number.isNaN(t.ts)?new ln("invalid input"):null)||(e.isValid?null:vi(e));this.ts=be(t.ts)?On.now():t.ts;let r=null,i=null;if(!n){if(t.old&&t.old.ts===this.ts&&t.old.zone.equals(e))[r,i]=[t.old.c,t.old.o];else{const t=e.offset(this.ts);r=Ei(this.ts,t),n=Number.isNaN(r.year)?new ln("invalid input"):null,r=n?null:r,i=n?null:t}}this._zone=e,this.loc=t.loc||Un.create(),this.invalid=n,this.weekData=null,this.c=r,this.o=i,this.isLuxonDateTime=!0}static now(){return new Fi({})}static local(t,e,n,r,i,o,s){return be(t)?Fi.now():Pi({year:t,month:e,day:n,hour:r,minute:i,second:o,millisecond:s},On.defaultZone)}static utc(t,e,n,r,i,o,s){return be(t)?new Fi({ts:On.now(),zone:wn.utcInstance}):Pi({year:t,month:e,day:n,hour:r,minute:i,second:o,millisecond:s},wn.utcInstance)}static fromJSDate(t,e={}){const n=(r=t,"[object Date]"===Object.prototype.toString.call(r)?t.valueOf():NaN);var r;if(Number.isNaN(n))return Fi.invalid("invalid input");const i=En(e.zone,On.defaultZone);return i.isValid?new Fi({ts:n,zone:i,loc:Un.fromObject(e)}):Fi.invalid(vi(i))}static fromMillis(t,e={}){if(we(t))return t<-864e13||t>864e13?Fi.invalid("Timestamp out of range"):new Fi({ts:t,zone:En(e.zone,On.defaultZone),loc:Un.fromObject(e)});throw new Gt(`fromMillis requires a numerical input, but received a ${typeof t} with value ${t}`)}static fromSeconds(t,e={}){if(we(t))return new Fi({ts:1e3*t,zone:En(e.zone,On.defaultZone),loc:Un.fromObject(e)});throw new Gt("fromSeconds requires a numerical input")}static fromObject(t){const e=En(t.zone,On.defaultZone);if(!e.isValid)return Fi.invalid(vi(e));const n=On.now(),r=e.offset(n),i=Be(t,Li,["zone","locale","outputCalendar","numberingSystem"]),o=!be(i.ordinal),s=!be(i.year),a=!be(i.month)||!be(i.day),u=s||a,c=i.weekYear||i.weekNumber,l=Un.fromObject(t);if((u||o)&&c)throw new $t("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(a&&o)throw new $t("Can't mix ordinal dates with month/day");const h=c||i.weekday&&!u;let f,d,p=Ei(n,r);h?(f=Mi,d=Oi,p=hi(p)):o?(f=xi,d=Ai,p=di(p)):(f=Ci,d=Di);let m=!1;for(const T of f){be(i[T])?i[T]=m?d[T]:p[T]:m=!0}const y=(h?function(t){const e=Te(t.weekYear),n=De(t.weekNumber,1,Fe(t.weekYear)),r=De(t.weekday,1,7);return e?n?!r&&ai("weekday",t.weekday):ai("week",t.week):ai("weekYear",t.weekYear)}(i):o?function(t){const e=Te(t.year),n=De(t.ordinal,1,Le(t.year));return e?!n&&ai("ordinal",t.ordinal):ai("year",t.year)}(i):mi(i))||yi(i);if(y)return Fi.invalid(y);const g=h?fi(i):o?pi(i):i,[v,b]=Ii(g,r,e),w=new Fi({ts:v,zone:e,o:b,loc:l});return i.weekday&&u&&t.weekday!==w.weekday?Fi.invalid("mismatched weekday",`you can't specify both a weekday of ${i.weekday} and a date of ${w.toISO()}`):w}static fromISO(t,e={}){const[n,r]=zn(t,[yr,wr],[gr,Tr],[vr,Er],[br,Ir]);return _i(n,r,e,"ISO 8601",t)}static fromRFC2822(t,e={}){const[n,r]=zn(function(t){return t.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(t),[cr,lr]);return _i(n,r,e,"RFC 2822",t)}static fromHTTP(t,e={}){const[n,r]=zn(t,[hr,pr],[fr,pr],[dr,mr]);return _i(n,r,e,"HTTP",e)}static fromFormat(t,e,n={}){if(be(t)||be(e))throw new Gt("fromFormat requires an input string and a format");const{locale:r=null,numberingSystem:i=null}=n,o=Un.fromOpts({locale:r,numberingSystem:i,defaultToEN:!0}),[s,a,u]=function(t,e,n){const{result:r,zone:i,invalidReason:o}=ii(t,e,n);return[r,i,o]}(o,t,e);return u?Fi.invalid(u):_i(s,a,n,`format ${e}`,t)}static fromString(t,e,n={}){return Fi.fromFormat(t,e,n)}static fromSQL(t,e={}){const[n,r]=zn(t,[_r,Nr],[kr,Dr]);return _i(n,r,e,"SQL",t)}static invalid(t,e=null){if(!t)throw new Gt("need to specify a reason the DateTime is invalid");const n=t instanceof ln?t:new ln(t,e);if(On.throwOnInvalid)throw new jt(n);return new Fi({invalid:n})}static isDateTime(t){return t&&t.isLuxonDateTime||!1}get(t){return this[t]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?bi(this).weekYear:NaN}get weekNumber(){return this.isValid?bi(this).weekNumber:NaN}get weekday(){return this.isValid?bi(this).weekday:NaN}get ordinal(){return this.isValid?di(this.c).ordinal:NaN}get monthShort(){return this.isValid?Ur.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Ur.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Ur.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Ur.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.universal:null}get isInDST(){return!this.isOffsetFixed&&(this.offset>this.set({month:1}).offset||this.offset>this.set({month:5}).offset)}get isInLeapYear(){return xe(this.year)}get daysInMonth(){return Pe(this.year,this.month)}get daysInYear(){return this.isValid?Le(this.year):NaN}get weeksInWeekYear(){return this.isValid?Fe(this.weekYear):NaN}resolvedLocaleOpts(t={}){const{locale:e,numberingSystem:n,calendar:r}=cn.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:e,numberingSystem:n,outputCalendar:r}}toUTC(t=0,e={}){return this.setZone(wn.instance(t),e)}toLocal(){return this.setZone(On.defaultZone)}setZone(t,{keepLocalTime:e=!1,keepCalendarTime:n=!1}={}){if((t=En(t,On.defaultZone)).equals(this.zone))return this;if(t.isValid){let r=this.ts;if(e||n){const e=t.offset(this.ts),n=this.toObject();[r]=Ii(n,e,t)}return wi(this,{ts:r,zone:t})}return Fi.invalid(vi(t))}reconfigure({locale:t,numberingSystem:e,outputCalendar:n}={}){return wi(this,{loc:this.loc.clone({locale:t,numberingSystem:e,outputCalendar:n})})}setLocale(t){return this.reconfigure({locale:t})}set(t){if(!this.isValid)return this;const e=Be(t,Li,[]),n=!be(e.weekYear)||!be(e.weekNumber)||!be(e.weekday),r=!be(e.ordinal),i=!be(e.year),o=!be(e.month)||!be(e.day),s=i||o,a=e.weekYear||e.weekNumber;if((s||r)&&a)throw new $t("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(o&&r)throw new $t("Can't mix ordinal dates with month/day");let u;n?u=fi(Object.assign(hi(this.c),e)):be(e.ordinal)?(u=Object.assign(this.toObject(),e),be(e.day)&&(u.day=Math.min(Pe(u.year,u.month),u.day))):u=pi(Object.assign(di(this.c),e));const[c,l]=Ii(u,this.o,this.zone);return wi(this,{ts:c,o:l})}plus(t){if(!this.isValid)return this;return wi(this,Si(this,Fr(t)))}minus(t){if(!this.isValid)return this;return wi(this,Si(this,Fr(t).negate()))}startOf(t){if(!this.isValid)return this;const e={},n=Rr.normalizeUnit(t);switch(n){case"years":e.month=1;case"quarters":case"months":e.day=1;case"weeks":case"days":e.hour=0;case"hours":e.minute=0;case"minutes":e.second=0;case"seconds":e.millisecond=0}if("weeks"===n&&(e.weekday=1),"quarters"===n){const t=Math.ceil(this.month/3);e.month=3*(t-1)+1}return this.set(e)}endOf(t){return this.isValid?this.plus({[t]:1}).startOf(t).minus(1):this}toFormat(t,e={}){return this.isValid?cn.create(this.loc.redefaultToEN(e)).formatDateTimeFromString(this,t):gi}toLocaleString(t=Yt){return this.isValid?cn.create(this.loc.clone(t),t).formatDateTime(this):gi}toLocaleParts(t={}){return this.isValid?cn.create(this.loc.clone(t),t).formatDateTimeParts(this):[]}toISO(t={}){return this.isValid?`${this.toISODate(t)}T${this.toISOTime(t)}`:null}toISODate({format:t="extended"}={}){let e="basic"===t?"yyyyMMdd":"yyyy-MM-dd";return this.year>9999&&(e="+"+e),ki(this,e)}toISOWeekDate(){return ki(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:t=!1,suppressSeconds:e=!1,includeOffset:n=!0,includePrefix:r=!1,format:i="extended"}={}){return Ni(this,{suppressSeconds:e,suppressMilliseconds:t,includeOffset:n,includePrefix:r,format:i})}toRFC2822(){return ki(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return ki(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return ki(this,"yyyy-MM-dd")}toSQLTime({includeOffset:t=!0,includeZone:e=!1}={}){return Ni(this,{includeOffset:t,includeZone:e,spaceZone:!0})}toSQL(t={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(t)}`:null}toString(){return this.isValid?this.toISO():gi}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(t={}){if(!this.isValid)return{};const e=Object.assign({},this.c);return t.includeConfig&&(e.outputCalendar=this.outputCalendar,e.numberingSystem=this.loc.numberingSystem,e.locale=this.loc.locale),e}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(t,e="milliseconds",n={}){if(!this.isValid||!t.isValid)return Rr.invalid(this.invalid||t.invalid,"created by diffing an invalid DateTime");const r=Object.assign({locale:this.locale,numberingSystem:this.numberingSystem},n),i=(a=e,Array.isArray(a)?a:[a]).map(Rr.normalizeUnit),o=t.valueOf()>this.valueOf(),s=Br(o?this:t,o?t:this,i,r);var a;return o?s.negate():s}diffNow(t="milliseconds",e={}){return this.diff(Fi.now(),t,e)}until(t){return this.isValid?qr.fromDateTimes(this,t):this}hasSame(t,e){if(!this.isValid)return!1;const n=t.valueOf(),r=this.setZone(t.zone,{keepLocalTime:!0});return r.startOf(e)<=n&&n<=r.endOf(e)}equals(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)}toRelative(t={}){if(!this.isValid)return null;const e=t.base||Fi.fromObject({zone:this.zone}),n=t.padding?this<e?-t.padding:t.padding:0;let r=["years","months","days","hours","minutes","seconds"],i=t.unit;return Array.isArray(t.unit)&&(r=t.unit,i=void 0),Ri(e,this.plus(n),Object.assign(t,{numeric:"always",units:r,unit:i}))}toRelativeCalendar(t={}){return this.isValid?Ri(t.base||Fi.fromObject({zone:this.zone}),this,Object.assign(t,{numeric:"auto",units:["years","months","days"],calendary:!0})):null}static min(...t){if(!t.every(Fi.isDateTime))throw new Gt("min requires all arguments be DateTimes");return _e(t,(t=>t.valueOf()),Math.min)}static max(...t){if(!t.every(Fi.isDateTime))throw new Gt("max requires all arguments be DateTimes");return _e(t,(t=>t.valueOf()),Math.max)}static fromFormatExplain(t,e,n={}){const{locale:r=null,numberingSystem:i=null}=n;return ii(Un.fromOpts({locale:r,numberingSystem:i,defaultToEN:!0}),t,e)}static fromStringExplain(t,e,n={}){return Fi.fromFormatExplain(t,e,n)}static get DATE_SHORT(){return Yt}static get DATE_MED(){return Jt}static get DATE_MED_WITH_WEEKDAY(){return Xt}static get DATE_FULL(){return te}static get DATE_HUGE(){return ee}static get TIME_SIMPLE(){return ne}static get TIME_WITH_SECONDS(){return re}static get TIME_WITH_SHORT_OFFSET(){return ie}static get TIME_WITH_LONG_OFFSET(){return oe}static get TIME_24_SIMPLE(){return se}static get TIME_24_WITH_SECONDS(){return ae}static get TIME_24_WITH_SHORT_OFFSET(){return ue}static get TIME_24_WITH_LONG_OFFSET(){return ce}static get DATETIME_SHORT(){return le}static get DATETIME_SHORT_WITH_SECONDS(){return he}static get DATETIME_MED(){return fe}static get DATETIME_MED_WITH_SECONDS(){return de}static get DATETIME_MED_WITH_WEEKDAY(){return pe}static get DATETIME_FULL(){return me}static get DATETIME_FULL_WITH_SECONDS(){return ye}static get DATETIME_HUGE(){return ge}static get DATETIME_HUGE_WITH_SECONDS(){return ve}}function Vi(t){if(Fi.isDateTime(t))return t;if(t&&t.valueOf&&we(t.valueOf()))return Fi.fromJSDate(t);if(t&&"object"==typeof t)return Fi.fromObject(t);throw new Gt(`Unknown datetime argument: ${t}, of type ${typeof t}`)}function qi(t,e,n){if(t&&t.length){const[r,i]=e,o=Math.PI/180*n,s=Math.cos(o),a=Math.sin(o);t.forEach((t=>{const[e,n]=t;t[0]=(e-r)*s-(n-i)*a+r,t[1]=(e-r)*a+(n-i)*s+i}))}}function Ui(t){const e=t[0],n=t[1];return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}function ji(t,e,n,r){const i=e[1]-t[1],o=t[0]-e[0],s=i*t[0]+o*t[1],a=r[1]-n[1],u=n[0]-r[0],c=a*n[0]+u*n[1],l=i*u-a*o;return l?[(u*s-o*c)/l,(i*c-a*s)/l]:null}function Bi(t,e,n){const r=t.length;if(r<3)return!1;const i=[Number.MAX_SAFE_INTEGER,n],o=[e,n];let s=0;for(let a=0;a<r;a++){const e=t[a],n=t[(a+1)%r];if(Ki(e,n,o,i)){if(0===$i(e,o,n))return zi(e,o,n);s++}}return s%2==1}function zi(t,e,n){return e[0]<=Math.max(t[0],n[0])&&e[0]>=Math.min(t[0],n[0])&&e[1]<=Math.max(t[1],n[1])&&e[1]>=Math.min(t[1],n[1])}function $i(t,e,n){const r=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return 0===r?0:r>0?1:2}function Ki(t,e,n,r){const i=$i(t,e,n),o=$i(t,e,r),s=$i(n,r,t),a=$i(n,r,e);return i!==o&&s!==a||!(0!==i||!zi(t,n,e))||!(0!==o||!zi(t,r,e))||!(0!==s||!zi(n,t,r))||!(0!==a||!zi(n,e,r))}function Gi(t,e){const n=[0,0],r=Math.round(e.hachureAngle+90);r&&qi(t,n,r);const i=function(t,e){const n=[...t];n[0].join(",")!==n[n.length-1].join(",")&&n.push([n[0][0],n[0][1]]);const r=[];if(n&&n.length>2){let t=e.hachureGap;t<0&&(t=4*e.strokeWidth),t=Math.max(t,.1);const i=[];for(let e=0;e<n.length-1;e++){const t=n[e],r=n[e+1];if(t[1]!==r[1]){const e=Math.min(t[1],r[1]);i.push({ymin:e,ymax:Math.max(t[1],r[1]),x:e===t[1]?t[0]:r[0],islope:(r[0]-t[0])/(r[1]-t[1])})}}if(i.sort(((t,e)=>t.ymin<e.ymin?-1:t.ymin>e.ymin?1:t.x<e.x?-1:t.x>e.x?1:t.ymax===e.ymax?0:(t.ymax-e.ymax)/Math.abs(t.ymax-e.ymax))),!i.length)return r;let o=[],s=i[0].ymin;for(;o.length||i.length;){if(i.length){let t=-1;for(let e=0;e<i.length&&!(i[e].ymin>s);e++)t=e;i.splice(0,t+1).forEach((t=>{o.push({s:s,edge:t})}))}if(o=o.filter((t=>!(t.edge.ymax<=s))),o.sort(((t,e)=>t.edge.x===e.edge.x?0:(t.edge.x-e.edge.x)/Math.abs(t.edge.x-e.edge.x))),o.length>1)for(let t=0;t<o.length;t+=2){const e=t+1;if(e>=o.length)break;const n=o[t].edge,i=o[e].edge;r.push([[Math.round(n.x),s],[Math.round(i.x),s]])}s+=t,o.forEach((e=>{e.edge.x=e.edge.x+t*e.edge.islope}))}}return r}(t,e);return r&&(qi(t,n,-r),function(t,e,n){const r=[];t.forEach((t=>r.push(...t))),qi(r,e,n)}(i,n,-r)),i}class Wi{constructor(t){this.helper=t}fillPolygon(t,e){return this._fillPolygon(t,e)}_fillPolygon(t,e,n=!1){let r=Gi(t,e);if(n){const e=this.connectingLines(t,r);r=r.concat(e)}return{type:"fillSketch",ops:this.renderLines(r,e)}}renderLines(t,e){const n=[];for(const r of t)n.push(...this.helper.doubleLineOps(r[0][0],r[0][1],r[1][0],r[1][1],e));return n}connectingLines(t,e){const n=[];if(e.length>1)for(let r=1;r<e.length;r++){const i=e[r-1];if(Ui(i)<3)continue;const o=[e[r][0],i[1]];if(Ui(o)>3){const e=this.splitOnIntersections(t,o);n.push(...e)}}return n}midPointInPolygon(t,e){return Bi(t,(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2)}splitOnIntersections(t,e){const n=Math.max(5,.1*Ui(e)),r=[];for(let i=0;i<t.length;i++){const o=t[i],s=t[(i+1)%t.length];if(Ki(o,s,...e)){const t=ji(o,s,e[0],e[1]);if(t){const i=Ui([t,e[0]]),o=Ui([t,e[1]]);i>n&&o>n&&r.push({point:t,distance:i})}}}if(r.length>1){const n=r.sort(((t,e)=>t.distance-e.distance)).map((t=>t.point));if(Bi(t,...e[0])||n.shift(),Bi(t,...e[1])||n.pop(),n.length<=1)return this.midPointInPolygon(t,e)?[e]:[];const i=[e[0],...n,e[1]],o=[];for(let e=0;e<i.length-1;e+=2){const n=[i[e],i[e+1]];this.midPointInPolygon(t,n)&&o.push(n)}return o}return this.midPointInPolygon(t,e)?[e]:[]}}class Hi extends Wi{fillPolygon(t,e){return this._fillPolygon(t,e,!0)}}class Qi extends Wi{fillPolygon(t,e){const n=this._fillPolygon(t,e),r=Object.assign({},e,{hachureAngle:e.hachureAngle+90}),i=this._fillPolygon(t,r);return n.ops=n.ops.concat(i.ops),n}}class Zi{constructor(t){this.helper=t}fillPolygon(t,e){const n=Gi(t,e=Object.assign({},e,{curveStepCount:4,hachureAngle:0,roughness:1}));return this.dotsOnLines(n,e)}dotsOnLines(t,e){const n=[];let r=e.hachureGap;r<0&&(r=4*e.strokeWidth),r=Math.max(r,.1);let i=e.fillWeight;i<0&&(i=e.strokeWidth/2);const o=r/4;for(const s of t){const t=Ui(s),a=t/r,u=Math.ceil(a)-1,c=t-u*r,l=(s[0][0]+s[1][0])/2-r/4,h=Math.min(s[0][1],s[1][1]);for(let s=0;s<u;s++){const t=h+c+s*r,a=this.helper.randOffsetWithRange(l-o,l+o,e),u=this.helper.randOffsetWithRange(t-o,t+o,e),f=this.helper.ellipse(a,u,i,i,e);n.push(...f.ops)}}return{type:"fillSketch",ops:n}}}class Yi{constructor(t){this.helper=t}fillPolygon(t,e){const n=Gi(t,e);return{type:"fillSketch",ops:this.dashedLine(n,e)}}dashedLine(t,e){const n=e.dashOffset<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashOffset,r=e.dashGap<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashGap,i=[];return t.forEach((t=>{const o=Ui(t),s=Math.floor(o/(n+r)),a=(o+r-s*(n+r))/2;let u=t[0],c=t[1];u[0]>c[0]&&(u=t[1],c=t[0]);const l=Math.atan((c[1]-u[1])/(c[0]-u[0]));for(let h=0;h<s;h++){const t=h*(n+r),o=t+n,s=[u[0]+t*Math.cos(l)+a*Math.cos(l),u[1]+t*Math.sin(l)+a*Math.sin(l)],c=[u[0]+o*Math.cos(l)+a*Math.cos(l),u[1]+o*Math.sin(l)+a*Math.sin(l)];i.push(...this.helper.doubleLineOps(s[0],s[1],c[0],c[1],e))}})),i}}class Ji{constructor(t){this.helper=t}fillPolygon(t,e){const n=e.hachureGap<0?4*e.strokeWidth:e.hachureGap,r=e.zigzagOffset<0?n:e.zigzagOffset,i=Gi(t,e=Object.assign({},e,{hachureGap:n+r}));return{type:"fillSketch",ops:this.zigzagLines(i,r,e)}}zigzagLines(t,e,n){const r=[];return t.forEach((t=>{const i=Ui(t),o=Math.round(i/(2*e));let s=t[0],a=t[1];s[0]>a[0]&&(s=t[1],a=t[0]);const u=Math.atan((a[1]-s[1])/(a[0]-s[0]));for(let c=0;c<o;c++){const t=2*c*e,i=2*(c+1)*e,o=Math.sqrt(2*Math.pow(e,2)),a=[s[0]+t*Math.cos(u),s[1]+t*Math.sin(u)],l=[s[0]+i*Math.cos(u),s[1]+i*Math.sin(u)],h=[a[0]+o*Math.cos(u+Math.PI/4),a[1]+o*Math.sin(u+Math.PI/4)];r.push(...this.helper.doubleLineOps(a[0],a[1],h[0],h[1],n),...this.helper.doubleLineOps(h[0],h[1],l[0],l[1],n))}})),r}}const Xi={};class to{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const eo={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function no(t,e){return t.type===e}function ro(t){const e=[],n=function(t){const e=new Array;for(;""!==t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:0,text:RegExp.$1},t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];e[e.length]={type:1,text:`${parseFloat(RegExp.$1)}`},t=t.substr(RegExp.$1.length)}return e[e.length]={type:2,text:""},e}(t);let r="BOD",i=0,o=n[i];for(;!no(o,2);){let s=0;const a=[];if("BOD"===r){if("M"!==o.text&&"m"!==o.text)return ro("M0,0"+t);i++,s=eo[o.text],r=o.text}else no(o,1)?s=eo[r]:(i++,s=eo[o.text],r=o.text);if(!(i+s<n.length))throw new Error("Path data ended short");for(let t=i;t<i+s;t++){const e=n[t];if(!no(e,1))throw new Error("Param not a number: "+r+","+e.text);a[a.length]=+e.text}if("number"!=typeof eo[r])throw new Error("Bad segment: "+r);{const t={key:r,data:a};e.push(t),i+=s,o=n[i],"M"===r&&(r="L"),"m"===r&&(r="l")}}return e}function io(t){let e=0,n=0,r=0,i=0;const o=[];for(const{key:s,data:a}of t)switch(s){case"M":o.push({key:"M",data:[...a]}),[e,n]=a,[r,i]=a;break;case"m":e+=a[0],n+=a[1],o.push({key:"M",data:[e,n]}),r=e,i=n;break;case"L":o.push({key:"L",data:[...a]}),[e,n]=a;break;case"l":e+=a[0],n+=a[1],o.push({key:"L",data:[e,n]});break;case"C":o.push({key:"C",data:[...a]}),e=a[4],n=a[5];break;case"c":{const t=a.map(((t,r)=>r%2?t+n:t+e));o.push({key:"C",data:t}),e=t[4],n=t[5];break}case"Q":o.push({key:"Q",data:[...a]}),e=a[2],n=a[3];break;case"q":{const t=a.map(((t,r)=>r%2?t+n:t+e));o.push({key:"Q",data:t}),e=t[2],n=t[3];break}case"A":o.push({key:"A",data:[...a]}),e=a[5],n=a[6];break;case"a":e+=a[5],n+=a[6],o.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],e,n]});break;case"H":o.push({key:"H",data:[...a]}),e=a[0];break;case"h":e+=a[0],o.push({key:"H",data:[e]});break;case"V":o.push({key:"V",data:[...a]}),n=a[0];break;case"v":n+=a[0],o.push({key:"V",data:[n]});break;case"S":o.push({key:"S",data:[...a]}),e=a[2],n=a[3];break;case"s":{const t=a.map(((t,r)=>r%2?t+n:t+e));o.push({key:"S",data:t}),e=t[2],n=t[3];break}case"T":o.push({key:"T",data:[...a]}),e=a[0],n=a[1];break;case"t":e+=a[0],n+=a[1],o.push({key:"T",data:[e,n]});break;case"Z":case"z":o.push({key:"Z",data:[]}),e=r,n=i}return o}function oo(t){const e=[];let n="",r=0,i=0,o=0,s=0,a=0,u=0;for(const{key:c,data:l}of t){switch(c){case"M":e.push({key:"M",data:[...l]}),[r,i]=l,[o,s]=l;break;case"C":e.push({key:"C",data:[...l]}),r=l[4],i=l[5],a=l[2],u=l[3];break;case"L":e.push({key:"L",data:[...l]}),[r,i]=l;break;case"H":r=l[0],e.push({key:"L",data:[r,i]});break;case"V":i=l[0],e.push({key:"L",data:[r,i]});break;case"S":{let t=0,o=0;"C"===n||"S"===n?(t=r+(r-a),o=i+(i-u)):(t=r,o=i),e.push({key:"C",data:[t,o,...l]}),a=l[0],u=l[1],r=l[2],i=l[3];break}case"T":{const[t,o]=l;let s=0,c=0;"Q"===n||"T"===n?(s=r+(r-a),c=i+(i-u)):(s=r,c=i);const h=r+2*(s-r)/3,f=i+2*(c-i)/3,d=t+2*(s-t)/3,p=o+2*(c-o)/3;e.push({key:"C",data:[h,f,d,p,t,o]}),a=s,u=c,r=t,i=o;break}case"Q":{const[t,n,o,s]=l,c=r+2*(t-r)/3,h=i+2*(n-i)/3,f=o+2*(t-o)/3,d=s+2*(n-s)/3;e.push({key:"C",data:[c,h,f,d,o,s]}),a=t,u=n,r=o,i=s;break}case"A":{const t=Math.abs(l[0]),n=Math.abs(l[1]),o=l[2],s=l[3],a=l[4],u=l[5],c=l[6];0===t||0===n?(e.push({key:"C",data:[r,i,u,c,u,c]}),r=u,i=c):r===u&&i===c||(ao(r,i,u,c,t,n,o,s,a).forEach((function(t){e.push({key:"C",data:t})})),r=u,i=c);break}case"Z":e.push({key:"Z",data:[]}),r=o,i=s}n=c}return e}function so(t,e,n){return[t*Math.cos(n)-e*Math.sin(n),t*Math.sin(n)+e*Math.cos(n)]}function ao(t,e,n,r,i,o,s,a,u,c){const l=(h=s,Math.PI*h/180);var h;let f=[],d=0,p=0,m=0,y=0;if(c)[d,p,m,y]=c;else{[t,e]=so(t,e,-l),[n,r]=so(n,r,-l);const s=(t-n)/2,c=(e-r)/2;let h=s*s/(i*i)+c*c/(o*o);h>1&&(h=Math.sqrt(h),i*=h,o*=h);const f=i*i,g=o*o,v=f*g-f*c*c-g*s*s,b=f*c*c+g*s*s,w=(a===u?-1:1)*Math.sqrt(Math.abs(v/b));m=w*i*c/o+(t+n)/2,y=w*-o*s/i+(e+r)/2,d=Math.asin(parseFloat(((e-y)/o).toFixed(9))),p=Math.asin(parseFloat(((r-y)/o).toFixed(9))),t<m&&(d=Math.PI-d),n<m&&(p=Math.PI-p),d<0&&(d=2*Math.PI+d),p<0&&(p=2*Math.PI+p),u&&d>p&&(d-=2*Math.PI),!u&&p>d&&(p-=2*Math.PI)}let g=p-d;if(Math.abs(g)>120*Math.PI/180){const t=p,e=n,a=r;p=u&&p>d?d+120*Math.PI/180*1:d+120*Math.PI/180*-1,f=ao(n=m+i*Math.cos(p),r=y+o*Math.sin(p),e,a,i,o,s,0,u,[p,t,m,y])}g=p-d;const v=Math.cos(d),b=Math.sin(d),w=Math.cos(p),T=Math.sin(p),E=Math.tan(g/4),I=4/3*i*E,S=4/3*o*E,_=[t,e],k=[t+I*b,e-S*v],N=[n+I*T,r-S*w],D=[n,r];if(k[0]=2*_[0]-k[0],k[1]=2*_[1]-k[1],c)return[k,N,D].concat(f);{f=[k,N,D].concat(f);const t=[];for(let e=0;e<f.length;e+=3){const n=so(f[e][0],f[e][1],l),r=so(f[e+1][0],f[e+1][1],l),i=so(f[e+2][0],f[e+2][1],l);t.push([n[0],n[1],r[0],r[1],i[0],i[1]])}return t}}const uo={randOffset:function(t,e){return bo(t,e)},randOffsetWithRange:function(t,e,n){return vo(t,e,n)},ellipse:function(t,e,n,r,i){return fo(t,e,i,ho(n,r,i)).opset},doubleLineOps:function(t,e,n,r,i){return wo(t,e,n,r,i,!0)}};function co(t,e,n,r,i){return{type:"path",ops:wo(t,e,n,r,i)}}function lo(t,e,n){const r=(t||[]).length;if(r>2){const i=[];for(let e=0;e<r-1;e++)i.push(...wo(t[e][0],t[e][1],t[e+1][0],t[e+1][1],n));return e&&i.push(...wo(t[r-1][0],t[r-1][1],t[0][0],t[0][1],n)),{type:"path",ops:i}}return 2===r?co(t[0][0],t[0][1],t[1][0],t[1][1],n):{type:"path",ops:[]}}function ho(t,e,n){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(t/2,2)+Math.pow(e/2,2))/2)),i=Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r),o=2*Math.PI/i;let s=Math.abs(t/2),a=Math.abs(e/2);const u=1-n.curveFitting;return s+=bo(s*u,n),a+=bo(a*u,n),{increment:o,rx:s,ry:a}}function fo(t,e,n,r){const[i,o]=So(r.increment,t,e,r.rx,r.ry,1,r.increment*vo(.1,vo(.4,1,n),n),n);let s=Io(i,null,n);if(!n.disableMultiStroke){const[i]=So(r.increment,t,e,r.rx,r.ry,1.5,0,n),o=Io(i,null,n);s=s.concat(o)}return{estimatedPoints:o,opset:{type:"path",ops:s}}}function po(t,e,n,r,i,o,s,a,u){const c=t,l=e;let h=Math.abs(n/2),f=Math.abs(r/2);h+=bo(.01*h,u),f+=bo(.01*f,u);let d=i,p=o;for(;d<0;)d+=2*Math.PI,p+=2*Math.PI;p-d>2*Math.PI&&(d=0,p=2*Math.PI);const m=2*Math.PI/u.curveStepCount,y=Math.min(m/2,(p-d)/2),g=_o(y,c,l,h,f,d,p,1,u);if(!u.disableMultiStroke){const t=_o(y,c,l,h,f,d,p,1.5,u);g.push(...t)}return s&&(a?g.push(...wo(c,l,c+h*Math.cos(d),l+f*Math.sin(d),u),...wo(c,l,c+h*Math.cos(p),l+f*Math.sin(p),u)):g.push({op:"lineTo",data:[c,l]},{op:"lineTo",data:[c+h*Math.cos(d),l+f*Math.sin(d)]})),{type:"path",ops:g}}function mo(t,e){const n=[];if(t.length){const r=e.maxRandomnessOffset||0,i=t.length;if(i>2){n.push({op:"move",data:[t[0][0]+bo(r,e),t[0][1]+bo(r,e)]});for(let o=1;o<i;o++)n.push({op:"lineTo",data:[t[o][0]+bo(r,e),t[o][1]+bo(r,e)]})}}return{type:"fillPath",ops:n}}function yo(t,e){return function(t,e){let n=t.fillStyle||"hachure";if(!Xi[n])switch(n){case"zigzag":Xi[n]||(Xi[n]=new Hi(e));break;case"cross-hatch":Xi[n]||(Xi[n]=new Qi(e));break;case"dots":Xi[n]||(Xi[n]=new Zi(e));break;case"dashed":Xi[n]||(Xi[n]=new Yi(e));break;case"zigzag-line":Xi[n]||(Xi[n]=new Ji(e));break;case"hachure":default:n="hachure",Xi[n]||(Xi[n]=new Wi(e))}return Xi[n]}(e,uo).fillPolygon(t,e)}function go(t){return t.randomizer||(t.randomizer=new to(t.seed||0)),t.randomizer.next()}function vo(t,e,n,r=1){return n.roughness*r*(go(n)*(e-t)+t)}function bo(t,e,n=1){return vo(-t,t,e,n)}function wo(t,e,n,r,i,o=!1){const s=o?i.disableMultiStrokeFill:i.disableMultiStroke,a=To(t,e,n,r,i,!0,!1);if(s)return a;const u=To(t,e,n,r,i,!0,!0);return a.concat(u)}function To(t,e,n,r,i,o,s){const a=Math.pow(t-n,2)+Math.pow(e-r,2),u=Math.sqrt(a);let c=1;c=u<200?1:u>500?.4:-.0016668*u+1.233334;let l=i.maxRandomnessOffset||0;l*l*100>a&&(l=u/10);const h=l/2,f=.2+.2*go(i);let d=i.bowing*i.maxRandomnessOffset*(r-e)/200,p=i.bowing*i.maxRandomnessOffset*(t-n)/200;d=bo(d,i,c),p=bo(p,i,c);const m=[],y=()=>bo(h,i,c),g=()=>bo(l,i,c),v=i.preserveVertices;return o&&(s?m.push({op:"move",data:[t+(v?0:y()),e+(v?0:y())]}):m.push({op:"move",data:[t+(v?0:bo(l,i,c)),e+(v?0:bo(l,i,c))]})),s?m.push({op:"bcurveTo",data:[d+t+(n-t)*f+y(),p+e+(r-e)*f+y(),d+t+2*(n-t)*f+y(),p+e+2*(r-e)*f+y(),n+(v?0:y()),r+(v?0:y())]}):m.push({op:"bcurveTo",data:[d+t+(n-t)*f+g(),p+e+(r-e)*f+g(),d+t+2*(n-t)*f+g(),p+e+2*(r-e)*f+g(),n+(v?0:g()),r+(v?0:g())]}),m}function Eo(t,e,n){const r=[];r.push([t[0][0]+bo(e,n),t[0][1]+bo(e,n)]),r.push([t[0][0]+bo(e,n),t[0][1]+bo(e,n)]);for(let i=1;i<t.length;i++)r.push([t[i][0]+bo(e,n),t[i][1]+bo(e,n)]),i===t.length-1&&r.push([t[i][0]+bo(e,n),t[i][1]+bo(e,n)]);return Io(r,null,n)}function Io(t,e,n){const r=t.length,i=[];if(r>3){const o=[],s=1-n.curveTightness;i.push({op:"move",data:[t[1][0],t[1][1]]});for(let e=1;e+2<r;e++){const n=t[e];o[0]=[n[0],n[1]],o[1]=[n[0]+(s*t[e+1][0]-s*t[e-1][0])/6,n[1]+(s*t[e+1][1]-s*t[e-1][1])/6],o[2]=[t[e+1][0]+(s*t[e][0]-s*t[e+2][0])/6,t[e+1][1]+(s*t[e][1]-s*t[e+2][1])/6],o[3]=[t[e+1][0],t[e+1][1]],i.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[3][0],o[3][1]]})}if(e&&2===e.length){const t=n.maxRandomnessOffset;i.push({op:"lineTo",data:[e[0]+bo(t,n),e[1]+bo(t,n)]})}}else 3===r?(i.push({op:"move",data:[t[1][0],t[1][1]]}),i.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===r&&i.push(...wo(t[0][0],t[0][1],t[1][0],t[1][1],n));return i}function So(t,e,n,r,i,o,s,a){const u=[],c=[],l=bo(.5,a)-Math.PI/2;c.push([bo(o,a)+e+.9*r*Math.cos(l-t),bo(o,a)+n+.9*i*Math.sin(l-t)]);for(let h=l;h<2*Math.PI+l-.01;h+=t){const t=[bo(o,a)+e+r*Math.cos(h),bo(o,a)+n+i*Math.sin(h)];u.push(t),c.push(t)}return c.push([bo(o,a)+e+r*Math.cos(l+2*Math.PI+.5*s),bo(o,a)+n+i*Math.sin(l+2*Math.PI+.5*s)]),c.push([bo(o,a)+e+.98*r*Math.cos(l+s),bo(o,a)+n+.98*i*Math.sin(l+s)]),c.push([bo(o,a)+e+.9*r*Math.cos(l+.5*s),bo(o,a)+n+.9*i*Math.sin(l+.5*s)]),[c,u]}function _o(t,e,n,r,i,o,s,a,u){const c=o+bo(.1,u),l=[];l.push([bo(a,u)+e+.9*r*Math.cos(c-t),bo(a,u)+n+.9*i*Math.sin(c-t)]);for(let h=c;h<=s;h+=t)l.push([bo(a,u)+e+r*Math.cos(h),bo(a,u)+n+i*Math.sin(h)]);return l.push([e+r*Math.cos(s),n+i*Math.sin(s)]),l.push([e+r*Math.cos(s),n+i*Math.sin(s)]),Io(l,null,u)}function ko(t,e,n,r,i,o,s,a){const u=[],c=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3];let l=[0,0];const h=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let d=0;d<h;d++)0===d?u.push({op:"move",data:[s[0],s[1]]}):u.push({op:"move",data:[s[0]+(f?0:bo(c[0],a)),s[1]+(f?0:bo(c[0],a))]}),l=f?[i,o]:[i+bo(c[d],a),o+bo(c[d],a)],u.push({op:"bcurveTo",data:[t+bo(c[d],a),e+bo(c[d],a),n+bo(c[d],a),r+bo(c[d],a),l[0],l[1]]});return u}function No(t){return[...t]}function Do(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function Oo(t,e,n){const r=Do(e,n);if(0===r)return Do(t,e);let i=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/r;return i=Math.max(0,Math.min(1,i)),Do(t,Ao(e,n,i))}function Ao(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function Co(t,e,n,r){const i=r||[];if(function(t,e){const n=t[e+0],r=t[e+1],i=t[e+2],o=t[e+3];let s=3*r[0]-2*n[0]-o[0];s*=s;let a=3*r[1]-2*n[1]-o[1];a*=a;let u=3*i[0]-2*o[0]-n[0];u*=u;let c=3*i[1]-2*o[1]-n[1];return c*=c,s<u&&(s=u),a<c&&(a=c),s+a}(t,e)<n){const n=t[e+0];i.length?(o=i[i.length-1],s=n,Math.sqrt(Do(o,s))>1&&i.push(n)):i.push(n),i.push(t[e+3])}else{const r=.5,o=t[e+0],s=t[e+1],a=t[e+2],u=t[e+3],c=Ao(o,s,r),l=Ao(s,a,r),h=Ao(a,u,r),f=Ao(c,l,r),d=Ao(l,h,r),p=Ao(f,d,r);Co([o,c,f,p],0,n,i),Co([p,d,h,u],0,n,i)}var o,s;return i}function Mo(t,e){return xo(t,0,t.length,e)}function xo(t,e,n,r,i){const o=i||[],s=t[e],a=t[n-1];let u=0,c=1;for(let l=e+1;l<n-1;++l){const e=Oo(t[l],s,a);e>u&&(u=e,c=l)}return Math.sqrt(u)>r?(xo(t,e,c+1,r,o),xo(t,c,n,r,o)):(o.length||o.push(s),o.push(a)),o}function Lo(t,e=.15,n){const r=[],i=(t.length-1)/3;for(let o=0;o<i;o++)Co(t,3*o,e,r);return n&&n>0?xo(r,0,r.length,n):r}const Po="none";class Ro{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,combineNestedSvgPaths:!1,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,e,n){return{shape:t,sets:e||[],options:n||this.defaultOptions}}line(t,e,n,r,i){const o=this._o(i);return this._d("line",[co(t,e,n,r,o)],o)}rectangle(t,e,n,r,i){const o=this._o(i),s=[],a=function(t,e,n,r,i){return lo([[t,e],[t+n,e],[t+n,e+r],[t,e+r]],!0,i)}(t,e,n,r,o);if(o.fill){const i=[[t,e],[t+n,e],[t+n,e+r],[t,e+r]];"solid"===o.fillStyle?s.push(mo(i,o)):s.push(yo(i,o))}return o.stroke!==Po&&s.push(a),this._d("rectangle",s,o)}ellipse(t,e,n,r,i){const o=this._o(i),s=[],a=ho(n,r,o),u=fo(t,e,o,a);if(o.fill)if("solid"===o.fillStyle){const n=fo(t,e,o,a).opset;n.type="fillPath",s.push(n)}else s.push(yo(u.estimatedPoints,o));return o.stroke!==Po&&s.push(u.opset),this._d("ellipse",s,o)}circle(t,e,n,r){const i=this.ellipse(t,e,n,n,r);return i.shape="circle",i}linearPath(t,e){const n=this._o(e);return this._d("linearPath",[lo(t,!1,n)],n)}arc(t,e,n,r,i,o,s=!1,a){const u=this._o(a),c=[],l=po(t,e,n,r,i,o,s,!0,u);if(s&&u.fill)if("solid"===u.fillStyle){const s=po(t,e,n,r,i,o,!0,!1,u);s.type="fillPath",c.push(s)}else c.push(function(t,e,n,r,i,o,s){const a=t,u=e;let c=Math.abs(n/2),l=Math.abs(r/2);c+=bo(.01*c,s),l+=bo(.01*l,s);let h=i,f=o;for(;h<0;)h+=2*Math.PI,f+=2*Math.PI;f-h>2*Math.PI&&(h=0,f=2*Math.PI);const d=(f-h)/s.curveStepCount,p=[];for(let m=h;m<=f;m+=d)p.push([a+c*Math.cos(m),u+l*Math.sin(m)]);return p.push([a+c*Math.cos(f),u+l*Math.sin(f)]),p.push([a,u]),yo(p,s)}(t,e,n,r,i,o,u));return u.stroke!==Po&&c.push(l),this._d("arc",c,u)}curve(t,e){const n=this._o(e),r=[],i=function(t,e){let n=Eo(t,1*(1+.2*e.roughness),e);if(!e.disableMultiStroke){const r=Eo(t,1.5*(1+.22*e.roughness),function(t){const e=Object.assign({},t);return e.randomizer=void 0,t.seed&&(e.seed=t.seed+1),e}(e));n=n.concat(r)}return{type:"path",ops:n}}(t,n);if(n.fill&&n.fill!==Po&&t.length>=3){const e=Lo(function(t,e=0){const n=t.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(3===n)r.push(No(t[0]),No(t[1]),No(t[2]),No(t[2]));else{const n=[];n.push(t[0],t[0]);for(let e=1;e<t.length;e++)n.push(t[e]),e===t.length-1&&n.push(t[e]);const i=[],o=1-e;r.push(No(n[0]));for(let t=1;t+2<n.length;t++){const e=n[t];i[0]=[e[0],e[1]],i[1]=[e[0]+(o*n[t+1][0]-o*n[t-1][0])/6,e[1]+(o*n[t+1][1]-o*n[t-1][1])/6],i[2]=[n[t+1][0]+(o*n[t][0]-o*n[t+2][0])/6,n[t+1][1]+(o*n[t][1]-o*n[t+2][1])/6],i[3]=[n[t+1][0],n[t+1][1]],r.push(i[1],i[2],i[3])}}return r}(t),10,(1+n.roughness)/2);"solid"===n.fillStyle?r.push(mo(e,n)):r.push(yo(e,n))}return n.stroke!==Po&&r.push(i),this._d("curve",r,n)}polygon(t,e){const n=this._o(e),r=[],i=lo(t,!0,n);return n.fill&&("solid"===n.fillStyle?r.push(mo(t,n)):r.push(yo(t,n))),n.stroke!==Po&&r.push(i),this._d("polygon",r,n)}path(t,e){const n=this._o(e),r=[];if(!t)return this._d("path",r,n);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const i=n.fill&&"transparent"!==n.fill&&n.fill!==Po,o=n.stroke!==Po,s=!!(n.simplification&&n.simplification<1),a=function(t,e,n){const r=oo(io(ro(t))),i=[];let o=[],s=[0,0],a=[];const u=()=>{a.length>=4&&o.push(...Lo(a,1)),a=[]},c=()=>{u(),o.length&&(i.push(o),o=[])};for(const{key:h,data:f}of r)switch(h){case"M":c(),s=[f[0],f[1]],o.push(s);break;case"L":u(),o.push([f[0],f[1]]);break;case"C":if(!a.length){const t=o.length?o[o.length-1]:s;a.push([t[0],t[1]])}a.push([f[0],f[1]]),a.push([f[2],f[3]]),a.push([f[4],f[5]]);break;case"Z":u(),o.push([s[0],s[1]])}if(c(),!n)return i;const l=[];for(const h of i){const t=Mo(h,n);t.length&&l.push(t)}return l}(t,0,s?4-4*n.simplification:(1+n.roughness)/2);if(i)if(n.combineNestedSvgPaths){const t=[];a.forEach((e=>t.push(...e))),"solid"===n.fillStyle?r.push(mo(t,n)):r.push(yo(t,n))}else a.forEach((t=>{"solid"===n.fillStyle?r.push(mo(t,n)):r.push(yo(t,n))}));return o&&(s?a.forEach((t=>{r.push(lo(t,!1,n))})):r.push(function(t,e){const n=oo(io(ro(t))),r=[];let i=[0,0],o=[0,0];for(const{key:s,data:a}of n)switch(s){case"M":{const t=1*(e.maxRandomnessOffset||0),n=e.preserveVertices;r.push({op:"move",data:a.map((r=>r+(n?0:bo(t,e))))}),o=[a[0],a[1]],i=[a[0],a[1]];break}case"L":r.push(...wo(o[0],o[1],a[0],a[1],e)),o=[a[0],a[1]];break;case"C":{const[t,n,i,s,u,c]=a;r.push(...ko(t,n,i,s,u,c,o,e)),o=[u,c];break}case"Z":r.push(...wo(o[0],o[1],i[0],i[1],e)),o=[i[0],i[1]]}return{type:"path",ops:r}}(t,n))),this._d("path",r,n)}opsToPath(t,e){let n="";for(const r of t.ops){const t="number"==typeof e&&e>=0?r.data.map((t=>+t.toFixed(e))):r.data;switch(r.op){case"move":n+=`M${t[0]} ${t[1]} `;break;case"bcurveTo":n+=`C${t[0]} ${t[1]}, ${t[2]} ${t[3]}, ${t[4]} ${t[5]} `;break;case"lineTo":n+=`L${t[0]} ${t[1]} `}}return n.trim()}toPaths(t){const e=t.sets||[],n=t.options||this.defaultOptions,r=[];for(const i of e){let t=null;switch(i.type){case"path":t={d:this.opsToPath(i),stroke:n.stroke,strokeWidth:n.strokeWidth,fill:Po};break;case"fillPath":t={d:this.opsToPath(i),stroke:Po,strokeWidth:0,fill:n.fill||Po};break;case"fillSketch":t=this.fillSketch(i,n)}t&&r.push(t)}return r}fillSketch(t,e){let n=e.fillWeight;return n<0&&(n=e.strokeWidth/2),{d:this.opsToPath(t),stroke:e.fill||Po,strokeWidth:n,fill:Po}}}class Fo{constructor(t,e){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new Ro(e)}draw(t){const e=t.sets||[],n=t.options||this.getDefaultOptions(),r=this.ctx;for(const i of e)switch(i.type){case"path":r.save(),r.strokeStyle="none"===n.stroke?"transparent":n.stroke,r.lineWidth=n.strokeWidth,n.strokeLineDash&&r.setLineDash(n.strokeLineDash),n.strokeLineDashOffset&&(r.lineDashOffset=n.strokeLineDashOffset),this._drawToContext(r,i),r.restore();break;case"fillPath":r.save(),r.fillStyle=n.fill||"";const e="curve"===t.shape||"polygon"===t.shape?"evenodd":"nonzero";this._drawToContext(r,i,e),r.restore();break;case"fillSketch":this.fillSketch(r,i,n)}}fillSketch(t,e,n){let r=n.fillWeight;r<0&&(r=n.strokeWidth/2),t.save(),n.fillLineDash&&t.setLineDash(n.fillLineDash),n.fillLineDashOffset&&(t.lineDashOffset=n.fillLineDashOffset),t.strokeStyle=n.fill||"",t.lineWidth=r,this._drawToContext(t,e),t.restore()}_drawToContext(t,e,n="nonzero"){t.beginPath();for(const r of e.ops){const e=r.data;switch(r.op){case"move":t.moveTo(e[0],e[1]);break;case"bcurveTo":t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5]);break;case"lineTo":t.lineTo(e[0],e[1])}}"fillPath"===e.type?t.fill(n):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,e,n,r,i){const o=this.gen.line(t,e,n,r,i);return this.draw(o),o}rectangle(t,e,n,r,i){const o=this.gen.rectangle(t,e,n,r,i);return this.draw(o),o}ellipse(t,e,n,r,i){const o=this.gen.ellipse(t,e,n,r,i);return this.draw(o),o}circle(t,e,n,r){const i=this.gen.circle(t,e,n,r);return this.draw(i),i}linearPath(t,e){const n=this.gen.linearPath(t,e);return this.draw(n),n}polygon(t,e){const n=this.gen.polygon(t,e);return this.draw(n),n}arc(t,e,n,r,i,o,s=!1,a){const u=this.gen.arc(t,e,n,r,i,o,s,a);return this.draw(u),u}curve(t,e){const n=this.gen.curve(t,e);return this.draw(n),n}path(t,e){const n=this.gen.path(t,e);return this.draw(n),n}}const Vo="http://www.w3.org/2000/svg";class qo{constructor(t,e){this.svg=t,this.gen=new Ro(e)}draw(t){const e=t.sets||[],n=t.options||this.getDefaultOptions(),r=this.svg.ownerDocument||window.document,i=r.createElementNS(Vo,"g"),o=t.options.fixedDecimalPlaceDigits;for(const s of e){let e=null;switch(s.type){case"path":e=r.createElementNS(Vo,"path"),e.setAttribute("d",this.opsToPath(s,o)),e.setAttribute("stroke",n.stroke),e.setAttribute("stroke-width",n.strokeWidth+""),e.setAttribute("fill","none"),n.strokeLineDash&&e.setAttribute("stroke-dasharray",n.strokeLineDash.join(" ").trim()),n.strokeLineDashOffset&&e.setAttribute("stroke-dashoffset",`${n.strokeLineDashOffset}`);break;case"fillPath":e=r.createElementNS(Vo,"path"),e.setAttribute("d",this.opsToPath(s,o)),e.setAttribute("stroke","none"),e.setAttribute("stroke-width","0"),e.setAttribute("fill",n.fill||""),"curve"!==t.shape&&"polygon"!==t.shape||e.setAttribute("fill-rule","evenodd");break;case"fillSketch":e=this.fillSketch(r,s,n)}e&&i.appendChild(e)}return i}fillSketch(t,e,n){let r=n.fillWeight;r<0&&(r=n.strokeWidth/2);const i=t.createElementNS(Vo,"path");return i.setAttribute("d",this.opsToPath(e,n.fixedDecimalPlaceDigits)),i.setAttribute("stroke",n.fill||""),i.setAttribute("stroke-width",r+""),i.setAttribute("fill","none"),n.fillLineDash&&i.setAttribute("stroke-dasharray",n.fillLineDash.join(" ").trim()),n.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${n.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,e){return this.gen.opsToPath(t,e)}line(t,e,n,r,i){const o=this.gen.line(t,e,n,r,i);return this.draw(o)}rectangle(t,e,n,r,i){const o=this.gen.rectangle(t,e,n,r,i);return this.draw(o)}ellipse(t,e,n,r,i){const o=this.gen.ellipse(t,e,n,r,i);return this.draw(o)}circle(t,e,n,r){const i=this.gen.circle(t,e,n,r);return this.draw(i)}linearPath(t,e){const n=this.gen.linearPath(t,e);return this.draw(n)}polygon(t,e){const n=this.gen.polygon(t,e);return this.draw(n)}arc(t,e,n,r,i,o,s=!1,a){const u=this.gen.arc(t,e,n,r,i,o,s,a);return this.draw(u)}curve(t,e){const n=this.gen.curve(t,e);return this.draw(n)}path(t,e){const n=this.gen.path(t,e);return this.draw(n)}}var Uo={canvas:(t,e)=>new Fo(t,e),svg:(t,e)=>new qo(t,e),generator:t=>new Ro(t),newSeed:()=>Ro.newSeed()};function jo(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})})),e}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Bo=function(t,e){return(Bo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function zo(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Bo(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var $o=function(){return($o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Ko(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(Ww){o(Ww)}}function a(t){try{u(r.throw(t))}catch(Ww){o(Ww)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function Go(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(Ww){o=[6,Ww],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function Wo(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ho(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function Qo(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,d=63&c;u||(d=64,s||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var l=s<<4&240|a>>2;if(r.push(l),64!==u){var h=a<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function Yo(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=Yo(t[n],e[n]));return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Jo=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Xo(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function ts(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(Ww){return!1}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var es=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,ns.prototype.create),o}return zo(e,t),e}(Error),ns=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?rs(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new es(i,a,r);return u},t}();function rs(t,e){return t.replace(is,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var is=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ss(t,e){var n=new as(t,e);return n.subscribe.bind(n)}var as=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=us),void 0===r.error&&(r.error=us),void 0===r.complete&&(r.complete=us);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(Ww){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(Ww){"undefined"!=typeof console&&console.error&&console.error(Ww)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function us(){}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(t){return t&&t._delegate?t._delegate:t}var ls=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),hs=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Set}return t.prototype.get=function(t){void 0===t&&(t="[DEFAULT]");var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Jo;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(Ww){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=$o({identifier:"[DEFAULT]",optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);if(!this.isInitialized(i)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:i})}catch(Ww){if(r)return null;throw Ww}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t))try{this.getOrInitializeService({instanceIdentifier:"[DEFAULT]"})}catch(Ww){}try{for(var r=Wo(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Ho(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(Ww){}}}catch(l){e={error:l}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Ko(this,void 0,void 0,(function(){var t;return Go(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Qo(Qo([],Ho(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),Ho(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t="[DEFAULT]"),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.instanceIdentifier,i=void 0===r?"[DEFAULT]":r,o=t.options,s=void 0===o?{}:o,a=this.normalizeInstanceIdentifier(i);if(this.isInitialized(a))throw Error(this.name+"("+a+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var u=this.getOrInitializeService({instanceIdentifier:a,options:s});try{for(var c=Wo(this.instancesDeferred.entries()),l=c.next();!l.done;l=c.next()){var h=Ho(l.value,2),f=h[0],d=h[1];a===this.normalizeInstanceIdentifier(f)&&d.resolve(u)}}catch(p){e={error:p}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return this.invokeOnInitCallbacks(u,a),u},t.prototype.onInit=function(t){var e=this;return this.onInitCallbacks.add(t),function(){e.onInitCallbacks.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r;try{for(var i=Wo(this.onInitCallbacks),o=i.next();!o.done;o=i.next()){var s=o.value;try{s(t,e)}catch(a){}}}catch(u){n={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,"[DEFAULT]"===e?void 0:e),options:i}),this.instances.set(n,o),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(s){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fs,ds=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new hs(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function ps(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ms,ys,gs=[];(ys=ms||(ms={}))[ys.DEBUG=0]="DEBUG",ys[ys.VERBOSE=1]="VERBOSE",ys[ys.INFO=2]="INFO",ys[ys.WARN=3]="WARN",ys[ys.ERROR=4]="ERROR",ys[ys.SILENT=5]="SILENT";var vs,bs={debug:ms.DEBUG,verbose:ms.VERBOSE,info:ms.INFO,warn:ms.WARN,error:ms.ERROR,silent:ms.SILENT},ws=ms.INFO,Ts=((fs={})[ms.DEBUG]="log",fs[ms.VERBOSE]="log",fs[ms.INFO]="info",fs[ms.WARN]="warn",fs[ms.ERROR]="error",fs),Es=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=Ts[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,ps(["["+i+"]  "+t.name+":"],n))}},Is=function(){function t(t){this.name=t,this._logLevel=ws,this._logHandler=Es,this._userLogHandler=null,gs.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in ms))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?bs[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ps([this,ms.DEBUG],t)),this._logHandler.apply(this,ps([this,ms.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ps([this,ms.VERBOSE],t)),this._logHandler.apply(this,ps([this,ms.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ps([this,ms.INFO],t)),this._logHandler.apply(this,ps([this,ms.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ps([this,ms.WARN],t)),this._logHandler.apply(this,ps([this,ms.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ps([this,ms.ERROR],t)),this._logHandler.apply(this,ps([this,ms.ERROR],t))},t}();function Ss(t){gs.forEach((function(e){e.setLogLevel(t)}))}var _s,ks=((vs={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",vs["bad-app-name"]="Illegal App name: '{$appName}",vs["duplicate-app"]="Firebase App named '{$appName}' already exists",vs["app-deleted"]="Firebase App named '{$appName}' already deleted",vs["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",vs["invalid-log-argument"]="First argument to `onLog` must be null or a function.",vs),Ns=new ns("app","Firebase",ks),Ds=((_s={})["@firebase/app"]="fire-core",_s["@firebase/analytics"]="fire-analytics",_s["@firebase/app-check"]="fire-app-check",_s["@firebase/auth"]="fire-auth",_s["@firebase/database"]="fire-rtdb",_s["@firebase/functions"]="fire-fn",_s["@firebase/installations"]="fire-iid",_s["@firebase/messaging"]="fire-fcm",_s["@firebase/performance"]="fire-perf",_s["@firebase/remote-config"]="fire-rc",_s["@firebase/storage"]="fire-gcs",_s["@firebase/firestore"]="fire-fst",_s["fire-js"]="fire-js",_s["firebase-wrapper"]="fire-js-all",_s),Os=new Is("@firebase/app"),As=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Yo(void 0,t),this.container=new ds(e.name),this._addComponent(new ls("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(Ww){Os.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,Ww)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Ns.create("app-deleted",{appName:this.name_})},t}();As.prototype.name&&As.prototype.options||As.prototype.delete||console.log("dc");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Cs(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name="[DEFAULT]");var s=o.name;if("string"!=typeof s||!s)throw Ns.create("bad-app-name",{appName:String(s)});if(os(e,s))throw Ns.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=Ds[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void Os.warn(u.join(" "))}o(new ls(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:Ss,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw Ns.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=bs[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:ms[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=gs;r<i.length;r++)n(i[r])}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t,e)},apps:null,SDK_VERSION:"8.6.1",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!os(e,t=t||"[DEFAULT]"))throw Ns.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return Os.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw Ns.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&Yo(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var l=c[u];e[l]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ms=function t(){var e=Cs(As);return e.INTERNAL=$o($o({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Yo(e,t)},createSubscribe:ss,ErrorFactory:ns,deepExtend:Yo}),e}(),xs=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){Os.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Ls=self.firebase.SDK_VERSION;Ls&&Ls.indexOf("LITE")>=0&&Os.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Ps=Ms.initializeApp;Ms.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ts()&&Os.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Ps.apply(void 0,t)};var Rs,Fs,Vs=Ms;function qs(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(Rs=Vs).INTERNAL.registerComponent(new ls("platform-logger",(function(t){return new xs(t)}),"PRIVATE")),Rs.registerVersion("@firebase/app","0.6.22",Fs),Rs.registerVersion("fire-js","");var Us=qs(jo(Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Vs,firebase:Vs})));
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Us.default.registerVersion("firebase","8.6.3","app");var js=Us.default,Bs=function(t,e){return(Bs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function zs(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var $s,Ks="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Gs=Gs||{},Ws=Ks||self;function Hs(){}function Qs(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Zs(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Ys="closure_uid_"+(1e9*Math.random()>>>0),Js=0;function Xs(t,e,n){return t.call.apply(t.bind,arguments)}function ta(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function ea(t,e,n){return(ea=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Xs:ta).apply(null,arguments)}function na(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function ra(){return Date.now()}function ia(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function oa(){this.j=this.j,this.i=this.i}oa.prototype.j=!1,oa.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Ys)&&t[Ys]||(t[Ys]=++Js))},oa.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var sa=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},aa=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function ua(t){return Array.prototype.concat.apply([],arguments)}function ca(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function la(t){return/^[\s\xa0]*$/.test(t)}var ha,fa=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function da(t,e){return-1!=t.indexOf(e)}function pa(t,e){return t<e?-1:t>e?1:0}t:{var ma=Ws.navigator;if(ma){var ya=ma.userAgent;if(ya){ha=ya;break t}}ha=""}function ga(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function va(t){var e={};for(var n in t)e[n]=t[n];return e}var ba="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function wa(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<ba.length;o++)n=ba[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ta(t){return Ta[" "](t),t}Ta[" "]=Hs;var Ea,Ia,Sa=da(ha,"Opera"),_a=da(ha,"Trident")||da(ha,"MSIE"),ka=da(ha,"Edge"),Na=ka||_a,Da=da(ha,"Gecko")&&!(da(ha.toLowerCase(),"webkit")&&!da(ha,"Edge"))&&!(da(ha,"Trident")||da(ha,"MSIE"))&&!da(ha,"Edge"),Oa=da(ha.toLowerCase(),"webkit")&&!da(ha,"Edge");function Aa(){var t=Ws.document;return t?t.documentMode:void 0}t:{var Ca="",Ma=(Ia=ha,Da?/rv:([^\);]+)(\)|;)/.exec(Ia):ka?/Edge\/([\d\.]+)/.exec(Ia):_a?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ia):Oa?/WebKit\/(\S+)/.exec(Ia):Sa?/(?:Version)[ \/]?(\S+)/.exec(Ia):void 0);if(Ma&&(Ca=Ma?Ma[1]:""),_a){var xa=Aa();if(null!=xa&&xa>parseFloat(Ca)){Ea=String(xa);break t}}Ea=Ca}var La,Pa={};function Ra(t){return function(t,e){var n=Pa;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=fa(String(Ea)).split("."),r=fa(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=pa(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||pa(0==s[2].length,0==a[2].length)||pa(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}if(Ws.document&&_a){var Fa=Aa();La=Fa||(parseInt(Ea,10)||void 0)}else La=void 0;var Va=La,qa=!_a||9<=Number(Va),Ua=_a&&!Ra("9"),ja=function(){if(!Ws.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Ws.addEventListener("test",Hs,e),Ws.removeEventListener("test",Hs,e)}catch(n){}return t}();function Ba(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function za(t,e){if(Ba.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Da){t:{try{Ta(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:$a[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Ba.prototype.b=function(){this.defaultPrevented=!0},ia(za,Ba);var $a={2:"touch",3:"pen",4:"mouse"};za.prototype.b=function(){za.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ua)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var Ka="closure_listenable_"+(1e6*Math.random()|0),Ga=0;function Wa(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Ga,this.Y=this.Z=!1}function Ha(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Qa(t){this.src=t,this.a={},this.b=0}function Za(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=sa(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Ha(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Ya(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Qa.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ya(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Wa(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ja="closure_lm_"+(1e6*Math.random()|0),Xa={};function tu(t,e,n,r,i){if(r&&r.once)return nu(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)tu(t,e[o],n,r,i);return null}return n=lu(n),t&&t[Ka]?t.va(e,n,Zs(r)?!!r.capture:!!r,i):eu(t,e,n,!1,r,i)}function eu(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=Zs(i)?!!i.capture:!!i;if(s&&!qa)return null;var a=uu(t);if(a||(t[Ja]=a=new Qa(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=au,e=qa?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ja||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ou(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function nu(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)nu(t,e[o],n,r,i);return null}return n=lu(n),t&&t[Ka]?t.wa(e,n,Zs(r)?!!r.capture:!!r,i):eu(t,e,n,!0,r,i)}function ru(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)ru(t,e[o],n,r,i);else r=Zs(r)?!!r.capture:!!r,n=lu(n),t&&t[Ka]?(t=t.c,(e=String(e).toString())in t.a&&(-1<(n=Ya(o=t.a[e],n,r,i))&&(Ha(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=uu(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Ya(e,n,r,i)),(n=-1<t?e[t]:null)&&iu(n))}function iu(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[Ka])Za(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ou(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=uu(e))?(Za(n,t),0==n.b&&(n.src=null,e[Ja]=null)):Ha(t)}}}function ou(t){return t in Xa?Xa[t]:Xa[t]="on"+t}function su(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&iu(t),n.call(r,e)}function au(t,e){if(t.Y)return!0;if(!qa){if(!e)t:{e=["window","event"];for(var n=Ws,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return su(t,e=new za(e,this))}return su(t,new za(e,this))}function uu(t){return(t=t[Ja])instanceof Qa?t:null}var cu="__closure_events_fn_"+(1e9*Math.random()>>>0);function lu(t){return"function"==typeof t?t:(t[cu]||(t[cu]=function(e){return t.handleEvent(e)}),t[cu])}function hu(){oa.call(this),this.c=new Qa(this),this.J=this,this.C=null}function fu(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Ba(e,t);else if(e instanceof Ba)e.target=e.target||t;else{var i=e;wa(e=new Ba(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=du(s,r,!0,e)&&i}if(i=du(s=e.a=t,r,!0,e)&&i,i=du(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=du(s=e.a=n[o],r,!1,e)&&i}function du(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.ca||s.src;s.Z&&Za(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}ia(hu,oa),hu.prototype[Ka]=!0,($s=hu.prototype).addEventListener=function(t,e,n,r){tu(this,t,e,n,r)},$s.removeEventListener=function(t,e,n,r){ru(this,t,e,n,r)},$s.G=function(){if(hu.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Ha(n[r]);delete e.a[t],e.b--}}this.C=null},$s.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},$s.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var pu=Ws.JSON.stringify;function mu(){this.b=this.a=null}var yu,gu=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new bu}),(function(t){t.reset()}));function vu(){var t=Iu,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function bu(){this.next=this.b=this.a=null}function wu(t){Ws.setTimeout((function(){throw t}),0)}function Tu(t,e){yu||function(){var t=Ws.Promise.resolve(void 0);yu=function(){t.then(Su)}}(),Eu||(yu(),Eu=!0),Iu.add(t,e)}mu.prototype.add=function(t,e){var n=gu.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},bu.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},bu.prototype.reset=function(){this.next=this.b=this.a=null};var Eu=!1,Iu=new mu;function Su(){for(var t;t=vu();){try{t.a.call(t.b)}catch(n){wu(n)}var e=gu;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Eu=!1}function _u(t,e){hu.call(this),this.b=t||1,this.a=e||Ws,this.f=ea(this.Za,this),this.g=ra()}function ku(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Nu(t,e,n){if("function"==typeof t)n&&(t=ea(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ea(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ws.setTimeout(t,e||0)}function Du(t){t.a=Nu((function(){t.a=null,t.c&&(t.c=!1,Du(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}ia(_u,hu),($s=_u.prototype).aa=!1,$s.M=null,$s.Za=function(){if(this.aa){var t=ra()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),fu(this,"tick"),this.aa&&(ku(this),this.start()))}},$s.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=ra())},$s.G=function(){_u.X.G.call(this),ku(this),delete this.a};var Ou=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}Bs(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Du(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(Ws.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(oa);function Au(t){oa.call(this),this.b=t,this.a={}}ia(Au,oa);var Cu=[];function Mu(t,e,n,r){Array.isArray(n)||(n&&(Cu[0]=n.toString()),n=Cu);for(var i=0;i<n.length;i++){var o=tu(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function xu(t){ga(t.a,(function(t,e){this.a.hasOwnProperty(e)&&iu(t)}),t),t.a={}}function Lu(){this.a=!0}function Pu(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return pu(n)}catch(a){return e}}(t,n)+(r?" "+r:"")}))}Au.prototype.G=function(){Au.X.G.call(this),xu(this)},Au.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Lu.prototype.info=function(){};var Ru={},Fu=null;function Vu(){return Fu=Fu||new hu}function qu(t){Ba.call(this,Ru.Fa,t)}function Uu(t){var e=Vu();fu(e,new qu(e,t))}function ju(t,e){Ba.call(this,Ru.STAT_EVENT,t),this.stat=e}function Bu(t){var e=Vu();fu(e,new ju(e,t))}function zu(t){Ba.call(this,Ru.Ga,t)}function $u(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Ws.setTimeout((function(){t()}),e)}Ru.Fa="serverreachability",ia(qu,Ba),Ru.STAT_EVENT="statevent",ia(ju,Ba),Ru.Ga="timingevent",ia(zu,Ba);var Ku={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Gu={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Wu(){}function Hu(t){var e;return(e=t.a)||(e=t.a={}),e}function Qu(){}Wu.prototype.a=null;var Zu,Yu={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ju(){Ba.call(this,"d")}function Xu(){Ba.call(this,"c")}function tc(){}function ec(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Au(this),this.P=nc,t=Na?125:void 0,this.R=new _u(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}ia(Ju,Ba),ia(Xu,Ba),ia(tc,Wu),Zu=new tc;var nc=45e3,rc={},ic={};function oc(t,e,n){t.H=1,t.i=Nc(Tc(e)),t.j=n,t.I=!0,sc(t,null)}function sc(t,e){t.u=ra(),cc(t),t.l=Tc(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Uc(n.b,"t",r),t.D=0,t.a=Ll(t.g,t.g.C?e:null),0<t.O&&(t.F=new Ou(ea(t.Ca,t,t.a),t.O)),Mu(t.J,t.a,"readystatechange",t.Xa),e=t.B?va(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Uu(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");s=2<=h.length&&"type"==h[1]?s+(l+"=")+c+"&":s+(l+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function ac(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=uc(t,n);if(i==ic){4==e&&(t.h=4,Bu(14),r=!1),Pu(t.c,t.f,null,"[Incomplete Response]");break}if(i==rc){t.h=4,Bu(15),Pu(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Pu(t.c,t.f,i,null),pc(t,i)}4==e&&0==n.length&&(t.h=1,Bu(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),kl(e),e.F=!0,Bu(11))):(Pu(t.c,t.f,n,"[Invalid Chunked Response]"),dc(t),fc(t))}function uc(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?ic:(n=Number(e.substring(n,r)),isNaN(n)?rc:(r+=1)+n>e.length?ic:(e=e.substr(r,n),t.D=r+n,e))}function cc(t){t.T=ra()+t.P,lc(t,t.P)}function lc(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=$u(ea(t.Va,t),e)}function hc(t){t.o&&(Ws.clearTimeout(t.o),t.o=null)}function fc(t){0==t.g.v||t.A||Ol(t.g,t)}function dc(t){hc(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ku(t.R),xu(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function pc(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||Wc(n.b,t)))if(n.I=t.N,!t.C&&Wc(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(y){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Dl(n),gl(n)}_l(n),Bu(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=$u(ea(n.Sa,n),6e3));if(1>=Gc(n.b)&&n.ea){try{n.ea()}catch(y){}n.ea=void 0}}else Cl(n,11)}else if((t.C||n.a==t)&&Dl(n),!la(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var l=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=u.b;!h.a&&(da(l,"spdy")||da(l,"quic")||da(l,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(Hc(h,h.b),h.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,kc(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=ra()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).la=xl(u,u.C?u.ga:null,u.fa),d.C){Qc(u.b,d);var p=d,m=u.D;m&&p.setTimeout(m),p.o&&(hc(p),cc(p)),u.a=d}else Sl(u);0<n.g.length&&wl(n)}else"stop"!=i[0]&&"close"!=i[0]||Cl(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Cl(n,7):yl(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Uu(4)}catch(y){}}function mc(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Qs(t)||"string"==typeof t)aa(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(Qs(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(Qs(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function yc(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof yc)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function gc(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];vc(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)vc(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function vc(t,e){return Object.prototype.hasOwnProperty.call(t,e)}($s=ec.prototype).setTimeout=function(t){this.P=t},$s.Xa=function(t){t=t.target;var e=this.F;e&&3==fl(t)?e.f():this.Ca(t)},$s.Ca=function(t){try{if(t==this.a)t:{var e=fl(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!Na&&!this.a.$())){this.A||4!=e||7==n||Uu(8==n||0>=r?3:2),hc(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!la(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Bu(12),dc(this),fc(this);break t}Pu(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,pc(this,u)}this.I?(ac(this,e,o),Na&&this.b&&3==e&&(Mu(this.J,this.R,"tick",this.Wa),this.R.start())):(Pu(this.c,this.f,o,null),pc(this,o)),4==e&&dc(this),this.b&&!this.A&&(4==e?Ol(this.g,this):(this.b=!1,cc(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Bu(12)):(this.h=0,Bu(13)),dc(this),fc(this)}}}catch(c){}},$s.Wa=function(){if(this.a){var t=fl(this.a),e=this.a.$();this.D<e.length&&(hc(this),ac(this,t,e),this.b&&4!=t&&cc(this))}},$s.cancel=function(){this.A=!0,dc(this)},$s.Va=function(){this.o=null;var t=ra();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(Uu(3),Bu(17)),dc(this),this.h=2,fc(this)):lc(this,this.T-t)},($s=yc.prototype).K=function(){gc(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},$s.L=function(){return gc(this),this.a.concat()},$s.get=function(t,e){return vc(this.b,t)?this.b[t]:e},$s.set=function(t,e){vc(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},$s.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var bc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function wc(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof wc){this.a=void 0!==e?e:t.a,Ec(this,t.f),this.j=t.j,Ic(this,t.c),Sc(this,t.h),this.g=t.g,e=t.b;var n=new Rc;n.c=e.c,e.a&&(n.a=new yc(e.a),n.b=e.b),_c(this,n),this.i=t.i}else t&&(n=String(t).match(bc))?(this.a=!!e,Ec(this,n[1]||"",!0),this.j=Dc(n[2]||""),Ic(this,n[3]||"",!0),Sc(this,n[4]),this.g=Dc(n[5]||"",!0),_c(this,n[6]||"",!0),this.i=Dc(n[7]||"")):(this.a=!!e,this.b=new Rc(null,this.a))}function Tc(t){return new wc(t)}function Ec(t,e,n){t.f=n?Dc(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ic(t,e,n){t.c=n?Dc(e,!0):e}function Sc(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function _c(t,e,n){e instanceof Rc?(t.b=e,function(t,e){e&&!t.f&&(Fc(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Vc(this,e),Uc(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Oc(e,Lc)),t.b=new Rc(e,t.a))}function kc(t,e,n){t.b.set(e,n)}function Nc(t){return kc(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^ra()).toString(36)),t}function Dc(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Oc(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ac),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ac(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}wc.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Oc(e,Cc,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Oc(e,Cc,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Oc(n,"/"==n.charAt(0)?xc:Mc,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Oc(n,Pc)),t.join("")};var Cc=/[#\/\?@]/g,Mc=/[#\?:]/g,xc=/[#\?]/g,Lc=/[#\?@]/g,Pc=/#/g;function Rc(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Fc(t){t.a||(t.a=new yc,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Vc(t,e){Fc(t),e=jc(t,e),vc(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,vc((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&gc(t)))}function qc(t,e){return Fc(t),e=jc(t,e),vc(t.a.b,e)}function Uc(t,e,n){Vc(t,e),0<n.length&&(t.c=null,t.a.set(jc(t,e),ca(n)),t.b+=n.length)}function jc(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}($s=Rc.prototype).add=function(t,e){Fc(this),this.c=null,t=jc(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},$s.forEach=function(t,e){Fc(this),this.a.forEach((function(n,r){aa(n,(function(n){t.call(e,n,r,this)}),this)}),this)},$s.L=function(){Fc(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},$s.K=function(t){Fc(this);var e=[];if("string"==typeof t)qc(this,t)&&(e=ua(e,this.a.get(jc(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=ua(e,t[n])}return e},$s.set=function(t,e){return Fc(this),this.c=null,qc(this,t=jc(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},$s.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},$s.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Bc=function(t,e){this.b=t,this.a=e};function zc(t){this.g=t||$c,Ws.PerformanceNavigationTiming?t=0<(t=Ws.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Ws.ia&&Ws.ia.ya&&Ws.ia.ya()&&Ws.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var $c=10;function Kc(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Gc(t){return t.b?1:t.a?t.a.size:0}function Wc(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Hc(t,e){t.a?t.a.add(e):t.b=e}function Qc(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Zc(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=zs(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(a){e={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return ca(t.c)}function Yc(){}function Jc(){this.a=new Yc}function Xc(t,e,n){var r=n||"";try{mc(t,(function(t,n){var i=t;Zs(t)&&(i=pu(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(Ww){throw e.push(r+"type="+encodeURIComponent("_badmap")),Ww}}function tl(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}zc.prototype.cancel=function(){var t,e;if(this.c=Zc(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=zs(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Yc.prototype.stringify=function(t){return Ws.JSON.stringify(t,void 0)},Yc.prototype.parse=function(t){return Ws.JSON.parse(t,void 0)};var el=Ws.JSON.parse;function nl(t){hu.call(this),this.headers=new yc,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=rl,this.D=this.F=!1}ia(nl,hu);var rl="",il=/^https?$/i,ol=["POST","PUT"];function sl(t){return"content-type"==t.toLowerCase()}function al(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,ul(t),ll(t)}function ul(t){t.u||(t.u=!0,fu(t,"complete"),fu(t,"error"))}function cl(t){if(t.b&&void 0!==Gs&&(!t.s[1]||4!=fl(t)||2!=t.W()))if(t.l&&4==fl(t))Nu(t.za,0,t);else if(fu(t,"readystatechange"),4==fl(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(bc)[1]||null;if(!o&&Ws.self&&Ws.self.location){var s=Ws.self.location.protocol;o=s.substr(0,s.length-1)}i=!il.test(o?o.toLowerCase():"")}e=i}if(e)fu(t,"complete"),fu(t,"success");else{t.h=6;try{var a=2<fl(t)?t.a.statusText:""}catch(u){a=""}t.f=a+" ["+t.W()+"]",ul(t)}}finally{ll(t)}}}function ll(t,e){if(t.a){hl(t);var n=t.a,r=t.s[0]?Hs:null;t.a=null,t.s=null,e||fu(t,"ready");try{n.onreadystatechange=r}catch(Ww){}}}function hl(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(Ws.clearTimeout(t.m),t.m=null)}function fl(t){return t.a?t.a.readyState:0}function dl(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return ga(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):kc(t,e,n))}function pl(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function ml(t){this.pa=0,this.g=[],this.c=new Lu,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=pl("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=pl("baseRetryDelayMs",5e3,t),this.Ra=pl("retryDelaySeedMs",1e4,t),this.Ma=pl("forwardChannelMaxRetries",2,t),this.ma=pl("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new zc(t&&t.concurrentRequestLimit),this.ka=new Jc,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function yl(t){if(vl(t),3==t.v){var e=t.R++,n=Tc(t.B);kc(n,"SID",t.J),kc(n,"RID",e),kc(n,"TYPE","terminate"),El(t,n),(e=new ec(t,t.c,e,void 0)).H=2,e.i=Nc(Tc(n)),n=!1,Ws.navigator&&Ws.navigator.sendBeacon&&(n=Ws.navigator.sendBeacon(e.i.toString(),"")),!n&&Ws.Image&&((new Image).src=e.i,n=!0),n||(e.a=Ll(e.g,null),e.a.ba(e.i)),e.u=ra(),cc(e)}Ml(t)}function gl(t){t.a&&(kl(t),t.a.cancel(),t.a=null)}function vl(t){gl(t),t.j&&(Ws.clearTimeout(t.j),t.j=null),Dl(t),t.b.cancel(),t.h&&("number"==typeof t.h&&Ws.clearTimeout(t.h),t.h=null)}function bl(t,e){t.g.push(new Bc(t.Oa++,e)),3==t.v&&wl(t)}function wl(t){Kc(t.b)||t.h||(t.h=!0,Tu(t.Ba,t),t.u=0)}function Tl(t,e){var n;n=e?e.f:t.R++;var r=Tc(t.B);kc(r,"SID",t.J),kc(r,"RID",n),kc(r,"AID",t.P),El(t,r),t.i&&t.l&&dl(r,t.i,t.l),n=new ec(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Il(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Hc(t.b,n),oc(n,r,e)}function El(t,e){t.f&&mc({},(function(t,n){kc(e,n,t)}))}function Il(t,e,n){n=Math.min(t.g.length,n);var r=t.f?ea(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{Xc(l,s,"req"+c+"_")}catch(h){r&&r(l)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Sl(t){t.a||t.j||(t.T=1,Tu(t.Aa,t),t.o=0)}function _l(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=$u(ea(t.Aa,t),Al(t,t.o)),t.o++,!0)}function kl(t){null!=t.s&&(Ws.clearTimeout(t.s),t.s=null)}function Nl(t){t.a=new ec(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Tc(t.la);kc(e,"RID","rpc"),kc(e,"SID",t.J),kc(e,"CI",t.H?"0":"1"),kc(e,"AID",t.P),El(t,e),kc(e,"TYPE","xmlhttp"),t.i&&t.l&&dl(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Nc(Tc(e)),n.j=null,n.I=!0,sc(n,t)}function Dl(t){null!=t.m&&(Ws.clearTimeout(t.m),t.m=null)}function Ol(t,e){var n=null;if(t.a==e){Dl(t),kl(t),t.a=null;var r=2}else{if(!Wc(t.b,e))return;n=e.s,Qc(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=ra()-e.u;var i=t.u;fu(r=Vu(),new zu(r,n,e,i)),wl(t)}else Sl(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Gc(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=$u(ea(t.Ba,t,e),Al(t,t.u)),t.u++,0)))}(t,e)||2==r&&_l(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Cl(t,5);break;case 4:Cl(t,10);break;case 3:Cl(t,6);break;default:Cl(t,2)}}function Al(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Cl(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=ea(t.Ya,t);n||(n=new wc("//www.google.com/images/cleardot.gif"),Ws.location&&"http"==Ws.location.protocol||Ec(n,"https"),Nc(n)),function(t,e){var n=new Lu;if(Ws.Image){var r=new Image;r.onload=na(tl,n,r,"TestLoadImage: loaded",!0,e),r.onerror=na(tl,n,r,"TestLoadImage: error",!1,e),r.onabort=na(tl,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=na(tl,n,r,"TestLoadImage: timeout",!1,e),Ws.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Bu(2);t.v=0,t.f&&t.f.ra(e),Ml(t),vl(t)}function Ml(t){t.v=0,t.I=-1,t.f&&(0==Zc(t.b).length&&0==t.g.length||(t.b.c.length=0,ca(t.g),t.g.length=0),t.f.qa())}function xl(t,e,n){var r=function(t){return t instanceof wc?Tc(t):new wc(t,void 0)}(n);if(""!=r.c)e&&Ic(r,e+"."+r.c),Sc(r,r.h);else{var i=Ws.location;r=function(t,e,n,r){var i=new wc(null,void 0);return t&&Ec(i,t),e&&Ic(i,e),n&&Sc(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&ga(t.V,(function(t,e){kc(r,e,t)})),e=t.A,n=t.na,e&&n&&kc(r,e,n),kc(r,"VER",t.ha),El(t,r),r}function Ll(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new nl(t.Na)).F=t.C,e}function Pl(){}function Rl(){if(_a&&!(10<=Number(Va)))throw Error("Environmental error: no available transport.")}function Fl(t,e){hu.call(this),this.a=new ml(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!la(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!la(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new Ul(this)}function Vl(t){Ju.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function ql(){Xu.call(this),this.status=1}function Ul(t){this.a=t}($s=nl.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Hu(this.H):Hu(Zu),this.a.onreadystatechange=ea(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void al(this,o)}t=n||"";var i=new yc(this.headers);r&&mc(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=sl,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=Ws.FormData&&t instanceof Ws.FormData,!(0<=sa(ol,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{hl(this),0<this.o&&((this.D=function(t){return _a&&Ra(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=ea(this.xa,this)):this.m=Nu(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){al(this,o)}},$s.xa=function(){void 0!==Gs&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,fu(this,"timeout"),this.abort(8))},$s.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,fu(this,"complete"),fu(this,"abort"),ll(this))},$s.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),ll(this,!0)),nl.X.G.call(this)},$s.za=function(){this.j||(this.A||this.l||this.g?cl(this):this.Ua())},$s.Ua=function(){cl(this)},$s.W=function(){try{return 2<fl(this)?this.a.status:-1}catch(Ia){return-1}},$s.$=function(){try{return this.a?this.a.responseText:""}catch(Ia){return""}},$s.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),el(e)}},$s.ua=function(){return this.h},$s.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},($s=ml.prototype).ha=8,$s.v=1,$s.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ec(this,this.c,t,void 0),r=this.l;if(this.O&&(r?wa(r=va(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Il(this,n,e),kc(i=Tc(this.B),"RID",t),kc(i,"CVER",22),this.A&&kc(i,"X-HTTP-Session-Id",this.A),El(this,i),this.i&&r&&dl(i,this.i,r),Hc(this.b,n),this.Ia&&kc(i,"TYPE","init"),this.da?(kc(i,"$req",e),kc(i,"SID","null"),n.U=!0,oc(n,i,null)):oc(n,i,e),this.v=2}}else 3==this.v&&(t?Tl(this,t):0==this.g.length||Kc(this.b)||Tl(this))},$s.Aa=function(){if(this.j=null,Nl(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=$u(ea(this.Ta,this),t)}},$s.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Bu(10),gl(this),Nl(this))},$s.Sa=function(){null!=this.m&&(this.m=null,gl(this),_l(this),Bu(19))},$s.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Bu(2)):(this.c.info("Failed to ping google.com"),Bu(1))},($s=Pl.prototype).ta=function(){},$s.sa=function(){},$s.ra=function(){},$s.qa=function(){},$s.Ja=function(){},Rl.prototype.a=function(t,e){return new Fl(t,e)},ia(Fl,hu),Fl.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Bu(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=xl(t,null,t.fa),wl(t)},Fl.prototype.close=function(){yl(this.a)},Fl.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,bl(this.a,e)}else this.l?((e={}).__data__=pu(t),bl(this.a,e)):bl(this.a,t)},Fl.prototype.G=function(){this.a.f=null,delete this.f,yl(this.a),delete this.a,Fl.X.G.call(this)},ia(Vl,Ju),ia(ql,Xu),ia(Ul,Pl),Ul.prototype.ta=function(){fu(this.a,"a")},Ul.prototype.sa=function(t){fu(this.a,new Vl(t))},Ul.prototype.ra=function(t){fu(this.a,new ql(t))},Ul.prototype.qa=function(){fu(this.a,"b")},Rl.prototype.createWebChannel=Rl.prototype.a,Fl.prototype.send=Fl.prototype.h,Fl.prototype.open=Fl.prototype.g,Fl.prototype.close=Fl.prototype.close,Ku.NO_ERROR=0,Ku.TIMEOUT=8,Ku.HTTP_ERROR=6,Gu.COMPLETE="complete",Qu.EventType=Yu,Yu.OPEN="a",Yu.CLOSE="b",Yu.ERROR="c",Yu.MESSAGE="d",hu.prototype.listen=hu.prototype.va,nl.prototype.listenOnce=nl.prototype.wa,nl.prototype.getLastError=nl.prototype.Qa,nl.prototype.getLastErrorCode=nl.prototype.ua,nl.prototype.getStatus=nl.prototype.W,nl.prototype.getResponseJson=nl.prototype.Pa,nl.prototype.getResponseText=nl.prototype.$,nl.prototype.send=nl.prototype.ba;var jl=Ku,Bl=Gu,zl=Ru,$l=10,Kl=11,Gl=Qu,Wl=nl,Hl=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Hl.o=-1;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ql={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Zl=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return zo(e,t),e}(Error),Yl=new Is("@firebase/firestore");function Jl(){return Yl.logLevel}function Xl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Yl.logLevel<=ms.DEBUG){var r=e.map(nh);Yl.debug.apply(Yl,Qo(["Firestore (8.6.3): "+t],r))}}function th(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Yl.logLevel<=ms.ERROR){var r=e.map(nh);Yl.error.apply(Yl,Qo(["Firestore (8.6.3): "+t],r))}}function eh(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Yl.logLevel<=ms.WARN){var r=e.map(nh);Yl.warn.apply(Yl,Qo(["Firestore (8.6.3): "+t],r))}}function nh(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(n){return t}var e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rh(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.6.3) INTERNAL ASSERTION FAILED: "+t;throw th(e),new Error(e)}function ih(t,e){t||rh()}function oh(t,e){return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ah=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=sh(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function uh(t,e){return t<e?-1:t>e?1:0}function ch(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function lh(t){return t+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hh=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Zl(Ql.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Zl(Ql.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Zl(Ql.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Zl(Ql.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?uh(this.nanoseconds,t.nanoseconds):uh(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),fh=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new hh(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dh(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ph(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function mh(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yh=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&rh(),void 0===n?n=t.length-e:n>t.length-e&&rh(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),gh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zo(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(yh),vh=/^[_a-zA-Z][_a-zA-Z0-9]*$/,bh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zo(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return vh.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Zl(Ql.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Zl(Ql.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Zl(Ql.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(yh),wh=function(){function t(t){this.fields=t,t.sort(bh.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return ch(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Th=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return uh(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Th.EMPTY_BYTE_STRING=new Th("");var Eh=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ih(t){if(ih(!!t),"string"==typeof t){var e=0,n=Eh.exec(t);if(ih(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Sh(t.seconds),nanos:Sh(t.nanos)}}function Sh(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function _h(t){return"string"==typeof t?Th.fromBase64String(t):Th.fromUint8Array(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Nh(t){var e=t.mapValue.fields.__previous_value__;return kh(e)?Nh(e):e}function Dh(t){var e=Ih(t.mapValue.fields.__local_write_time__.timestampValue);return new hh(e.seconds,e.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oh(t){return null==t}function Ah(t){return 0===t&&1/t==-1/0}function Ch(t){return"number"==typeof t&&Number.isInteger(t)&&!Ah(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mh=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(gh.fromString(e))},t.fromName=function(e){return new t(gh.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===gh.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return gh.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new gh(e.slice()))},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xh(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?kh(t)?4:10:rh()}function Lh(t,e){var n,r=xh(t);if(r!==xh(e))return!1;switch(r){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Dh(t).isEqual(Dh(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Ih(t.timestampValue),r=Ih(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return n=e,_h(t.bytesValue).isEqual(_h(n.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Sh(t.geoPointValue.latitude)===Sh(e.geoPointValue.latitude)&&Sh(t.geoPointValue.longitude)===Sh(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Sh(t.integerValue)===Sh(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Sh(t.doubleValue),r=Sh(e.doubleValue);return n===r?Ah(n)===Ah(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ch(t.arrayValue.values||[],e.arrayValue.values||[],Lh);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(dh(n)!==dh(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Lh(n[i],r[i])))return!1;return!0}(t,e);default:return rh()}}function Ph(t,e){return void 0!==(t.values||[]).find((function(t){return Lh(t,e)}))}function Rh(t,e){var n,r,i,o,s=xh(t),a=xh(e);if(s!==a)return uh(s,a);switch(s){case 0:return 0;case 1:return uh(t.booleanValue,e.booleanValue);case 2:return r=e,i=Sh((n=t).integerValue||n.doubleValue),o=Sh(r.integerValue||r.doubleValue),i<o?-1:i>o?1:i===o?0:isNaN(i)?isNaN(o)?0:-1:1;case 3:return Fh(t.timestampValue,e.timestampValue);case 4:return Fh(Dh(t),Dh(e));case 5:return uh(t.stringValue,e.stringValue);case 6:return function(t,e){var n=_h(t),r=_h(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=uh(n[i],r[i]);if(0!==o)return o}return uh(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=uh(Sh(t.latitude),Sh(e.latitude));return 0!==n?n:uh(Sh(t.longitude),Sh(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Rh(n[i],r[i]);if(o)return o}return uh(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=uh(r[s],o[s]);if(0!==a)return a;var u=Rh(n[r[s]],i[o[s]]);if(0!==u)return u}return uh(r.length,o.length)}(t.mapValue,e.mapValue);default:throw rh()}}function Fh(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return uh(t,e);var n=Ih(t),r=Ih(e),i=uh(n.seconds,r.seconds);return 0!==i?i:uh(n.nanos,r.nanos)}function Vh(t){return qh(t)}function qh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(e=t.timestampValue,"time("+(n=Ih(e)).seconds+","+n.nanos+")"):"stringValue"in t?t.stringValue:"bytesValue"in t?_h(t.bytesValue).toBase64():"referenceValue"in t?(i=t.referenceValue,Mh.fromName(i).toString()):"geoPointValue"in t?"geo("+(r=t.geoPointValue).latitude+","+r.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=qh(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+qh(t.fields[o])}return e+"}"}(t.mapValue):rh();var e,n,r,i}function Uh(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function jh(t){return!!t&&"integerValue"in t}function Bh(t){return!!t&&"arrayValue"in t}function zh(t){return!!t&&"nullValue"in t}function $h(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Kh(t){return!!t&&"mapValue"in t}function Gh(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},Ih(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return ph(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=Gh(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Gh(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wh=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Kh(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Gh(e)},t.prototype.setAll=function(t){var e=this,n=bh.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Gh(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Kh(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Lh(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Kh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){ph(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(Gh(this.value))},t}();function Hh(t){var e=[];return ph(t.fields,(function(t,n){var r=new bh([t]);if(Kh(n)){var i=Hh(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new wh(e)}var Qh=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,fh.min(),Wh.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Wh.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Wh.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Wh.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Wh.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Zh=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yh(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Zh(t,e,n,r,i,o,s)}function Jh(t){var e=oh(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return(e=t).field.canonicalString()+e.op.toString()+Vh(e.value);var e})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.canonicalString()+e.dir;var e})).join(","),Oh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ff(e.startAt)),e.endAt&&(n+="|ub:",n+=ff(e.endAt)),e.h=n}return e.h}function Xh(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!pf(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Lh(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!yf(t.startAt,e.startAt)&&yf(t.endAt,e.endAt)}function tf(t){return Mh.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var ef=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return zo(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new nf(t,n,r):"array-contains"===n?new af(t,r):"in"===n?new uf(t,r):"not-in"===n?new cf(t,r):"array-contains-any"===n?new lf(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new rf(t,n):new of(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Rh(e,this.value)):null!==e&&xh(this.value)===xh(e)&&this.m(Rh(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return rh()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),nf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Mh.fromName(r.referenceValue),i}return zo(e,t),e.prototype.matches=function(t){var e=Mh.comparator(t.key,this.key);return this.m(e)},e}(ef),rf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=sf("in",n),r}return zo(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ef),of=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=sf("not-in",n),r}return zo(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ef);function sf(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Mh.fromName(t.referenceValue)}))}var af=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return zo(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Bh(e)&&Ph(e.arrayValue,this.value)},e}(ef),uf=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return zo(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Ph(this.value.arrayValue,e)},e}(ef),cf=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return zo(e,t),e.prototype.matches=function(t){if(Ph(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Ph(this.value.arrayValue,e)},e}(ef),lf=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return zo(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Bh(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Ph(e.value.arrayValue,t)}))},e}(ef),hf=function(t,e){this.position=t,this.before=e};function ff(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Vh(t)})).join(",")}var df=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function pf(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function mf(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Mh.comparator(Mh.fromName(s.referenceValue),n.key):Rh(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function yf(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Lh(t.position[n],e.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gf=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function vf(t,e,n,r,i,o,s,a){return new gf(t,e,n,r,i,o,s,a)}function bf(t){return new gf(t)}function wf(t){return!Oh(t.limit)&&"F"===t.limitType}function Tf(t){return!Oh(t.limit)&&"L"===t.limitType}function Ef(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function If(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Sf(t){return null!==t.collectionGroup}function _f(t){var e=oh(t);if(null===e.p){e.p=[];var n=If(e),r=Ef(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new df(n)),e.p.push(new df(bh.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new df(bh.keyField(),u))}}}return e.p}function kf(t){var e=oh(t);if(!e.T)if("F"===e.limitType)e.T=Yh(e.path,e.collectionGroup,_f(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=_f(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new df(o.field,s))}var a=e.endAt?new hf(e.endAt.position,!e.endAt.before):null,u=e.startAt?new hf(e.startAt.position,!e.startAt.before):null;e.T=Yh(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function Nf(t,e,n){return new gf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Df(t,e){return Xh(kf(t),kf(e))&&t.limitType===e.limitType}function Of(t){return Jh(kf(t))+"|lt:"+t.limitType}function Af(t){return"Query(target="+(e=kf(t),n=e.path.canonicalString(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=", filters: ["+e.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Vh(e.value);var e})).join(", ")+"]"),Oh(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=", orderBy: ["+e.orderBy.map((function(t){return(e=t).field.canonicalString()+" ("+e.dir+")";var e})).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ff(e.startAt)),e.endAt&&(n+=", endAt: "+ff(e.endAt)),"Target("+n+"); limitType=")+t.limitType+")";var e,n}function Cf(t,e){return e.isFoundDocument()&&(n=t,i=(r=e).key.path,null!==n.collectionGroup?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Mh.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i))&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!mf(t.startAt,_f(t),e)||t.endAt&&mf(t.endAt,_f(t),e))}(t,e);var n,r,i}function Mf(t){return function(e,n){for(var r=!1,i=0,o=_f(t);i<o.length;i++){var s=o[i],a=xf(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function xf(t,e,n){var r,i,o,s,a=t.field.isKeyField()?Mh.comparator(e.key,n.key):(r=t.field,i=n,o=e.data.field(r),s=i.data.field(r),null!==o&&null!==s?Rh(o,s):rh());switch(t.dir){case"asc":return a;case"desc":return-1*a;default:return rh()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lf(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ah(e)?"-0":e}}function Pf(t){return{integerValue:""+t}}function Rf(t,e){return Ch(e)?Pf(e):Lf(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ff=function(){this._=void 0};function Vf(t,e,n){return t instanceof jf?(i=e,o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(o.fields.__previous_value__=i),{mapValue:o}):t instanceof Bf?zf(t,e):t instanceof $f?Kf(t,e):function(t,e){var n=Uf(t,e),r=Wf(n)+Wf(t.A);return jh(n)&&jh(t.A)?Pf(r):Lf(t.R,r)}(t,e);var r,i,o}function qf(t,e,n){return t instanceof Bf?zf(t,e):t instanceof $f?Kf(t,e):n}function Uf(t,e){return t instanceof Gf?jh(r=e)||(n=r)&&"doubleValue"in n?e:{integerValue:0}:null;var n,r}var jf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zo(e,t),e}(Ff),Bf=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return zo(e,t),e}(Ff);function zf(t,e){for(var n=Hf(e),r=function(t){n.some((function(e){return Lh(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var $f=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return zo(e,t),e}(Ff);function Kf(t,e){for(var n=Hf(e),r=function(t){n=n.filter((function(e){return!Lh(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Gf=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return zo(e,t),e}(Ff);function Wf(t){return Sh(t.integerValue||t.doubleValue)}function Hf(t){return Bh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qf=function(t,e){this.field=t,this.transform=e},Zf=function(t,e){this.version=t,this.transformResults=e},Yf=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Jf(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Xf=function(){};function td(t,e,n){var r,i,o,s,a;t instanceof od?(i=e,o=n,s=(r=t).value.clone(),a=ud(r.fieldTransforms,i,o.transformResults),s.setAll(a),i.convertToFoundDocument(o.version,s).setHasCommittedMutations()):t instanceof sd?function(t,e,n){if(Jf(t.precondition,e)){var r=ud(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(ad(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function ed(t,e,n){var r;t instanceof od?function(t,e,n){if(Jf(t.precondition,e)){var r=t.value.clone(),i=cd(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(id(e),r).setHasLocalMutations()}}(t,e,n):t instanceof sd?function(t,e,n){if(Jf(t.precondition,e)){var r=cd(t.fieldTransforms,n,e),i=e.data;i.setAll(ad(t)),i.setAll(r),e.convertToFoundDocument(id(e),i).setHasLocalMutations()}}(t,e,n):(r=e,Jf(t.precondition,r)&&r.convertToNoDocument(fh.min()))}function nd(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Uf(o.transform,s||null);null!=a&&(null==n&&(n=Wh.empty()),n.set(o.field,a))}return n||null}function rd(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&ch(n,r,(function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof Bf&&o instanceof Bf||i instanceof $f&&o instanceof $f?ch(i.elements,o.elements,Lh):i instanceof Gf&&o instanceof Gf?Lh(i.A,o.A):i instanceof jf&&o instanceof jf);var n,r,i,o}))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var n,r}function id(t){return t.isFoundDocument()?t.version:fh.min()}var od=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return zo(e,t),e}(Xf),sd=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return zo(e,t),e}(Xf);function ad(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function ud(t,e,n){var r=new Map;ih(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,qf(s,a,n[i]))}return r}function cd(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Vf(a,u,e))}return r}var ld,hd,fd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return zo(e,t),e}(Xf),dd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return zo(e,t),e}(Xf),pd=function(t){this.count=t};function md(t){switch(t){case Ql.OK:return rh();case Ql.CANCELLED:case Ql.UNKNOWN:case Ql.DEADLINE_EXCEEDED:case Ql.RESOURCE_EXHAUSTED:case Ql.INTERNAL:case Ql.UNAVAILABLE:case Ql.UNAUTHENTICATED:return!1;case Ql.INVALID_ARGUMENT:case Ql.NOT_FOUND:case Ql.ALREADY_EXISTS:case Ql.PERMISSION_DENIED:case Ql.FAILED_PRECONDITION:case Ql.ABORTED:case Ql.OUT_OF_RANGE:case Ql.UNIMPLEMENTED:case Ql.DATA_LOSS:return!0;default:return rh()}}function yd(t){if(void 0===t)return th("GRPC error has no .code"),Ql.UNKNOWN;switch(t){case ld.OK:return Ql.OK;case ld.CANCELLED:return Ql.CANCELLED;case ld.UNKNOWN:return Ql.UNKNOWN;case ld.DEADLINE_EXCEEDED:return Ql.DEADLINE_EXCEEDED;case ld.RESOURCE_EXHAUSTED:return Ql.RESOURCE_EXHAUSTED;case ld.INTERNAL:return Ql.INTERNAL;case ld.UNAVAILABLE:return Ql.UNAVAILABLE;case ld.UNAUTHENTICATED:return Ql.UNAUTHENTICATED;case ld.INVALID_ARGUMENT:return Ql.INVALID_ARGUMENT;case ld.NOT_FOUND:return Ql.NOT_FOUND;case ld.ALREADY_EXISTS:return Ql.ALREADY_EXISTS;case ld.PERMISSION_DENIED:return Ql.PERMISSION_DENIED;case ld.FAILED_PRECONDITION:return Ql.FAILED_PRECONDITION;case ld.ABORTED:return Ql.ABORTED;case ld.OUT_OF_RANGE:return Ql.OUT_OF_RANGE;case ld.UNIMPLEMENTED:return Ql.UNIMPLEMENTED;case ld.DATA_LOSS:return Ql.DATA_LOSS;default:return rh()}}(hd=ld||(ld={}))[hd.OK=0]="OK",hd[hd.CANCELLED=1]="CANCELLED",hd[hd.UNKNOWN=2]="UNKNOWN",hd[hd.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",hd[hd.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",hd[hd.NOT_FOUND=5]="NOT_FOUND",hd[hd.ALREADY_EXISTS=6]="ALREADY_EXISTS",hd[hd.PERMISSION_DENIED=7]="PERMISSION_DENIED",hd[hd.UNAUTHENTICATED=16]="UNAUTHENTICATED",hd[hd.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",hd[hd.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",hd[hd.ABORTED=10]="ABORTED",hd[hd.OUT_OF_RANGE=11]="OUT_OF_RANGE",hd[hd.UNIMPLEMENTED=12]="UNIMPLEMENTED",hd[hd.INTERNAL=13]="INTERNAL",hd[hd.UNAVAILABLE=14]="UNAVAILABLE",hd[hd.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var gd=function(){function t(t,e){this.comparator=t,this.root=e||bd.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,bd.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bd.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new vd(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new vd(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new vd(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new vd(this.root,t,this.comparator,!0)},t}(),vd=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),bd=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw rh();if(this.right.isRed())throw rh();var t=this.left.check();if(t!==this.right.check())throw rh();return t+(this.isRed()?0:1)},t}();bd.EMPTY=null,bd.RED=!0,bd.BLACK=!1,bd.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw rh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw rh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw rh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw rh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw rh()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new bd(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var wd=function(){function t(t){this.comparator=t,this.data=new gd(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Td(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Td(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Td=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Ed=new gd(Mh.comparator);function Id(){return Ed}var Sd=new gd(Mh.comparator);function _d(){return Sd}var kd=new gd(Mh.comparator);var Nd=new wd(Mh.comparator);function Dd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Nd,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Od=new wd(uh);function Ad(){return Od}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cd=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Md.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(fh.min(),r,Ad(),Id(),Dd())},t}(),Md=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Th.EMPTY_BYTE_STRING,n,Dd(),Dd(),Dd())},t}(),xd=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Ld=function(t,e){this.targetId=t,this.V=e},Pd=function(t,e,n,r){void 0===n&&(n=Th.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Rd=function(){function t(){this.S=0,this.D=qd(),this.C=Th.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Dd(),e=Dd(),n=Dd();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:rh()}})),new Md(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=qd()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),Fd=function(){function t(t){this.W=t,this.G=new Map,this.H=Id(),this.J=Vd(),this.Y=new wd(uh)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:rh()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(tf(i))if(0===n){var o=new Mh(i.path);this.tt(e,o,Qh.newNoDocument(o,fh.min()))}else ih(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&tf(o.target)){var s=new Mh(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Qh.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=Dd();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Cd(t,n,this.Y,this.H,r);return this.H=Id(),this.J=Vd(),this.Y=new wd(uh),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Rd,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new wd(uh),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Xl("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Rd),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Vd(){return new gd(Mh.comparator)}function qd(){return new gd(Mh.comparator)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ud={asc:"ASCENDING",desc:"DESCENDING"},jd={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Bd=function(t,e){this.databaseId=t,this.I=e};function zd(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function $d(t,e){return t.I?e.toBase64():e.toUint8Array()}function Kd(t,e){return zd(t,e.toTimestamp())}function Gd(t){return ih(!!t),fh.fromTimestamp((e=Ih(t),new hh(e.seconds,e.nanos)));var e}function Wd(t,e){return(n=t,new gh(["projects",n.projectId,"databases",n.database])).child("documents").child(e).canonicalString();var n}function Hd(t){var e=gh.fromString(t);return ih(gp(e)),e}function Qd(t,e){return Wd(t.databaseId,e.path)}function Zd(t,e){var n=Hd(e);if(n.get(1)!==t.databaseId.projectId)throw new Zl(Ql.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Zl(Ql.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Mh(tp(n))}function Yd(t,e){return Wd(t.databaseId,e)}function Jd(t){var e=Hd(t);return 4===e.length?gh.emptyPath():tp(e)}function Xd(t){return new gh(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function tp(t){return ih(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function ep(t,e,n){return{name:Qd(t,e),fields:n.value.mapValue.fields}}function np(t,e){var n,r,i;if(e instanceof od)n={update:ep(t,e.key,e.value)};else if(e instanceof fd)n={delete:Qd(t,e.key)};else if(e instanceof sd)n={update:ep(t,e.key,e.data),updateMask:yp(e.fieldMask)};else{if(!(e instanceof dd))return rh();n={verify:Qd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof jf)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Bf)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof $f)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Gf)return{fieldPath:e.field.canonicalString(),increment:n.A};throw rh()}(0,t)}))),e.precondition.isNone||(n.currentDocument=(r=t,void 0!==(i=e.precondition).updateTime?{updateTime:Kd(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:rh())),n}function rp(t,e){var n,r=e.currentDocument?void 0!==(n=e.currentDocument).updateTime?Yf.updateTime(Gd(n.updateTime)):void 0!==n.exists?Yf.exists(n.exists):Yf.none():Yf.none(),i=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)ih("REQUEST_TIME"===e.setToServerValue),n=new jf;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Bf(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new $f(i)}else"increment"in e?n=new Gf(t,e.increment):rh();var o=bh.fromServerFormat(e.fieldPath);return new Qf(o,n)}(t,e)})):[];if(e.update){e.update.name;var o=Zd(t,e.update.name),s=new Wh({mapValue:{fields:e.update.fields}});if(e.updateMask){var a=function(t){var e=t.fieldPaths||[];return new wh(e.map((function(t){return bh.fromServerFormat(t)})))}(e.updateMask);return new sd(o,s,a,r,i)}return new od(o,s,r,i)}if(e.delete){var u=Zd(t,e.delete);return new fd(u,r)}if(e.verify){var c=Zd(t,e.verify);return new dd(c,r)}return rh()}function ip(t,e){return{documents:[Yd(t,e.path)]}}function op(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Yd(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Yd(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if($h(t.value))return{unaryFilter:{field:fp(t.field),op:"IS_NAN"}};if(zh(t.value))return{unaryFilter:{field:fp(t.field),op:"IS_NULL"}}}else if("!="===t.op){if($h(t.value))return{unaryFilter:{field:fp(t.field),op:"IS_NOT_NAN"}};if(zh(t.value))return{unaryFilter:{field:fp(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fp(t.field),op:hp(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return{field:fp((e=t).field),direction:lp(e.dir)};var e}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a,u=(s=t,a=e.limit,s.I||Oh(a)?a:{value:a});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=up(e.startAt)),e.endAt&&(n.structuredQuery.endAt=up(e.endAt)),n}function sp(t){var e=Jd(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ih(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=ap(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return new df(dp((e=t).field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction));var e})));var u,c,l=null;n.limit&&(u=n.limit,l=Oh(c="object"==typeof u?u.value:u)?null:c);var h=null;n.startAt&&(h=cp(n.startAt));var f=null;return n.endAt&&(f=cp(n.endAt)),vf(e,i,a,s,l,"F",h,f)}function ap(t){return t?void 0!==t.unaryFilter?[mp(t)]:void 0!==t.fieldFilter?[pp(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return ap(t)})).reduce((function(t,e){return t.concat(e)})):rh():[]}function up(t){return{before:t.before,values:t.position}}function cp(t){var e=!!t.before,n=t.values||[];return new hf(n,e)}function lp(t){return Ud[t]}function hp(t){return jd[t]}function fp(t){return{fieldPath:t.canonicalString()}}function dp(t){return bh.fromServerFormat(t.fieldPath)}function pp(t){return ef.create(dp(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return rh()}}(t.fieldFilter.op),t.fieldFilter.value)}function mp(t){switch(t.unaryFilter.op){case"IS_NAN":var e=dp(t.unaryFilter.field);return ef.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=dp(t.unaryFilter.field);return ef.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=dp(t.unaryFilter.field);return ef.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=dp(t.unaryFilter.field);return ef.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return rh()}}function yp(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function gp(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vp(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=wp(e)),e=bp(t.get(n),e);return wp(e)}function bp(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function wp(t){return t+""}function Tp(t){var e=t.length;if(ih(e>=2),2===e)return ih(""===t.charAt(0)&&""===t.charAt(1)),gh.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&rh(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:rh()}o=s+2}return new gh(r)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ep=function(t,e){this.seconds=t,this.nanoseconds=e},Ip=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Ip.store="owner",Ip.key="owner";var Sp=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Sp.store="mutationQueues",Sp.keyPath="userId";var _p=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};_p.store="mutations",_p.keyPath="batchId",_p.userMutationsIndex="userMutationsIndex",_p.userMutationsKeyPath=["userId","batchId"];var kp=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,vp(e)]},t.key=function(t,e,n){return[t,vp(e),n]},t}();kp.store="documentMutations",kp.PLACEHOLDER=new kp;var Np=function(t,e){this.path=t,this.readTime=e},Dp=function(t,e){this.path=t,this.version=e},Op=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Op.store="remoteDocuments",Op.readTimeIndex="readTimeIndex",Op.readTimeIndexPath="readTime",Op.collectionReadTimeIndex="collectionReadTimeIndex",Op.collectionReadTimeIndexPath=["parentPath","readTime"];var Ap=function(t){this.byteSize=t};Ap.store="remoteDocumentGlobal",Ap.key="remoteDocumentGlobalKey";var Cp=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Cp.store="targets",Cp.keyPath="targetId",Cp.queryTargetsIndexName="queryTargetsIndex",Cp.queryTargetsKeyPath=["canonicalId","targetId"];var Mp=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Mp.store="targetDocuments",Mp.keyPath=["targetId","path"],Mp.documentTargetsIndex="documentTargetsIndex",Mp.documentTargetsKeyPath=["path","targetId"];var xp=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};xp.key="targetGlobalKey",xp.store="targetGlobal";var Lp=function(t,e){this.collectionId=t,this.parent=e};Lp.store="collectionParents",Lp.keyPath=["collectionId","parent"];var Pp=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Pp.store="clientMetadata",Pp.keyPath="clientId";var Rp=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Rp.store="bundles",Rp.keyPath="bundleId";var Fp=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Fp.store="namedQueries",Fp.keyPath="name";var Vp=Qo(Qo([],Qo(Qo([],Qo(Qo([],Qo(Qo([],[Sp.store,_p.store,kp.store,Op.store,Cp.store,Ip.store,xp.store,Mp.store]),[Pp.store])),[Ap.store])),[Lp.store])),[Rp.store,Fp.store]),qp="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Up=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),jp=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Bp=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&rh(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(r){return t.reject(r)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),zp=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new jp,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Gp(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Yp(e.target.error);n.ft.reject(new Gp(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(o){throw new Gp(n,o)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Xl("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Hp(e)},t}(),$p=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Xo())&&th("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Xl("SimpleDb","Removing database:",t),Qp(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Xo(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Ko(this,void 0,void 0,(function(){var e,n=this;return Go(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Xl("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Gp(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Zl(Ql.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Gp(t,n))},i.onupgradeneeded=function(t){Xl("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){Xl("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Ko(this,void 0,void 0,(function(){var i,o,s,a,u;return Go(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,l;return Go(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=h.sent(),e=zp.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),Bp.reject(t)})).toPromise(),u={},s.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(h.sent(),s),u)];case 4:return c=h.sent(),l="FirebaseError"!==c.name&&o<3,Xl("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),a.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Kp=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Qp(this.Pt.delete())},t}(),Gp=function(t){function e(e,n){var r=this;return(r=t.call(this,Ql.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return zo(e,t),e}(Zl);function Wp(t){return"IndexedDbTransactionError"===t.name}var Hp=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Xl("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Xl("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Qp(n)},t.prototype.add=function(t){return Xl("SimpleDb","ADD",this.store.name,t,t),Qp(this.store.add(t))},t.prototype.get=function(t){var e=this;return Qp(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Xl("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Xl("SimpleDb","DELETE",this.store.name,t),Qp(this.store.delete(t))},t.prototype.count=function(){return Xl("SimpleDb","COUNT",this.store.name),Qp(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){Xl("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Bp((function(n,r){e.onerror=function(t){var e=Yp(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new Bp((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Kp(i),s=e(i.primaryKey,i.value,o);if(s instanceof Bp){var a=s.catch((function(t){return o.done(),Bp.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return Bp.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Qp(t){return new Bp((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Yp(t.target.error);n(e)}}))}var Zp=!1;function Yp(t){var e=$p._t(Xo());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Zl("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Zp||(Zp=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jp=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return zo(e,t),e}(Up);function Xp(t,e){var n=oh(t);return $p.It(n.Mt,e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tm=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&td(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&ed(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&ed(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(fh.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Dd())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ch(this.mutations,t.mutations,(function(t,e){return rd(t,e)}))&&ch(this.baseMutations,t.baseMutations,(function(t,e){return rd(t,e)}))},t}(),em=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){ih(e.mutations.length===r.length);for(var i=kd,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),nm=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=fh.min()),void 0===o&&(o=fh.min()),void 0===s&&(s=Th.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),rm=function(t){this.Lt=t};function im(t,e){if(e.document)return function(t,e,n){var r=Zd(t,e.name),i=Gd(e.updateTime),o=new Wh({mapValue:{fields:e.fields}}),s=Qh.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Mh.fromSegments(e.noDocument.path),r=cm(e.noDocument.readTime),i=Qh.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Mh.fromSegments(e.unknownDocument.path);return r=cm(e.unknownDocument.version),Qh.newUnknownDocument(o,r)}return rh()}function om(t,e,n){var r,i,o=sm(n),s=e.key.path.popLast().toArray();if(e.isFoundDocument()){var a={name:Qd(r=t.Lt,(i=e).key),fields:i.data.value.mapValue.fields,updateTime:zd(r,i.version.toTimestamp())},u=e.hasCommittedMutations;return new Op(null,null,a,u,o,s)}if(e.isNoDocument()){var c=e.key.path.toArray(),l=um(e.version);return u=e.hasCommittedMutations,new Op(null,new Np(c,l),null,u,o,s)}if(e.isUnknownDocument()){var h=e.key.path.toArray(),f=um(e.version);return new Op(new Dp(h,f),null,null,!0,o,s)}return rh()}function sm(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function am(t){var e=new hh(t[0],t[1]);return fh.fromTimestamp(e)}function um(t){var e=t.toTimestamp();return new Ep(e.seconds,e.nanoseconds)}function cm(t){var e=new hh(t.seconds,t.nanoseconds);return fh.fromTimestamp(e)}function lm(t,e){for(var n=(e.baseMutations||[]).map((function(e){return rp(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return rp(t.Lt,e)})),a=hh.fromMillis(e.localWriteTimeMs);return new tm(e.batchId,a,n,s)}function hm(t){var e,n,r=cm(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?cm(t.lastLimboFreeSnapshotVersion):fh.min();return void 0!==t.query.documents?(ih(1===(n=t.query).documents.length),e=kf(bf(Jd(n.documents[0])))):e=kf(sp(t.query)),new nm(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Th.fromBase64String(t.resumeToken))}function fm(t,e){var n,r=um(e.snapshotVersion),i=um(e.lastLimboFreeSnapshotVersion);n=tf(e.target)?ip(t.Lt,e.target):op(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Cp(e.targetId,Jh(e.target),r,o,e.sequenceNumber,i,n)}function dm(t){var e=sp({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Nf(e,e.limit,"L"):e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pm=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return mm(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:cm(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return mm(t).put({bundleId:(n=e).id,createTime:um(Gd(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return ym(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:dm(e.bundledQuery),readTime:cm(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return ym(t).put({name:(n=e).name,readTime:um(Gd(n.readTime)),bundledQuery:n.bundledQuery});var n},t}();function mm(t){return Xp(t,Rp.store)}function ym(t){return Xp(t,Fp.store)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gm=function(){function t(){this.Bt=new vm}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Bp.resolve()},t.prototype.getCollectionParents=function(t,e){return Bp.resolve(this.Bt.getEntries(e))},t}(),vm=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new wd(gh.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new wd(gh.comparator)).toArray()},t}(),bm=function(){function t(){this.qt=new vm}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:vp(i)};return wm(t).put(o)}return Bp.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[lh(e),""],!1,!0);return wm(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Tp(o.parent))}return n}))},t}();function wm(t){return Xp(t,Lp.store)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Em=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(t,e,n){var r=t.store(_p.store),i=t.store(kp.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){ih(1===a)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=kp.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Bp.waitFor(o).next((function(){return c}))}function Sm(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw rh();e=t.noDocument}return JSON.stringify(e).length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Em.DEFAULT_COLLECTION_PERCENTILE=10,Em.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Em.DEFAULT=new Em(41943040,Em.DEFAULT_COLLECTION_PERCENTILE,Em.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Em.DISABLED=new Em(-1,0,0);var _m=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return ih(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Nm(t).$t({index:_p.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Dm(t),s=Nm(t);return s.add({}).next((function(a){ih("number"==typeof a);for(var u=new tm(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return np(t.Lt,e)})),i=n.mutations.map((function(e){return np(t.Lt,e)}));return new _p(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new wd((function(t,e){return uh(t.canonicalString(),e.canonicalString())})),f=0,d=r;f<d.length;f++){var p=d[f],m=kp.key(i.userId,p.key.path,a);h=h.add(p.key.path.popLast()),l.push(s.put(c)),l.push(o.put(m,kp.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Qt[a]=u.keys()})),Bp.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Nm(t).get(e).next((function(t){return t?(ih(t.userId===n.userId),lm(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?Bp.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Nm(t).$t({index:_p.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(ih(e.batchId>=r),o=lm(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Nm(t).$t({index:_p.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Nm(t).Nt(_p.userMutationsIndex,n).next((function(t){return t.map((function(t){return lm(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=kp.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Dm(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],l=Tp(u);if(a===n.userId&&e.path.isEqual(l))return Nm(t).get(c).next((function(t){if(!t)throw rh();ih(t.userId===n.userId),o.push(lm(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new wd(uh),i=[];return e.forEach((function(e){var o=kp.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Dm(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=Tp(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),Bp.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=kp.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new wd(uh);return Dm(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],l=Tp(u);s===n.userId&&r.isPrefixOf(l)?l.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Nm(t).get(e).next((function(t){if(null===t)throw rh();ih(t.userId===n.userId),r.push(lm(n.R,t))})))})),Bp.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return Im(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),Bp.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Bp.resolve();var r=IDBKeyRange.lowerBound(kp.prefixForUser(e.userId)),i=[];return Dm(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Tp(t[1]);i.push(o)}else r.done()})).next((function(){ih(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return km(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Om(t).get(this.userId).next((function(t){return t||new Sp(e.userId,-1,"")}))},t}();function km(t,e,n){var r=kp.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Dm(t).$t({range:o,kt:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function Nm(t){return Xp(t,_p.store)}function Dm(t){return Xp(t,kp.store)}function Om(t){return Xp(t,Sp.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Am=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Cm=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new Am(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return fh.fromTimestamp(new hh(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Mm(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return ih(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Mm(t).$t((function(s,a){var u=hm(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Bp.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Mm(t).$t((function(t,n){var r=hm(n);e(r)}))},t.prototype.Xt=function(t){return xm(t).get(xp.key).next((function(t){return ih(null!==t),t}))},t.prototype.Zt=function(t,e){return xm(t).put(xp.key,e)},t.prototype.te=function(t,e){return Mm(t).put(fm(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=Jh(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Mm(t).$t({range:r,index:Cp.queryTargetsIndexName},(function(t,n,r){var o=hm(n);Xh(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Lm(t);return e.forEach((function(e){var s=vp(e.path);i.push(o.put(new Mp(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),Bp.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Lm(t);return Bp.forEach(e,(function(e){var o=vp(e.path);return Bp.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Lm(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Lm(t),i=Dd();return r.$t({range:n,kt:!0},(function(t,e,n){var r=Tp(t[1]),o=new Mh(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=vp(e.path),r=IDBKeyRange.bound([n],[lh(n)],!1,!0),i=0;return Lm(t).$t({index:Mp.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Mm(t).get(e).next((function(t){return t?hm(t):null}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mm(t){return Xp(t,Cp.store)}function xm(t){return Xp(t,xp.store)}function Lm(t){return Xp(t,Mp.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(t){return Ko(this,void 0,void 0,(function(){return Go(this,(function(e){if(t.code!==Ql.FAILED_PRECONDITION||t.message!==qp)throw t;return Xl("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=uh(n,i);return 0===s?uh(r,o):s}var Fm=function(){function t(t){this.ne=t,this.buffer=new wd(Rm),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Rm(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Vm=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Xl("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return Ko(e,void 0,void 0,(function(){var e;return Go(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Wp(e=n.sent())?(Xl("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Pm(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),qm=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Bp.resolve(Hl.o);var r=new Fm(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Xl("LruGarbageCollector","Garbage collection skipped; disabled"),Bp.resolve(Tm)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Xl("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Tm):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(Xl("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),Jl()<=ms.DEBUG&&Xl("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-l)+"ms"),Bp.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),Um=function(){function t(t,e){this.db=t,this.garbageCollector=new qm(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return jm(t,n)},t.prototype.removeReference=function(t,e,n){return jm(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return jm(t,e)},t.prototype._e=function(t,e){return r=e,i=!1,Om(n=t).Ot((function(t){return km(n,t,r).next((function(t){return t&&(i=!0),Bp.resolve(!t)}))})).next((function(){return i}));var n,r,i},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),Lm(t).delete([0,vp(s.path)])}))}));i.push(u)}})).next((function(){return Bp.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return jm(t,e)},t.prototype.we=function(t,e){var n,r=Lm(t),i=Hl.o;return r.$t({index:Mp.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),a=r.sequenceNumber;0===o?(i!==Hl.o&&e(new Mh(Tp(n)),i),i=a,n=s):i=Hl.o})).next((function(){i!==Hl.o&&e(new Mh(Tp(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function jm(t,e){return Lm(t).put((n=e,r=t.currentSequenceNumber,new Mp(0,vp(n.path),r)));var n,r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bm=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ph(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return mh(this.inner)},t}(),zm=function(){function t(){this.changes=new Bm((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:fh.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Qh.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Bp.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),$m=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Wm(t).put(Hm(e),n)},t.prototype.removeEntry=function(t,e){var n=Wm(t),r=Hm(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return Wm(t).get(Hm(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return Wm(t).get(Hm(e)).next((function(t){return{document:n.ye(e,t),size:Sm(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=Id();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=Id(),i=new gd(Mh.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Sm(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Bp.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Wm(t).$t({range:r},(function(t,e,r){for(var s=Mh.fromSegments(t);o&&Mh.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Id(),o=e.path.length+1,s={};if(n.isEqual(fh.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=sm(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Op.collectionReadTimeIndex}return Wm(t).$t(s,(function(t,n,s){if(t.length===o){var a=im(r.R,n);e.path.isPrefixOf(a.key.path)?Cf(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new Km(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Gm(t).get(Ap.key).next((function(t){return ih(!!t),t}))},t.prototype.me=function(t,e){return Gm(t).put(Ap.key,e)},t.prototype.ye=function(t,e){if(e){var n=im(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(fh.min()))return n}return Qh.newInvalidDocument(t)},t}(),Km=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Bm((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return zo(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new wd((function(t,e){return uh(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=om(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Sm(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var l=om(e.Ie.R,Qh.newNoDocument(o,fh.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,l))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),Bp.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(zm);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gm(t){return Xp(t,Ap.store)}function Wm(t){return Xp(t,Op.store)}function Hm(t){return t.path.toArray()}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qm=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;ih(n<r&&n>=0&&r<=11);var o=new zp("createOrUpgrade",e);n<1&&r>=1&&(t.createObjectStore(Ip.store),function(t){t.createObjectStore(Sp.store,{keyPath:Sp.keyPath}),t.createObjectStore(_p.store,{keyPath:_p.keyPath,autoIncrement:!0}).createIndex(_p.userMutationsIndex,_p.userMutationsKeyPath,{unique:!0}),t.createObjectStore(kp.store)}(t),Zm(t),function(t){t.createObjectStore(Op.store)}(t));var s=Bp.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Mp.store),t.deleteObjectStore(Cp.store),t.deleteObjectStore(xp.store)}(t),Zm(t)),s=s.next((function(){return function(t){var e=t.store(xp.store),n=new xp(0,0,fh.min().toTimestamp(),0);return e.put(xp.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(_p.store).Nt().next((function(n){t.deleteObjectStore(_p.store),t.createObjectStore(_p.store,{keyPath:_p.keyPath,autoIncrement:!0}).createIndex(_p.userMutationsIndex,_p.userMutationsKeyPath,{unique:!0});var r=e.store(_p.store),i=n.map((function(t){return r.put(t)}));return Bp.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Pp.store,{keyPath:Pp.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Ap.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Op.store);e.createIndex(Op.readTimeIndex,Op.readTimeIndexPath,{unique:!1}),e.createIndex(Op.collectionReadTimeIndex,Op.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Rp.store,{keyPath:Rp.keyPath})}(t),function(t){t.createObjectStore(Fp.store,{keyPath:Fp.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(Op.store).$t((function(t,n){e+=Sm(n)})).next((function(){var n=new Ap(e);return t.store(Ap.store).put(Ap.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Sp.store),r=t.store(_p.store);return n.Nt().next((function(n){return Bp.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(_p.userMutationsIndex,i).next((function(r){return Bp.forEach(r,(function(r){ih(r.userId===n.userId);var i=lm(e.R,r);return Im(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Mp.store),n=t.store(Op.store);return t.store(xp.store).get(xp.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new gh(n),s=[0,vp(o)];r.push(e.get(s).next((function(n){return n?Bp.resolve():(r=o,e.put(new Mp(0,vp(r),t.highestListenSequenceNumber)));var r})))})).next((function(){return Bp.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Lp.store,{keyPath:Lp.keyPath});var n=e.store(Lp.store),r=new vm,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:vp(i)})}};return e.store(Op.store).$t({kt:!0},(function(t,e){var n=new gh(t);return i(n.popLast())})).next((function(){return e.store(kp.store).$t({kt:!0},(function(t,e){t[0];var n=t[1],r=(t[2],Tp(n));return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Cp.store);return n.$t((function(t,r){var i=hm(r),o=fm(e.R,i);return n.put(o)}))},t}();function Zm(t){t.createObjectStore(Mp.store,{keyPath:Mp.keyPath}).createIndex(Mp.documentTargetsIndex,Mp.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Cp.store,{keyPath:Cp.keyPath}).createIndex(Cp.queryTargetsIndexName,Cp.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(xp.store)}var Ym="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Jm=function(){function t(e,n,r,i,o,s,a,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Zl(Ql.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");var h,f;this.referenceDelegate=new Um(this,i),this.Le=n+"main",this.R=new rm(u),this.Be=new $p(this.Le,11,new Qm(this.R)),this.qe=new Cm(this.referenceDelegate,this.R),this.Ut=new bm,this.Ue=(h=this.R,f=this.Ut,new $m(h,f)),this.Qe=new pm,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===l&&th("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Zl(Ql.FAILED_PRECONDITION,Ym);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new Hl(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Ko(e,void 0,void 0,(function(){return Go(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return Ko(e,void 0,void 0,(function(){return Go(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return Ko(e,void 0,void 0,(function(){return Go(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return ty(e).put(new Pp(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(Wp(e))return Xl("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Xl("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return Xm(t).get(Ip.key).next((function(t){return Bp.resolve(e.tn(t))}))},t.prototype.en=function(t){return ty(t).delete(this.clientId)},t.prototype.nn=function(){return Ko(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Go(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Xp(t,Pp.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Bp.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)r=n[e],this.Ke.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Bp.resolve(!0):Xm(t).get(Ip.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Zl(Ql.FAILED_PRECONDITION,Ym);return!1}}return!(!e.networkEnabled||!e.inForeground)||ty(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Xl("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return Ko(this,void 0,void 0,(function(){var t=this;return Go(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Ip.store,Pp.store],(function(e){var n=new Jp(e,Hl.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return ty(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return _m.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;Xl("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,Vp,(function(o){return i=new Jp(o,r.Ne?r.Ne.next():Hl.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw th("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new Zl(Ql.FAILED_PRECONDITION,qp);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return Xm(t).get(Ip.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Zl(Ql.FAILED_PRECONDITION,Ym)}))},t.prototype.Ze=function(t){var e=new Ip(this.clientId,this.allowTabSynchronization,Date.now());return Xm(t).put(Ip.key,e)},t.yt=function(){return $p.yt()},t.prototype.Xe=function(t){var e=this,n=Xm(t);return n.get(Ip.key).next((function(t){return e.tn(t)?(Xl("IndexedDbPersistence","Releasing primary lease."),n.delete(Ip.key)):Bp.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(th("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return Xl("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(r){return th("IndexedDbPersistence","Failed to get zombied client id.",r),!1}},t.prototype.un=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){th("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Xm(t){return Xp(t,Ip.store)}function ty(t){return Xp(t,Pp.store)}function ey(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var ny=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return r=e,Mh.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Tn(t,e.path):Sf(e)?this.In(t,e,n):this.An(t,e,n);var r},t.prototype.Tn=function(t,e){return this.mn(t,new Mh(e)).next((function(t){var e=_d();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=_d();return this.Ut.getCollectionParents(t,i).next((function(s){return Bp.forEach(s,(function(s){var a,u,c=(a=e,u=s.child(i),new gf(u,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt));return r.An(t,c,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,l=r.get(c);null==l&&(l=Qh.newInvalidDocument(c),r=r.insert(c,l)),ed(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){Cf(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=Dd(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof sd&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),ry=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Dd(),i=Dd(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),iy=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i,o=this;return 0===(i=e).filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.explicitOrderBy.length||1===i.explicitOrderBy.length&&i.explicitOrderBy[0].field.isKeyField())||n.isEqual(fh.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(i){var s=o.Cn(e,i);return(wf(e)||Tf(e))&&o.Nn(e.limitType,s,r,n)?o.Dn(t,e):(Jl()<=ms.DEBUG&&Xl("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Af(e)),o.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new wd(Mf(t));return e.forEach((function(e,r){Cf(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Jl()<=ms.DEBUG&&Xl("QueryEngine","Using full collection scan to execute query:",Af(e)),this.Sn.getDocumentsMatchingQuery(t,e,fh.min())},t}(),oy=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new gd(uh),this.kn=new Bm((function(t){return Jh(t)}),Xh),this.$n=fh.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new ny(this.On,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(t,e,n,r){return new oy(t,e,n,r)}function ay(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i,o;return Go(this,(function(s){switch(s.label){case 0:return n=oh(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new ny(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=Dd(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];s=s.add(f.key)}}for(var d=0,p=e;d<p.length;d++){var m=p[d];r.push(m.batchId);for(var y=0,g=m.mutations;y<g.length;y++){var v=g[y];s=s.add(v.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function uy(t,e){var n=oh(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r,i,o,s,a,u,c,l=e.batch.keys(),h=n.On.newChangeBuffer({trackRemovals:!0});return(r=n,i=t,o=e,s=h,a=o.batch,u=a.keys(),c=Bp.resolve(),u.forEach((function(t){c=c.next((function(){return s.getEntry(i,t)})).next((function(e){var n=o.docVersions.get(t);ih(null!==n),e.version.compareTo(n)<0&&(a.applyToRemoteDocument(e,o),e.isValidDocument()&&s.addEntry(e,o.commitVersion))}))})),c.next((function(){return r._n.removeMutationBatch(i,a)}))).next((function(){return h.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,l)}))}))}function cy(t){var e=oh(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function ly(t,e){var n=oh(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach((function(e,o){var a,u,c,l=i.get(o);if(l){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var h=e.resumeToken;if(h.approximateByteSize()>0){var f=l.withResumeToken(h,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,f),a=l,c=e,ih((u=f).resumeToken.approximateByteSize()>0),(0===a.resumeToken.approximateByteSize()||u.snapshotVersion.toMicroseconds()-a.snapshotVersion.toMicroseconds()>=3e8||c.addedDocuments.size+c.modifiedDocuments.size+c.removedDocuments.size>0)&&s.push(n.qe.updateTargetData(t,f))}}}));var a=Id();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=Dd();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Id();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(fh.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Xl("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(fh.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return Bp.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.Fn=i,t}))}function hy(t,e){var n=oh(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function fy(t,e){var n=oh(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,Bp.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new nm(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function dy(t,e,n){return Ko(this,void 0,void 0,(function(){var r,i,o,s;return Go(this,(function(a){switch(a.label){case 0:r=oh(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Wp(s=a.sent()))throw s;return Xl("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function py(t,e,n){var r=oh(t),i=fh.min(),o=Dd();return r.persistence.runTransaction("Execute query","readonly",(function(t){return(s=r,a=t,u=kf(e),c=oh(s),l=c.kn.get(u),void 0!==l?Bp.resolve(c.Fn.get(l)):c.qe.getTargetData(a,u)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:fh.min(),n?o:Dd())})).next((function(t){return{documents:t,Bn:o}}));var s,a,u,c,l}))}function my(t,e){var n=oh(t),r=oh(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function yy(t){var e=oh(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return n=e.On,r=t,i=e.$n,o=oh(n),s=Id(),a=sm(i),u=Wm(r),c=IDBKeyRange.lowerBound(a,!0),u.$t({index:Op.readTimeIndex,range:c},(function(t,e){var n=im(o.R,e);s=s.insert(n.key,n),a=e.readTime})).next((function(){return{wn:s,readTime:am(a)}}));var n,r,i,o,s,a,u,c})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function gy(t){return Ko(this,void 0,void 0,(function(){var e;return Go(this,(function(n){return[2,(e=oh(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return e=Wm(t),n=fh.min(),e.$t({index:Op.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=am(e.readTime)),r.done()})).next((function(){return n}));var e,n})).then((function(t){e.$n=t}))]}))}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vy=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Bp.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:Gd(n.createTime)}),Bp.resolve()},t.prototype.getNamedQuery=function(t,e){return Bp.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,{name:(n=e).name,query:dm(n.bundledQuery),readTime:Gd(n.readTime)}),Bp.resolve();var n},t}(),by=function(){function t(){this.Wn=new wd(wy.Gn),this.zn=new wd(wy.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new wy(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new wy(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Mh(new gh([])),r=new wy(n,t),i=new wy(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Mh(new gh([])),n=new wy(e,t),r=new wy(e,t+1),i=Dd();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new wy(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),wy=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Mh.comparator(t.key,e.key)||uh(t.ns,e.ns)},t.Hn=function(t,e){return uh(t.ns,e.ns)||Mh.comparator(t.key,e.key)},t}(),Ty=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new wd(wy.Gn)}return t.prototype.checkEmpty=function(t){return Bp.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new tm(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new wy(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Bp.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Bp.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return Bp.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Bp.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Bp.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new wy(e,0),i=new wy(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),Bp.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new wd(uh);return e.forEach((function(t){var e=new wy(t,0),i=new wy(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),Bp.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Mh.isDocumentKey(i)||(i=i.child(""));var o=new wy(new Mh(i),0),s=new wd(uh);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),Bp.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;ih(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Bp.forEach(e.mutations,(function(i){var o=new wy(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new wy(e,0),r=this.rs.firstAfterOrEqual(n);return Bp.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,Bp.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Ey=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new gd(Mh.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Bp.resolve(n?n.document.clone():Qh.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Id();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Qh.newInvalidDocument(t))})),Bp.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Id(),i=new Mh(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,l=u.readTime;if(!e.path.isPrefixOf(a.path))break;l.compareTo(n)<=0||Cf(e,c)&&(r=r.insert(c.key,c.clone()))}return Bp.resolve(r)},t.prototype.fs=function(t,e){return Bp.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new Iy(this)},t.prototype.getSize=function(t){return Bp.resolve(this.size)},t}(),Iy=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return zo(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),Bp.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(zm),Sy=function(){function t(t){this.persistence=t,this.ds=new Bm((function(t){return Jh(t)}),Xh),this.lastRemoteSnapshotVersion=fh.min(),this.highestTargetId=0,this.ws=0,this._s=new by,this.targetCount=0,this.ys=Am.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),Bp.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Bp.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Bp.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Bp.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Bp.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Am(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Bp.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Bp.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Bp.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),Bp.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Bp.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Bp.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Bp.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Bp.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Bp.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Bp.resolve(n)},t.prototype.containsKey=function(t,e){return Bp.resolve(this._s.containsKey(e))},t}(),_y=function(){function t(t,e){var n,r=this;this.gs={},this.Ne=new Hl(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Sy(this),this.Ut=new gm,this.Ue=(n=this.Ut,new Ey(n,(function(t){return r.referenceDelegate.ps(t)}))),this.R=new rm(e),this.Qe=new vy(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Ty(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;Xl("MemoryPersistence","Starting transaction:",t);var i=new ky(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return Bp.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),ky=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return zo(e,t),e}(Up),Ny=function(){function t(t){this.persistence=t,this.As=new by,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw rh()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Bp.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Bp.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Bp.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Bp.forEach(this.vs,(function(r){var i=Mh.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Bp.or([function(){return Bp.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Dy=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(t,e){return"firestore_clients_"+t+"_"+e}function Ay(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Cy(t,e){return"firestore_targets_"+t+"_"+e}Dy.UNAUTHENTICATED=new Dy(null),Dy.GOOGLE_CREDENTIALS=new Dy("google-credentials-uid"),Dy.FIRST_PARTY=new Dy("first-party-uid");var My=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Zl(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(th("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),xy=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Zl(i.error.code,i.error.message)),o?new t(e,i.state,r):(th("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Ly=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ad(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ch(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(th("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Py=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(th("SharedClientState","Failed to parse online state: "+e),null)},t}(),Ry=function(){function t(){this.activeTargetIds=Ad()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Fy=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new gd(uh),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Oy(this.persistenceKey,this.Ns),this.Ms="firestore_sequence_number_"+this.persistenceKey,this.ks=this.ks.insert(this.Ns,new Ry),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Qs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Ko(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,l,h=this;return Go(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Oy(this.persistenceKey,r)))&&(o=Ly.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)l=c[u],this.Fs(l);return this.$s=[],this.window.addEventListener("pagehide",(function(){return h.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Cy(this.persistenceKey,t));if(n){var r=xy.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Cy(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Xl("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Xl("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Xl("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Xl("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void th("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return Ko(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Go(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Hl.o;if(null!=t)try{var n=JSON.parse(t);ih("number"==typeof n),e=n}catch(r){th("SharedClientState","Failed to read sequence number from WebStorage",r)}return e}(n.newValue))!==Hl.o&&this.sequenceNumberHandler(s);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new My(this.currentUser,t,e,n),i=Ay(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Ay(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=Cy(this.persistenceKey,t),i=new xy(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Ly.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return My.Vs(new Dy(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return xy.Vs(r,e)},t.prototype.js=function(t){return Py.Vs(t)},t.prototype.ii=function(t){return Ko(this,void 0,void 0,(function(){return Go(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Xl("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Ad();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),Vy=function(){function t(){this.li=new Ry,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Ry,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),qy=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Uy=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Xl("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Xl("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),jy={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},By=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),zy=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n}return zo(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var s=new Wl;s.listenOnce(Bl.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case jl.NO_ERROR:var e=s.getResponseJson();Xl("Connection","XHR received:",JSON.stringify(e)),i(e);break;case jl.TIMEOUT:Xl("Connection",'RPC "'+t+'" timed out'),o(new Zl(Ql.DEADLINE_EXCEEDED,"Request time out"));break;case jl.HTTP_ERROR:var n=s.getStatus();if(Xl("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(Ql).indexOf(c)>=0?c:Ql.UNKNOWN);o(new Zl(a,r.message))}else o(new Zl(Ql.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Zl(Ql.UNAVAILABLE,"Connection failed."));break;default:rh()}}finally{Xl("Connection",'RPC "'+t+'" completed.')}var u,c}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n,r,i=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=new Rl,s=Vu(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.Fi(a.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xo())||"object"==typeof navigator&&"ReactNative"===navigator.product||Xo().indexOf("Electron/")>=0||((r=Xo()).indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0)||Xo().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(a.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");Xl("Connection","Creating WebChannel: "+u,a);var c=o.createWebChannel(u,a),l=!1,h=!1,f=new By({Ei:function(t){h?Xl("Connection","Not sending because WebChannel is closed:",t):(l||(Xl("Connection","Opening WebChannel transport."),c.open(),l=!0),Xl("Connection","WebChannel sending:",t),c.send(t))},Ti:function(){return c.close()}}),d=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(e){setTimeout((function(){throw e}),0)}}))};return d(c,Gl.EventType.OPEN,(function(){h||Xl("Connection","WebChannel transport opened.")})),d(c,Gl.EventType.CLOSE,(function(){h||(h=!0,Xl("Connection","WebChannel transport closed"),f.Vi())})),d(c,Gl.EventType.ERROR,(function(t){h||(h=!0,eh("Connection","WebChannel transport errored:",t),f.Vi(new Zl(Ql.UNAVAILABLE,"The operation could not be completed")))})),d(c,Gl.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];ih(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Xl("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=ld[t];if(void 0!==e)return yd(e)}(o),a=i.message;void 0===s&&(s=Ql.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),h=!0,f.Vi(new Zl(s,a)),c.close()}else Xl("Connection","WebChannel received:",n),f.Si(n)}})),d(s,zl.STAT_EVENT,(function(t){t.stat===$l?Xl("Connection","Detected buffering proxy"):t.stat===Kl&&Xl("Connection","Detected no buffering proxy")})),setTimeout((function(){f.Pi()}),0),f},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Xl("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return Xl("RestConnection","Received: ",t),t}),(function(e){throw eh("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.6.3",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=jy[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $y(){return"undefined"!=typeof window?window:null}function Ky(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(t){return new Bd(t,!0)}var Wy=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&Xl("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Qi=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Hy=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Wy(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Ko(this,void 0,void 0,(function(){return Go(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Ko(this,void 0,void 0,(function(){return Go(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Ko(this,void 0,void 0,(function(){return Go(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Ql.RESOURCE_EXHAUSTED?(th(e.toString()),th("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):e&&e.code===Ql.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new Zl(Ql.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return Ko(t,void 0,void 0,(function(){return Go(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return Xl("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(Xl("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Qy=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return zo(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n,r;if("targetChange"in e){e.targetChange;var i="NO_CHANGE"===(r=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:rh(),o=e.targetChange.targetIds||[],s=function(t,e){return t.I?(ih(void 0===e||"string"==typeof e),Th.fromBase64String(e||"")):(ih(void 0===e||e instanceof Uint8Array),Th.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=(u=e.targetChange.cause)&&function(t){var e=void 0===t.code?Ql.UNKNOWN:yd(t.code);return new Zl(e,t.message||"")}(u);n=new Pd(i,o,s,a||null)}else if("documentChange"in e){e.documentChange,(i=e.documentChange).document,i.document.name,i.document.updateTime,o=Zd(t,i.document.name),s=Gd(i.document.updateTime);var u=new Wh({mapValue:{fields:i.document.fields}}),c=(a=Qh.newFoundDocument(o,s,u),i.targetIds||[]),l=i.removedTargetIds||[];n=new xd(c,l,a.key,a)}else if("documentDelete"in e)e.documentDelete,(i=e.documentDelete).document,o=Zd(t,i.document),s=i.readTime?Gd(i.readTime):fh.min(),u=Qh.newNoDocument(o,s),a=i.removedTargetIds||[],n=new xd([],a,u.key,u);else if("documentRemove"in e)e.documentRemove,(i=e.documentRemove).document,o=Zd(t,i.document),s=i.removedTargetIds||[],n=new xd([],s,o,null);else{if(!("filter"in e))return rh();e.filter;var h=e.filter;h.targetId,i=h.count||0,o=new pd(i),s=h.targetId,n=new Ld(s,o)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return fh.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?fh.min():e.readTime?Gd(e.readTime):fh.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e,n,r,i,o={};o.database=Xd(this.R),o.addTarget=(e=this.R,i=(n=t).target,(r=tf(i)?{documents:ip(e,i)}:{query:op(e,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=$d(e,n.resumeToken):n.snapshotVersion.compareTo(fh.min())>0&&(r.readTime=zd(e,n.snapshotVersion.toTimestamp())),r);var s=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return rh()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);s&&(o.labels=s),this.cr(o)},e.prototype.yr=function(t){var e={};e.database=Xd(this.R),e.removeTarget=t,this.cr(e)},e}(Hy),Zy=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return zo(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(ih(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=(r=t.writeResults,i=t.commitTime,r&&r.length>0?(ih(void 0!==i),r.map((function(t){return n=i,(r=(e=t).updateTime?Gd(e.updateTime):Gd(n)).isEqual(fh.min())&&(r=Gd(n)),new Zf(r,e.transformResults||[]);var e,n,r}))):[]),n=Gd(t.commitTime);return this.listener.Tr(n,e)}var r,i;return ih(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Xd(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return np(e.R,t)}))};this.cr(n)},e}(Hy),Yy=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return zo(e,t),e.prototype.br=function(){if(this.Rr)throw new Zl(Ql.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Ql.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Zl(Ql.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Ql.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Zl(Ql.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Jy=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(th(e),this.Vr=!1):Xl("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Xy=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return Ko(o,void 0,void 0,(function(){return Go(this,(function(t){switch(t.label){case 0:return ug(this)?(Xl("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Ko(this,void 0,void 0,(function(){var e;return Go(this,(function(n){switch(n.label){case 0:return(e=oh(t)).Or.add(4),[4,eg(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,tg(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Jy(n,r)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tg(t){return Ko(this,void 0,void 0,(function(){var e,n;return Go(this,(function(r){switch(r.label){case 0:if(!ug(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function eg(t){return Ko(this,void 0,void 0,(function(){var e,n;return Go(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function ng(t,e){var n=oh(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),ag(n)?sg(n):Ig(n).er()&&ig(n,e))}function rg(t,e){var n=oh(t),r=Ig(n);n.$r.delete(e),r.er()&&og(n,e),0===n.$r.size&&(r.er()?r.ir():ug(n)&&n.Br.set("Unknown"))}function ig(t,e){t.qr.U(e.targetId),Ig(t).mr(e)}function og(t,e){t.qr.U(e),Ig(t).yr(e)}function sg(t){t.qr=new Fd({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Ig(t).start(),t.Br.Sr()}function ag(t){return ug(t)&&!Ig(t).tr()&&t.$r.size>0}function ug(t){return 0===oh(t).Or.size}function cg(t){t.qr=void 0}function lg(t){return Ko(this,void 0,void 0,(function(){return Go(this,(function(e){return t.$r.forEach((function(e,n){ig(t,e)})),[2]}))}))}function hg(t,e){return Ko(this,void 0,void 0,(function(){return Go(this,(function(n){return cg(t),ag(t)?(t.Br.Nr(e),sg(t)):t.Br.set("Unknown"),[2]}))}))}function fg(t,e,n){return Ko(this,void 0,void 0,(function(){var r,i,o;return Go(this,(function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Pd&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i,o;return Go(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Xl("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,dg(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof xd?t.qr.X(e):e instanceof Ld?t.qr.rt(e):t.qr.et(e),n.isEqual(fh.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,cy(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,(a=t,u=n,c=a.qr.ut(u),c.targetChanges.forEach((function(t,e){if(t.resumeToken.approximateByteSize()>0){var n=a.$r.get(e);n&&a.$r.set(e,n.withResumeToken(t.resumeToken,u))}})),c.targetMismatches.forEach((function(t){var e=a.$r.get(t);if(e){a.$r.set(t,e.withResumeToken(Th.EMPTY_BYTE_STRING,e.snapshotVersion)),og(a,t);var n=new nm(e.target,t,1,e.sequenceNumber);ig(a,n)}})),a.remoteSyncer.applyRemoteEvent(c))]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Xl("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,dg(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}var a,u,c}))}))}function dg(t,e,n){return Ko(this,void 0,void 0,(function(){var r=this;return Go(this,(function(i){switch(i.label){case 0:if(!Wp(e))throw e;return t.Or.add(1),[4,eg(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return cy(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return Ko(r,void 0,void 0,(function(){return Go(this,(function(e){switch(e.label){case 0:return Xl("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,tg(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function pg(t,e){return e().catch((function(n){return dg(t,n,e)}))}function mg(t){return Ko(this,void 0,void 0,(function(){var e,n,r,i,o;return Go(this,(function(s){switch(s.label){case 0:e=oh(t),n=Sg(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!(ug(a=e)&&a.kr.length<10))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,hy(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Sg(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,dg(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return yg(e)&&gg(e),[2]}var a}))}))}function yg(t){return ug(t)&&!Sg(t).tr()&&t.kr.length>0}function gg(t){Sg(t).start()}function vg(t){return Ko(this,void 0,void 0,(function(){return Go(this,(function(e){return Sg(t).Ar(),[2]}))}))}function bg(t){return Ko(this,void 0,void 0,(function(){var e,n,r,i;return Go(this,(function(o){for(e=Sg(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function wg(t,e,n){return Ko(this,void 0,void 0,(function(){var r,i;return Go(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=em.from(r,e,n),[4,pg(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,mg(t)];case 2:return o.sent(),[2]}}))}))}function Tg(t,e){return Ko(this,void 0,void 0,(function(){return Go(this,(function(n){switch(n.label){case 0:return e&&Sg(t).pr?[4,function(t,e){return Ko(this,void 0,void 0,(function(){var n,r;return Go(this,(function(i){switch(i.label){case 0:return md(r=e.code)&&r!==Ql.ABORTED?(n=t.kr.shift(),Sg(t).sr(),[4,pg(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,mg(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return yg(t)&&gg(t),[2]}}))}))}function Eg(t,e){return Ko(this,void 0,void 0,(function(){var n;return Go(this,(function(r){switch(r.label){case 0:return n=oh(t),e?(n.Or.delete(2),[4,tg(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,eg(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Ig(t){var e,n,r,i,o=this;return t.Ur||(t.Ur=(e=t.datastore,n=t.asyncQueue,r={Ii:lg.bind(null,t),Ri:hg.bind(null,t),_r:fg.bind(null,t)},(i=oh(e)).br(),new Qy(n,i.Hi,i.credentials,i.R,r)),t.Mr.push((function(e){return Ko(o,void 0,void 0,(function(){return Go(this,(function(n){switch(n.label){case 0:return e?(t.Ur.sr(),ag(t)?sg(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:n.sent(),cg(t),n.label=3;case 3:return[2]}}))}))}))),t.Ur}function Sg(t){var e,n,r,i,o=this;return t.Qr||(t.Qr=(e=t.datastore,n=t.asyncQueue,r={Ii:vg.bind(null,t),Ri:Tg.bind(null,t),Ir:bg.bind(null,t),Tr:wg.bind(null,t)},(i=oh(e)).br(),new Zy(n,i.Hi,i.credentials,i.R,r)),t.Mr.push((function(e){return Ko(o,void 0,void 0,(function(){return Go(this,(function(n){switch(n.label){case 0:return e?(t.Qr.sr(),[4,mg(t)]):[3,2];case 1:return n.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:n.sent(),t.kr.length>0&&(Xl("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),n.label=4;case 4:return[2]}}))}))}))),t.Qr}var _g=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new jp,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Zl(Ql.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function kg(t,e){if(th("AsyncQueue",e+": "+t),Wp(t))return new Zl(Ql.UNAVAILABLE,e+": "+t);throw t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ng=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Mh.comparator(e.key,n.key)}:function(t,e){return Mh.comparator(t.key,e.key)},this.keyedMap=_d(),this.sortedSet=new gd(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Dg=function(){function t(){this.Kr=new gd(Mh.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):rh():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Og=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Ng.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Df(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Ag=function(){this.Wr=void 0,this.listeners=[]},Cg=function(){this.queries=new Bm((function(t){return Of(t)}),Df),this.onlineState="Unknown",this.Gr=new Set};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mg(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Go(this,(function(c){switch(c.label){case 0:if(n=oh(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Ag),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=kg(a,"Initialization of query '"+Af(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Rg(n),[2]}}))}))}function xg(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i,o,s;return Go(this,(function(a){return n=oh(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Lg(t,e){for(var n=oh(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].Hr(s)&&(r=!0);u.Wr=s}}r&&Rg(n)}function Pg(t,e,n){var r=oh(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Rg(t){t.Gr.forEach((function(t){t.next()}))}var Fg=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Og(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Og.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Vg=function(t){this.key=t},qg=function(t){this.key=t},Ug=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Dd(),this.mutatedKeys=Dd(),this.lo=Mf(t),this.fo=new Ng(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Dg,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=wf(this.query)&&i.size===this.query.limit?i.last():null,c=Tf(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=Cf(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.yo(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(a=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(a=!0)),p&&(h?(s=s.add(h),o=d?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),wf(this.query)||Tf(this.query))for(;s.size>this.query.limit;){var l=wf(this.query)?s.last():s.first();s=s.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return n=t.type,i=e.type,(o=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rh()}})(n)-o(i)||r.lo(t.doc,e.doc);var n,i,o})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Og(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Dg,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Dd(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new qg(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Vg(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Dd();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Og.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),jg=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Bg=function(t){this.key=t,this.bo=!1},zg=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Bm((function(t){return Of(t)}),Df),this.Vo=new Map,this.So=new Set,this.Do=new gd(Mh.comparator),this.Co=new Map,this.No=new by,this.xo={},this.Fo=new Map,this.ko=Am.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $g(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Go(this,(function(u){switch(u.label){case 0:return n=bv(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,fy(n.localStore,kf(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,Kg(n,e,r,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&ng(n.remoteStore,s),u.label=4;case 4:return[2,i]}}))}))}function Kg(t,e,n,r){return Ko(this,void 0,void 0,(function(){var i,o,s,a,u,c;return Go(this,(function(l){switch(l.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Ko(this,void 0,void 0,(function(){var i,o,s;return Go(this,(function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,py(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(iv(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,py(t.localStore,e,!0)];case 1:return i=l.sent(),o=new Ug(e,i.Bn),s=o._o(i.documents),a=Md.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),iv(t,n,u.To),c=new jg(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function Gg(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i;return Go(this,(function(o){switch(o.label){case 0:return n=oh(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!Df(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,dy(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),rg(n.remoteStore,r.targetId),nv(n,r.targetId)})).catch(Pm)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return nv(n,r.targetId),[4,dy(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Wg(t,e,n){return Ko(this,void 0,void 0,(function(){var r,i,o,s;return Go(this,(function(a){switch(a.label){case 0:r=wv(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,(u=r.localStore,c=e,h=oh(u),f=hh.now(),d=c.reduce((function(t,e){return t.add(e.key)}),Dd()),h.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return h.Mn.pn(t,d).next((function(e){l=e;for(var n=[],r=0,i=c;r<i.length;r++){var o=i[r],s=nd(o,l.get(o.key));null!=s&&n.push(new sd(o.key,s,Hh(s.value.mapValue),Yf.exists(!0)))}return h._n.addMutationBatch(t,f,n,c)}))})).then((function(t){return t.applyToLocalDocumentSet(l),{batchId:t.batchId,changes:l}})))];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new gd(uh)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,av(r,i.changes)];case 3:return a.sent(),[4,mg(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=kg(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}var u,c,l,h,f,d}))}))}function Hg(t,e){return Ko(this,void 0,void 0,(function(){var n,r;return Go(this,(function(i){switch(i.label){case 0:n=oh(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,ly(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(ih(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?ih(r.bo):t.removedDocuments.size>0&&(ih(r.bo),r.bo=!1))})),[4,av(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Pm(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Qg(t,e,n){var r=oh(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=oh(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&Rg(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Zg(t,e,n){return Ko(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Go(this,(function(c){switch(c.label){case 0:return(r=oh(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new gd(Mh.comparator)).insert(o,Qh.newNoDocument(o,fh.min())),a=Dd().add(o),u=new Cd(fh.min(),new Map,new wd(uh),s,a),[4,Hg(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),sv(r),[3,4];case 2:return[4,dy(r.localStore,e,!1).then((function(){return nv(r,e,n)})).catch(Pm)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Yg(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i;return Go(this,(function(o){switch(o.label){case 0:n=oh(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,uy(n.localStore,e)];case 2:return i=o.sent(),ev(n,r,null),tv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,av(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Pm(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Jg(t,e,n){return Ko(this,void 0,void 0,(function(){var r,i;return Go(this,(function(o){switch(o.label){case 0:r=oh(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,(s=r.localStore,a=e,u=oh(s),u.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var e;return u._n.lookupMutationBatch(t,a).next((function(n){return ih(null!==n),e=n.keys(),u._n.removeMutationBatch(t,n)})).next((function(){return u._n.performConsistencyCheck(t)})).next((function(){return u.Mn.pn(t,e)}))})))];case 2:return i=o.sent(),ev(r,e,n),tv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,av(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Pm(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}var s,a,u}))}))}function Xg(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i,o,s;return Go(this,(function(a){switch(a.label){case 0:ug((n=oh(t)).remoteStore)||Xl("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(u=n.localStore,c=oh(u),c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return c._n.getHighestUnacknowledgedBatchId(t)})))];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=kg(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}var u,c}))}))}function tv(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function ev(t,e,n){var r=oh(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function nv(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||rv(t,e)}))}function rv(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(rg(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),sv(t))}function iv(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Vg?(t.No.addReference(o.key,e),ov(t,o)):o instanceof qg?(Xl("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||rv(t,o.key)):rh()}}function ov(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Xl("SyncEngine","New document in limbo: "+n),t.So.add(r),sv(t))}function sv(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Mh(gh.fromString(e)),r=t.ko.next();t.Co.set(r,new Bg(n)),t.Do=t.Do.insert(n,r),ng(t.remoteStore,new nm(kf(bf(n.path)),r,2,Hl.o))}}function av(t,e,n){return Ko(this,void 0,void 0,(function(){var r,i,o,s;return Go(this,(function(a){switch(a.label){case 0:return r=oh(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,a){s.push(r.Oo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=ry.Pn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l;return Go(this,(function(h){switch(h.label){case 0:n=oh(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Bp.forEach(e,(function(e){return Bp.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return Bp.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!Wp(r=h.sent()))throw r;return Xl("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.Fn.get(a),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(a,l));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function uv(t,e){return Ko(this,void 0,void 0,(function(){var n,r;return Go(this,(function(i){switch(i.label){case 0:return(n=oh(t)).currentUser.isEqual(e)?[3,3]:(Xl("SyncEngine","User change. New user:",e.toKey()),[4,ay(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,(o=n).Fo.forEach((function(t){t.forEach((function(t){t.reject(new Zl(Ql.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),o.Fo.clear(),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,av(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}var o}))}))}function cv(t,e){var n=oh(t),r=n.Co.get(e);if(r&&r.bo)return Dd().add(r.key);var i=Dd(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function lv(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i;return Go(this,(function(o){switch(o.label){case 0:return[4,py((n=oh(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&iv(n,e.targetId,i.To),i)]}}))}))}function hv(t){return Ko(this,void 0,void 0,(function(){var e;return Go(this,(function(n){return[2,yy((e=oh(t)).localStore).then((function(t){return av(e,t)}))]}))}))}function fv(t,e,n,r){return Ko(this,void 0,void 0,(function(){var i,o;return Go(this,(function(s){switch(s.label){case 0:return[4,(a=(i=oh(t)).localStore,u=e,c=oh(a),l=oh(c._n),c.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return l.jt(t,u).next((function(e){return e?c.Mn.pn(t,e):Bp.resolve(null)}))})))];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,mg(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(ev(i,e,r||null),tv(i,e),function(t,e){oh(oh(t)._n).Gt(e)}(i.localStore,e)):rh(),s.label=4;case 4:return[4,av(i,o)];case 5:return s.sent(),[3,7];case 6:Xl("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}var a,u,c,l}))}))}function dv(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return Go(this,(function(l){switch(l.label){case 0:return bv(n=oh(t)),wv(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,pv(n,r.toArray())]);case 1:return i=l.sent(),n.$o=!0,[4,Eg(n.remoteStore,!0)];case 2:for(l.sent(),o=0,s=i;o<s.length;o++)a=s[o],ng(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return nv(n,e),dy(n.localStore,e,!0)})),rg(n.remoteStore,e)})),[4,c]);case 4:return l.sent(),[4,pv(n,u)];case 5:return l.sent(),(h=oh(n)).Co.forEach((function(t,e){rg(h.remoteStore,e)})),h.No.ts(),h.Co=new Map,h.Do=new gd(Mh.comparator),n.$o=!1,[4,Eg(n.remoteStore,!1)];case 6:l.sent(),l.label=7;case 7:return[2]}var h}))}))}function pv(t,e,n){return Ko(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h,f,d,p,m;return Go(this,(function(y){switch(y.label){case 0:n=oh(t),r=[],i=[],o=0,s=e,y.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,fy(n.localStore,kf(c[0]))]:[3,7]):[3,13];case 2:u=y.sent(),l=0,h=c,y.label=3;case 3:return l<h.length?(f=h[l],d=n.Po.get(f),[4,lv(n,d)]):[3,6];case 4:(p=y.sent()).snapshot&&i.push(p.snapshot),y.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,my(n.localStore,a)];case 8:return m=y.sent(),[4,fy(n.localStore,m)];case 9:return u=y.sent(),[4,Kg(n,mv(m),a,!1)];case 10:y.sent(),y.label=11;case 11:r.push(u),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function mv(t){return vf(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function yv(t){var e=oh(t);return oh(oh(e.localStore).persistence).fn()}function gv(t,e,n,r){return Ko(this,void 0,void 0,(function(){var i,o,s;return Go(this,(function(a){switch(a.label){case 0:return(i=oh(t)).$o?(Xl("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,yy(i.localStore)];case 3:return o=a.sent(),s=Cd.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,av(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,dy(i.localStore,e,!0)];case 6:return a.sent(),nv(i,e,r),[3,8];case 7:rh(),a.label=8;case 8:return[2]}}))}))}function vv(t,e,n){return Ko(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,f;return Go(this,(function(d){switch(d.label){case 0:if(!(r=bv(t)).$o)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(Xl("SyncEngine","Adding an already active target "+s),[3,5]):[4,my(r.localStore,s)]):[3,6];case 2:return a=d.sent(),[4,fy(r.localStore,a)];case 3:return u=d.sent(),[4,Kg(r,mv(a),u.targetId,!1)];case 4:d.sent(),ng(r.remoteStore,u),d.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Go(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,dy(r.localStore,t,!1).then((function(){rg(r.remoteStore,t),nv(r,t)})).catch(Pm)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,h=n,d.label=7;case 7:return l<h.length?(f=h[l],[5,c(f)]):[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function bv(t){var e=oh(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Hg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=cv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Zg.bind(null,e),e.vo._r=Lg.bind(null,e.eventManager),e.vo.Mo=Pg.bind(null,e.eventManager),e}function wv(t){var e=oh(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Yg.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Jg.bind(null,e),e}var Tv=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Ko(this,void 0,void 0,(function(){return Go(this,(function(e){switch(e.label){case 0:return this.R=Gy(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return sy(this.persistence,new iy,t.initialUser,this.R)},t.prototype.qo=function(t){return new _y(Ny.bs,this.R)},t.prototype.Bo=function(t){return new Vy},t.prototype.terminate=function(){return Ko(this,void 0,void 0,(function(){return Go(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),Ev=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return zo(e,t),e.prototype.initialize=function(e){return Ko(this,void 0,void 0,(function(){return Go(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,gy(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,wv(this.Ko.syncEngine)];case 4:return n.sent(),[4,mg(this.Ko.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Qo=function(t){return sy(this.persistence,new iy,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Vm(e,t.asyncQueue)},e.prototype.qo=function(t){var e=ey(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Em.withCacheSize(this.cacheSizeBytes):Em.DEFAULT;return new Jm(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,$y(),Ky(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Vy},e}(Tv),Iv=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return zo(e,t),e.prototype.initialize=function(e){return Ko(this,void 0,void 0,(function(){var n,r=this;return Go(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof Fy?(this.sharedClientState.syncEngine={ui:fv.bind(null,n),ai:gv.bind(null,n),hi:vv.bind(null,n),fn:yv.bind(null,n),ci:hv.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return Ko(r,void 0,void 0,(function(){return Go(this,(function(e){switch(e.label){case 0:return[4,dv(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=$y();if(!Fy.yt(e))throw new Zl(Ql.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ey(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Fy(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Ev),Sv=function(){function t(){}return t.prototype.initialize=function(t,e){return Ko(this,void 0,void 0,(function(){var n=this;return Go(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Qg(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=uv.bind(null,this.syncEngine),[4,Eg(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Cg},t.prototype.createDatastore=function(t){var e,n,r=Gy(t.databaseInfo.databaseId),i=(e=t.databaseInfo,new zy(e));return n=t.credentials,new Yy(n,i,r)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Qg(s.syncEngine,t,0)},o=Uy.yt()?new Uy:new qy,new Xy(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return n=this.localStore,r=this.remoteStore,i=this.eventManager,o=this.sharedClientState,s=t.initialUser,a=t.maxConcurrentLimboResolutions,u=e,c=new zg(n,r,i,o,s,a),u&&(c.$o=!0),c;var n,r,i,o,s,a,u,c},t.prototype.terminate=function(){return function(t){return Ko(this,void 0,void 0,(function(){var e;return Go(this,(function(n){switch(n.label){case 0:return e=oh(t),Xl("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,eg(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),_v=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),kv=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Ko(this,void 0,void 0,(function(){var e,n=this;return Go(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Zl(Ql.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Go(this,(function(u){switch(u.label){case 0:return n=oh(t),r=Xd(n.R)+"/documents",i={documents:e.map((function(t){return Qd(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e,r,i=(e=n.R,"found"in(r=t)?function(t,e){ih(!!e.found),e.found.name,e.found.updateTime;var n=Zd(t,e.found.name),r=Gd(e.found.updateTime),i=new Wh({mapValue:{fields:e.found.fields}});return Qh.newFoundDocument(n,r,i)}(e,r):"missing"in r?function(t,e){ih(!!e.missing),ih(!!e.readTime);var n=Zd(t,e.missing),r=Gd(e.readTime);return Qh.newNoDocument(n,r)}(e,r):rh());s.set(i.key.toString(),i)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());ih(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new fd(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Ko(this,void 0,void 0,(function(){var t,e=this;return Go(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Mh.fromPath(n);e.mutations.push(new dd(r,e.precondition(r)))})),[4,function(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i;return Go(this,(function(o){switch(o.label){case 0:return n=oh(t),r=Xd(n.R)+"/documents",i={writes:e.map((function(t){return np(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw rh();e=fh.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Zl(Ql.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Yf.updateTime(e):Yf.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(fh.min()))throw new Zl(Ql.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Yf.updateTime(e)}return Yf.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),Nv=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Wy(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return Ko(t,void 0,void 0,(function(){var t,e,n=this;return Go(this,(function(r){return t=new kv(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Oh(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!md(e)}return!1},t}(),Dv=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Dy.UNAUTHENTICATED,this.clientId=ah.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return Ko(r,void 0,void 0,(function(){return Go(this,(function(e){switch(e.label){case 0:return Xl("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return Ko(this,void 0,void 0,(function(){return Go(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Zl(Ql.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new jp;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Ko(t,void 0,void 0,(function(){var t,n;return Go(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=kg(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ov(t,e){return Ko(this,void 0,void 0,(function(){var n,r,i=this;return Go(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Xl("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return Ko(i,void 0,void 0,(function(){return Go(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,ay(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Av(t,e){return Ko(this,void 0,void 0,(function(){var n,r;return Go(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Cv(t)];case 1:return n=i.sent(),Xl("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return Ko(this,void 0,void 0,(function(){var n,r;return Go(this,(function(i){switch(i.label){case 0:return(n=oh(t)).asyncQueue.verifyOperationInProgress(),Xl("RemoteStore","RemoteStore received new credentials"),r=ug(n),n.Or.add(3),[4,eg(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,tg(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Cv(t){return Ko(this,void 0,void 0,(function(){return Go(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Xl("FirestoreClient","Using default OfflineComponentProvider"),[4,Ov(t,new Tv)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Mv(t){return Ko(this,void 0,void 0,(function(){return Go(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Xl("FirestoreClient","Using default OnlineComponentProvider"),[4,Av(t,new Sv)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function xv(t){return Cv(t).then((function(t){return t.persistence}))}function Lv(t){return Cv(t).then((function(t){return t.localStore}))}function Pv(t){return Mv(t).then((function(t){return t.remoteStore}))}function Rv(t){return Mv(t).then((function(t){return t.syncEngine}))}function Fv(t){return Ko(this,void 0,void 0,(function(){var e,n;return Go(this,(function(r){switch(r.label){case 0:return[4,Mv(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=$g.bind(null,e.syncEngine),n.onUnlisten=Gg.bind(null,e.syncEngine),n)]}}))}))}function Vv(t,e,n){var r=this;void 0===n&&(n={});var i=new jp;return t.asyncQueue.enqueueAndForget((function(){return Ko(r,void 0,void 0,(function(){var r;return Go(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new _v({next:function(o){e.enqueueAndForget((function(){return xg(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Zl(Ql.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Zl(Ql.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Fg(bf(n.path),o,{includeMetadataChanges:!0,so:!0});return Mg(t,s)},[4,Fv(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function qv(t,e,n){var r=this;void 0===n&&(n={});var i=new jp;return t.asyncQueue.enqueueAndForget((function(){return Ko(r,void 0,void 0,(function(){var r;return Go(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new _v({next:function(n){e.enqueueAndForget((function(){return xg(t,s)})),n.fromCache&&"server"===r.source?i.reject(new Zl(Ql.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Fg(n,o,{includeMetadataChanges:!0,so:!0});return Mg(t,s)},[4,Fv(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Uv=function(t,e,n,r,i,o,s){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s},jv=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Bv=new Map,zv=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},$v=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(Dy.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Kv=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Gv=function(){function t(t){var e=this;this.currentUser=Dy.UNAUTHENTICATED,this.oc=new jp,this.cc=0,this.changeListener=function(){return Promise.resolve()},this.uc=!1,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.ac=function(){e.cc++,e.currentUser=e.hc(),e.oc.resolve(),e.uc&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){Xl("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.lc(),e.auth.addAuthTokenListener(e.ac)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):e.uc&&(Xl("FirebaseCredentialsProvider","Auth not yet detected"),e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)})))}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(Xl("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(ih("string"==typeof n.accessToken),new zv(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){this.uc=!0,this.asyncQueue=t,this.changeListener=e},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.ac),this.changeListener=function(){return Promise.resolve()}},t.prototype.hc=function(){var t=this.auth&&this.auth.getUid();return ih(null===t||"string"==typeof t),new Dy(t)},t.prototype.lc=function(){var t=this;this.uc&&(this.uc=!1,this.asyncQueue.enqueueRetryable((function(){return Ko(t,void 0,void 0,(function(){return Go(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,this.changeListener(this.currentUser)];case 2:return t.sent(),this.uc=!0,[2]}}))}))})))},t}(),Wv=function(){function t(t,e,n){this.fc=t,this.dc=e,this.wc=n,this.type="FirstParty",this.user=Dy.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.dc},e=this.fc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.wc&&(t["X-Goog-Iam-Authorization-Token"]=this.wc),t},enumerable:!1,configurable:!0}),t}(),Hv=function(){function t(t,e,n){this.fc=t,this.dc=e,this.wc=n}return t.prototype.getToken=function(){return Promise.resolve(new Wv(this.fc,this.dc,this.wc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(Dy.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qv(t,e,n){if(!n)throw new Zl(Ql.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Zv(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Yv(t,e,n,r){if(!0===e&&!0===r)throw new Zl(Ql.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Jv(t){if(!Mh.isDocumentKey(t))throw new Zl(Ql.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Xv(t){if(Mh.isDocumentKey(t))throw new Zl(Ql.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function tb(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":rh()}function eb(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Zl(Ql.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=tb(t);throw new Zl(Ql.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function nb(t,e){if(e<=0)throw new Zl(Ql.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rb=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Zl(Ql.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Zl(Ql.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Yv("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),ib=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rb({}),this._settingsFrozen=!1,t instanceof jv?(this._databaseId=t,this._credentials=new $v):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Zl(Ql.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jv(t.options.projectId)}(t),this._credentials=new Gv(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Zl(Ql.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Zl(Ql.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rb(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new $v;switch(t.type){case"gapi":var e=t.client;return ih(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Hv(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Zl(Ql.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Bv.get(this))&&(Xl("ComponentProvider","Removing Datastore"),Bv.delete(this),t.terminate()),Promise.resolve();var t},t}(),ob=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ab(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),sb=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),ab=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,bf(r))||this)._path=r,i.type="collection",i}return zo(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new ob(this.firestore,null,new Mh(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(sb);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ub(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=cs(t),Qv("collection","path",e),t instanceof ib)return Xv(n=gh.fromString.apply(gh,Qo([e],r))),new ab(t,null,n);if(!(t instanceof ob||t instanceof ab))throw new Zl(Ql.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Xv(n=gh.fromString.apply(gh,Qo([t.path],r)).child(gh.fromString(e))),new ab(t.firestore,null,n)}function cb(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=cs(t),1===arguments.length&&(e=ah.u()),Qv("doc","path",e),t instanceof ib)return Jv(n=gh.fromString.apply(gh,Qo([e],r))),new ob(t,null,new Mh(n));if(!(t instanceof ob||t instanceof ab))throw new Zl(Ql.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Jv(n=t._path.child(gh.fromString.apply(gh,Qo([e],r)))),new ob(t.firestore,t instanceof ab?t.converter:null,new Mh(n))}function lb(t,e){return t=cs(t),e=cs(e),(t instanceof ob||t instanceof ab)&&(e instanceof ob||e instanceof ab)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function hb(t,e){return t=cs(t),e=cs(e),t instanceof sb&&e instanceof sb&&t.firestore===e.firestore&&Df(t._query,e._query)&&t.converter===e.converter}var fb=function(){function t(){var t=this;this._c=Promise.resolve(),this.mc=[],this.yc=!1,this.gc=[],this.Ec=null,this.Tc=!1,this.Ic=[],this.Zi=new Wy(this,"async_queue_retry"),this.Ac=function(){var e=Ky();e&&Xl("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Ky();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ac)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this.yc},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Rc(),this.bc(t)},t.prototype.enterRestrictedMode=function(){if(!this.yc){this.yc=!0;var t=Ky();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ac)}},t.prototype.enqueue=function(t){return this.Rc(),this.yc?new Promise((function(t){})):this.bc(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.mc.push(t),e.vc()}))},t.prototype.vc=function(){return Ko(this,void 0,void 0,(function(){var t,e=this;return Go(this,(function(n){switch(n.label){case 0:if(0===this.mc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.mc[0]()];case 2:return n.sent(),this.mc.shift(),this.Zi.reset(),[3,4];case 3:if(!Wp(t=n.sent()))throw t;return Xl("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.mc.length>0&&this.Zi.ji((function(){return e.vc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.bc=function(t){var e=this,n=this._c.then((function(){return e.Tc=!0,t().catch((function(t){throw e.Ec=t,e.Tc=!1,th("INTERNAL UNHANDLED ERROR: ",(r=(n=t).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),t;var n,r})).then((function(t){return e.Tc=!1,t}))}));return this._c=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Rc(),this.Ic.indexOf(t)>-1&&(e=0);var i=_g.createAndSchedule(this,t,e,n,(function(t){return r.Pc(t)}));return this.gc.push(i),i},t.prototype.Rc=function(){this.Ec&&rh()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Vc=function(){return Ko(this,void 0,void 0,(function(){var t;return Go(this,(function(e){switch(e.label){case 0:return[4,t=this._c];case 1:e.sent(),e.label=2;case 2:if(t!==this._c)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Sc=function(t){for(var e=0,n=this.gc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Dc=function(t){var e=this;return this.Vc().then((function(){e.gc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.gc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Vc()}))},t.prototype.Cc=function(t){this.Ic.push(t)},t.prototype.Pc=function(t){var e=this.gc.indexOf(t);this.gc.splice(e,1)},t}();function db(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var pb=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new fb,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return zo(e,t),e.prototype._terminate=function(){return this._firestoreClient||yb(this),this._firestoreClient.terminate()},e}(ib);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mb(t){return t._firestoreClient||yb(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function yb(t){var e,n,r,i,o,s=t._freezeSettings(),a=(n=t._databaseId,r=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",i=t._persistenceKey,new Uv(n,r,i,(o=s).host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling));t._firestoreClient=new Dv(t._credentials,t._queue,a)}function gb(t,e,n){var r=this,i=new jp;return t.asyncQueue.enqueue((function(){return Ko(r,void 0,void 0,(function(){var r;return Go(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Ov(t,n)];case 1:return o.sent(),[4,Av(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!("FirebaseError"===(s=r=o.sent()).name?s.code===Ql.FAILED_PRECONDITION||s.code===Ql.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&s instanceof DOMException)||22===s.code||20===s.code||11===s.code))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}var s}))}))})).then((function(){return i.promise}))}function vb(t){if(t._initialized||t._terminated)throw new Zl(Ql.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bb=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bh(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),wb=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Th.fromBase64String(e))}catch(n){throw new Zl(Ql.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}},t.fromUint8Array=function(e){return new t(Th.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Tb=function(t){this._methodName=t},Eb=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Zl(Ql.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Zl(Ql.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return uh(this._lat,t._lat)||uh(this._long,t._long)},t}(),Ib=/^__.*__$/,Sb=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new sd(t,this.data,this.fieldMask,e,this.fieldTransforms):new od(t,this.data,e,this.fieldTransforms)},t}(),_b=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new sd(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kb(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rh()}}var Nb=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Nc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xc",{get:function(){return this.settings.xc},enumerable:!1,configurable:!0}),t.prototype.Fc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Fc({path:n,$c:!1});return r.Oc(t),r},t.prototype.Mc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Fc({path:n,$c:!1});return r.Nc(),r},t.prototype.Lc=function(t){return this.Fc({path:void 0,$c:!0})},t.prototype.Bc=function(t){return Wb(t,this.settings.methodName,this.settings.qc||!1,this.path,this.settings.Uc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Nc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Oc(this.path.get(t))},t.prototype.Oc=function(t){if(0===t.length)throw this.Bc("Document fields must not be empty");if(kb(this.xc)&&Ib.test(t))throw this.Bc('Document fields cannot begin and end with "__"')},t}(),Db=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Gy(t)}return t.prototype.Qc=function(t,e,n,r){return void 0===r&&(r=!1),new Nb({xc:t,methodName:e,Uc:n,path:bh.emptyPath(),$c:!1,qc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Ob(t){var e=t._freezeSettings(),n=Gy(t._databaseId);return new Db(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ab(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Qc(o.merge||o.mergeFields?2:0,e,n,i);zb("Data must be an object, but it was:",s,r);var a,u,c=jb(r,s);if(o.merge)a=new wh(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var d=$b(e,f[h],n);if(!s.contains(d))throw new Zl(Ql.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Hb(l,d)||l.push(d)}a=new wh(l),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new Sb(new Wh(c),a,u)}var Cb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zo(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.xc)throw 1===t.xc?t.Bc(this._methodName+"() can only appear at the top level of your update data"):t.Bc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Tb);function Mb(t,e,n){return new Nb({xc:3,Uc:e.settings.Uc,methodName:t._methodName,$c:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var xb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zo(e,t),e.prototype._toFieldTransform=function(t){return new Qf(t.path,new jf)},e.prototype.isEqual=function(t){return t instanceof e},e}(Tb),Lb=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return zo(e,t),e.prototype._toFieldTransform=function(t){var e=Mb(this,t,!0),n=this.Kc.map((function(t){return Ub(t,e)})),r=new Bf(n);return new Qf(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Tb),Pb=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return zo(e,t),e.prototype._toFieldTransform=function(t){var e=Mb(this,t,!0),n=this.Kc.map((function(t){return Ub(t,e)})),r=new $f(n);return new Qf(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Tb),Rb=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).jc=n,r}return zo(e,t),e.prototype._toFieldTransform=function(t){var e=new Gf(t.R,Rf(t.R,this.jc));return new Qf(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Tb);function Fb(t,e,n,r){var i=t.Qc(1,e,n);zb("Data must be an object, but it was:",i,r);var o=[],s=Wh.empty();ph(r,(function(t,r){var a=Gb(e,t,n);r=cs(r);var u=i.Mc(a);if(r instanceof Cb)o.push(a);else{var c=Ub(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new wh(o);return new _b(s,a,i.fieldTransforms)}function Vb(t,e,n,r,i,o){var s=t.Qc(1,e,n),a=[$b(e,r,n)],u=[i];if(o.length%2!=0)throw new Zl(Ql.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push($b(e,o[c])),u.push(o[c+1]);for(var l=[],h=Wh.empty(),f=a.length-1;f>=0;--f)if(!Hb(l,a[f])){var d=a[f],p=u[f];p=cs(p);var m=s.Mc(d);if(p instanceof Cb)l.push(d);else{var y=Ub(p,m);null!=y&&(l.push(d),h.set(d,y))}}var g=new wh(l);return new _b(h,g,s.fieldTransforms)}function qb(t,e,n,r){return void 0===r&&(r=!1),Ub(n,t.Qc(r?4:3,e))}function Ub(t,e){if(Bb(t=cs(t)))return zb("Unsupported field value:",e,t),jb(t,e);if(t instanceof Tb)return function(t,e){if(!kb(e.xc))throw e.Bc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Bc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.$c&&4!==e.xc)throw e.Bc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Ub(o[i],e.Lc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=cs(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Rf(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=hh.fromDate(t);return{timestampValue:zd(e.R,n)}}if(t instanceof hh)return n=new hh(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:zd(e.R,n)};if(t instanceof Eb)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wb)return{bytesValue:$d(e.R,t._byteString)};if(t instanceof ob){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Bc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Wd(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Bc("Unsupported field value: "+tb(t))}(t,e)}function jb(t,e){var n={};return mh(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ph(t,(function(t,r){var i=Ub(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Bb(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof hh||t instanceof Eb||t instanceof wb||t instanceof ob||t instanceof Tb)}function zb(t,e,n){if(!Bb(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){var r=tb(n);throw"an object"===r?e.Bc(t+" a custom object"):e.Bc(t+" "+r)}var i}function $b(t,e,n){if((e=cs(e))instanceof bb)return e._internalPath;if("string"==typeof e)return Gb(t,e);throw Wb("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Kb=new RegExp("[~\\*/\\[\\]]");function Gb(t,e,n){if(e.search(Kb)>=0)throw Wb("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(bb.bind.apply(bb,Qo([void 0],e.split(".")))))._internalPath}catch(r){throw Wb("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Wb(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Zl(Ql.INVALID_ARGUMENT,(a+=". ")+t+u)}function Hb(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qb=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new ob(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Zb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Yb("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Zb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zo(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Qb);function Yb(t,e){return"string"==typeof e?Gb(t,e):e instanceof bb?e._internalPath:e._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jb=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Xb=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return zo(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new tw(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Yb("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Qb),tw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zo(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Xb),ew=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Jb(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new tw(n._firestore,n._userDataWriter,r.key,r,new Jb(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Zl(Ql.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){var r=new tw(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Jb(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new tw(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Jb(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:nw(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function nw(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rh()}}function rw(t,e){return t instanceof Xb&&e instanceof Xb?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof ew&&e instanceof ew&&t._firestore===e._firestore&&hb(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iw(t){if(Tf(t)&&0===t.explicitOrderBy.length)throw new Zl(Ql.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ow=function(){};function sw(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var aw=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Wc=e,i.Gc=n,i.zc=r,i.type="where",i}return zo(e,t),e.prototype._apply=function(t){var e,n,r,i=Ob(t.firestore),o=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){pw(s,o);for(var u=[],c=0,l=s;c<l.length;c++){var h=l[c];u.push(dw(r,t,h))}a={arrayValue:{values:u}}}else a=dw(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||pw(s,o),a=qb(n,"where",s,"in"===o||"not-in"===o);var f=ef.create(i,o,a);return function(t,e){if(e.g()){var n=If(t);if(null!==n&&!n.isEqual(e.field))throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Ef(t);null!==r&&mw(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Zl(Ql.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Zl(Ql.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,i,t.firestore._databaseId,this.Wc,this.Gc,this.zc);return new sb(t.firestore,t.converter,(e=t._query,n=o,r=e.filters.concat([n]),new gf(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)))},e}(ow),uw=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Wc=e,r.Hc=n,r.type="orderBy",r}return zo(e,t),e.prototype._apply=function(t){var e,n,r,i=function(t,e,n){if(null!==t.startAt)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new df(e,n);return function(t,e){if(null===Ef(t)){var n=If(t);null!==n&&mw(t,n,e.field)}}(t,r),r}(t._query,this.Wc,this.Hc);return new sb(t.firestore,t.converter,(e=t._query,n=i,r=e.explicitOrderBy.concat([n]),new gf(e.path,e.collectionGroup,r,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)))},e}(ow),cw=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return zo(e,t),e.prototype._apply=function(t){return new sb(t.firestore,t.converter,Nf(t._query,this.Jc,this.Yc))},e}(ow),lw=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Xc=n,i.Zc=r,i}return zo(e,t),e.prototype._apply=function(t){var e,n,r=fw(t,this.type,this.Xc,this.Zc);return new sb(t.firestore,t.converter,(e=t._query,n=r,new gf(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,n,e.endAt)))},e}(ow),hw=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Xc=n,i.Zc=r,i}return zo(e,t),e.prototype._apply=function(t){var e,n,r=fw(t,this.type,this.Xc,this.Zc);return new sb(t.firestore,t.converter,(e=t._query,n=r,new gf(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,n)))},e}(ow);function fw(t,e,n,r){if(n[0]=cs(n[0]),n[0]instanceof Qb)return function(t,e,n,r,i){if(!r)throw new Zl(Ql.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=_f(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Uh(e,r.key));else{var c=r.data.field(u.field);if(kh(c))throw new Zl(Ql.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new hf(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Ob(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Zl(Ql.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Sf(t)&&-1!==c.indexOf("/"))throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(gh.fromString(c));if(!Mh.isDocumentKey(l))throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new Mh(l);a.push(Uh(e,h))}else{var f=qb(n,r,c);a.push(f)}}return new hf(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function dw(t,e,n){if("string"==typeof(n=cs(n))){if(""===n)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sf(e)&&-1!==n.indexOf("/"))throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(gh.fromString(n));if(!Mh.isDocumentKey(r))throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Uh(t,new Mh(r))}if(n instanceof ob)return Uh(t,n._key);throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+tb(n)+".")}function pw(t,e){if(!Array.isArray(t)||0===t.length)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function mw(t,e,n){if(!n.isEqual(e))throw new Zl(Ql.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yw=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),xh(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Sh(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(_h(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw rh()}},t.prototype.convertObject=function(t,e){var n=this,r={};return ph(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new Eb(Sh(t.latitude),Sh(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Nh(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Dh(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Ih(t);return new hh(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=gh.fromString(t);ih(gp(n));var r=new jv(n.get(1),n.get(3)),i=new Mh(n.popFirst(5));return r.isEqual(e)||th("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gw(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var vw=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return zo(e,t),e.prototype.convertBytes=function(t){return new wb(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new ob(this.firestore,null,e)},e}(yw),bw=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Ob(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=ww(t,this._firestore),i=gw(r.converter,e,n),o=Ab(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Yf.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=ww(t,this._firestore);return o="string"==typeof(e=cs(e))||e instanceof bb?Vb(this._dataReader,"WriteBatch.update",s._key,e,n,r):Fb(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Yf.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=ww(t,this._firestore);return this._mutations=this._mutations.concat(new fd(e._key,Yf.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Zl(Ql.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(t,e){if((t=cs(t)).firestore!==e)throw new Zl(Ql.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tw=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return zo(e,t),e.prototype.convertBytes=function(t){return new wb(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new ob(this.firestore,null,e)},e}(yw);function Ew(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=eb(t,ob);var o=eb(t.firestore,pb),s=Ob(o);return Sw(o,[("string"==typeof(e=cs(e))||e instanceof bb?Vb(s,"updateDoc",t._key,e,n,r):Fb(s,"updateDoc",t._key,e)).toMutation(t._key,Yf.exists(!0))])}function Iw(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=cs(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||db(i[a])||(s=i[a],a++);var u,c,l,h={includeMetadataChanges:s.includeMetadataChanges};if(db(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof ob)c=eb(t.firestore,pb),l=bf(t._key.path),u={next:function(e){i[a]&&i[a](_w(c,t,e))},error:i[a+1],complete:i[a+2]};else{var d=eb(t,sb);c=eb(d.firestore,pb),l=d._query;var p=new Tw(c);u={next:function(t){i[a]&&i[a](new ew(c,p,d,t))},error:i[a+1],complete:i[a+2]},iw(t._query)}return function(t,e,n,r){var i=this,o=new _v(r),s=new Fg(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return Ko(i,void 0,void 0,(function(){var e;return Go(this,(function(n){switch(n.label){case 0:return e=Mg,[4,Fv(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return Ko(i,void 0,void 0,(function(){var e;return Go(this,(function(n){switch(n.label){case 0:return e=xg,[4,Fv(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(mb(c),l,h,u)}function Sw(t,e){return function(t,e){var n=this,r=new jp;return t.asyncQueue.enqueueAndForget((function(){return Ko(n,void 0,void 0,(function(){var n;return Go(this,(function(i){switch(i.label){case 0:return n=Wg,[4,Rv(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(mb(t),e)}function _w(t,e,n){var r=n.docs.get(e._key),i=new Tw(t);return new Xb(t,i,e._key,r,new Jb(n.hasPendingWrites,n.fromCache),e.converter)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kw=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return zo(e,t),e.prototype.get=function(e){var n=this,r=ww(e,this._firestore),i=new Tw(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Xb(n._firestore,i,r._key,t._document,new Jb(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Ob(t)}return t.prototype.get=function(t){var e=this,n=ww(t,this._firestore),r=new vw(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return rh();var i=t[0];if(i.isFoundDocument())return new Qb(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Qb(e._firestore,r,n._key,null,n.converter);throw rh()}))},t.prototype.set=function(t,e,n){var r=ww(t,this._firestore),i=gw(r.converter,e,n),o=Ab(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=ww(t,this._firestore);return o="string"==typeof(e=cs(e))||e instanceof bb?Vb(this._dataReader,"Transaction.update",s._key,e,n,r):Fb(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=ww(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(){if("undefined"==typeof Uint8Array)throw new Zl(Ql.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Dw(){if("undefined"==typeof atob)throw new Zl(Ql.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ow=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Dw(),new t(wb.fromBase64String(e))},t.fromUint8Array=function(e){return Nw(),new t(wb.fromUint8Array(e))},t.prototype.toBase64=function(){return Dw(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Nw(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Aw=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){vb(t=eb(t,pb));var n=mb(t),r=t._freezeSettings(),i=new Sv;return gb(n,i,new Ev(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){vb(t=eb(t,pb));var e=mb(t),n=t._freezeSettings(),r=new Sv;return gb(e,r,new Iv(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Zl(Ql.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new jp;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return Ko(e,void 0,void 0,(function(){var e;return Go(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Ko(this,void 0,void 0,(function(){var e;return Go(this,(function(n){switch(n.label){case 0:return $p.yt()?(e=t+"main",[4,$p.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(ey(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Cw=function(){function t(t,e,n){var r=this;this._delegate=e,this.tu=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof jv||(this.eu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||eh("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=eb(t,ib))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&eh("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=$o({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Zo.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),Zo.encodeString(JSON.stringify(o),!1),""].join(".")}(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Zl(Ql.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Kv(new zv(o,new Dy(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Ko(e,void 0,void 0,(function(){var e,n;return Go(this,(function(r){switch(r.label){case 0:return[4,xv(t)];case 1:return e=r.sent(),[4,Pv(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),i=n,o=oh(i),o.Or.delete(0),tg(o))]}var i,o}))}))}))}(mb(eb(this._delegate,pb)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Ko(e,void 0,void 0,(function(){var e,n;return Go(this,(function(r){switch(r.label){case 0:return[4,xv(t)];case 1:return e=r.sent(),[4,Pv(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Ko(this,void 0,void 0,(function(){var e;return Go(this,(function(n){switch(n.label){case 0:return(e=oh(t)).Or.add(0),[4,eg(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(mb(eb(this._delegate,pb)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Yv("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.tu.enableMultiTabIndexedDbPersistence(this):this.tu.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.tu.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.eu&&(this.eu._removeServiceInstance("firestore"),this.eu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new jp;return t.asyncQueue.enqueueAndForget((function(){return Ko(e,void 0,void 0,(function(){var e;return Go(this,(function(r){switch(r.label){case 0:return e=Xg,[4,Rv(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(mb(eb(this._delegate,pb)))},t.prototype.onSnapshotsInSync=function(t){return e=this._delegate,n=t,function(t,e){var n=this,r=new _v(e);return t.asyncQueue.enqueueAndForget((function(){return Ko(n,void 0,void 0,(function(){var e;return Go(this,(function(n){switch(n.label){case 0:return e=function(t,e){oh(t).Gr.add(e),e.next()},[4,Fv(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return Ko(n,void 0,void 0,(function(){var e;return Go(this,(function(n){switch(n.label){case 0:return e=function(t,e){oh(t).Gr.delete(e)},[4,Fv(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(mb(e=eb(e,pb)),db(n)?n:{next:n});var e,n},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.eu)throw new Zl(Ql.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.eu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Kw(this,ub(this._delegate,t))}catch(e){throw Fw(e,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Rw(this,cb(this._delegate,t))}catch(e){throw Fw(e,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Bw(this,function(t,e){if(t=eb(t,ib),Qv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new sb(t,null,(n=e,new gf(gh.emptyPath(),n)));var n}(this._delegate,t))}catch(e){throw Fw(e,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e,n=this;return function(t,e){var n=this,r=new jp;return t.asyncQueue.enqueueAndForget((function(){return Ko(n,void 0,void 0,(function(){var n;return Go(this,(function(i){switch(i.label){case 0:return[4,(o=t,Mv(o).then((function(t){return t.datastore})))];case 1:return n=i.sent(),new Nv(t.asyncQueue,n,e,r).run(),[2]}var o}))}))})),r.promise}(mb(e=this._delegate),(function(r){return function(e){return t(new xw(n,e))}(new kw(e,r))}))},t.prototype.batch=function(){var t=this;return mb(this._delegate),new Lw(new bw(this._delegate,(function(e){return Sw(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new Zl(Ql.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Zl(Ql.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Mw=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return zo(e,t),e.prototype.convertBytes=function(t){return new Ow(new wb(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Rw.nu(e,this.firestore,null)},e}(yw);var xw=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Mw(t)}return t.prototype.get=function(t){var e=this,n=Gw(t);return this._delegate.get(n).then((function(t){return new Uw(e._firestore,new Xb(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=Gw(t);return n?(Zv("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Gw(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Qo([s,e,n],i)),this},t.prototype.delete=function(t){var e=Gw(t);return this._delegate.delete(e),this},t}(),Lw=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Gw(t);return n?(Zv("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Gw(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Qo([s,e,n],i)),this},t.prototype.delete=function(t){var e=Gw(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Pw=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new tw(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new jw(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.su=function(e,n){var r=t.iu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Mw(e),n),i.set(n,o)),o},t}();Pw.iu=new WeakMap;var Rw=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Mw(t)}return t.ru=function(e,n,r){if(e.length%2!=0)throw new Zl(Ql.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new ob(n._delegate,r,new Mh(e)))},t.nu=function(e,n,r){return new t(n,new ob(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Kw(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Kw(this.firestore,ub(this._delegate,t))}catch(e){throw Fw(e,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=cs(t))instanceof ob&&lb(this._delegate,t)},t.prototype.set=function(t,e){e=Zv("DocumentReference.set",e);try{return function(t,e,n){t=eb(t,ob);var r=eb(t.firestore,pb),i=gw(t.converter,e,n);return Sw(r,[Ab(Ob(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Yf.none())])}(this._delegate,t,e)}catch(n){throw Fw(n,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Ew(this._delegate,t):Ew.apply(void 0,Qo([this._delegate,t,e],n))}catch(i){throw Fw(i,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Sw(eb((t=this._delegate).firestore,pb),[new fd(t._key,Yf.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Vw(e),i=qw(e,(function(e){return new Uw(t.firestore,new Xb(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return Iw(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=eb(t,ob);var e=eb(t.firestore,pb),n=mb(e),r=new Tw(e);return function(t,e){var n=this,r=new jp;return t.asyncQueue.enqueueAndForget((function(){return Ko(n,void 0,void 0,(function(){var n;return Go(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Ko(this,void 0,void 0,(function(){var r,i;return Go(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(s=t,a=e,u=oh(s),u.persistence.runTransaction("read document","readonly",(function(t){return u.Mn.mn(t,a)})))];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Zl(Ql.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=kg(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}var s,a,u}))}))},[4,Lv(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new Xb(e,r,t._key,n,new Jb(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=eb(t,ob);var e=eb(t.firestore,pb);return Vv(mb(e),t._key,{source:"server"}).then((function(n){return _w(e,t,n)}))}(this._delegate):function(t){t=eb(t,ob);var e=eb(t.firestore,pb);return Vv(mb(e),t._key).then((function(n){return _w(e,t,n)}))}(this._delegate)).then((function(t){return new Uw(e.firestore,new Xb(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Pw.su(this.firestore,e)):this._delegate.withConverter(null))},t}();function Fw(t,e,n){return t.message=t.message.replace(e,n),t}function Vw(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!db(r))return r}return{}}function qw(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=db(t[0])?t[0]:db(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Uw=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Rw(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return rw(this._delegate,t._delegate)},t}(),jw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zo(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Uw),Bw=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Mw(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,sw(this._delegate,(o=r,s=i=n,a=Yb("where",e),new aw(a,s,o))))}catch(i){throw Fw(i,/(orderBy|where)\(\)/,"Query.$1()")}var i,o,s,a},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,sw(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Yb("orderBy",t);return new uw(r,n)}(e,n)))}catch(r){throw Fw(r,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,sw(this._delegate,(nb("limit",n=e),new cw("limit",n,"F"))))}catch(r){throw Fw(r,"limit()","Query.limit()")}var n},t.prototype.limitToLast=function(e){try{return new t(this.firestore,sw(this._delegate,(nb("limitToLast",n=e),new cw("limitToLast",n,"L"))))}catch(r){throw Fw(r,"limitToLast()","Query.limitToLast()")}var n},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,sw(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new lw("startAt",t,!0)}.apply(void 0,e)))}catch(r){throw Fw(r,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,sw(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new lw("startAfter",t,!1)}.apply(void 0,e)))}catch(r){throw Fw(r,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,sw(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new hw("endBefore",t,!0)}.apply(void 0,e)))}catch(r){throw Fw(r,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,sw(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new hw("endAt",t,!1)}.apply(void 0,e)))}catch(r){throw Fw(r,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return hb(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=eb(t,sb);var e=eb(t.firestore,pb),n=mb(e),r=new Tw(e);return function(t,e){var n=this,r=new jp;return t.asyncQueue.enqueueAndForget((function(){return Ko(n,void 0,void 0,(function(){var n;return Go(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Ko(this,void 0,void 0,(function(){var r,i,o,s,a;return Go(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,py(t,e,!0)];case 1:return a=u.sent(),r=new Ug(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=kg(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,Lv(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new ew(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=eb(t,sb);var e=eb(t.firestore,pb),n=mb(e),r=new Tw(e);return qv(n,t._query,{source:"server"}).then((function(n){return new ew(e,r,t,n)}))}(this._delegate):function(t){t=eb(t,sb);var e=eb(t.firestore,pb),n=mb(e),r=new Tw(e);return iw(t._query),qv(n,t._query).then((function(n){return new ew(e,r,t,n)}))}(this._delegate)).then((function(t){return new $w(e.firestore,new ew(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Vw(e),i=qw(e,(function(e){return new $w(t.firestore,new ew(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return Iw(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Pw.su(this.firestore,e)):this._delegate.withConverter(null))},t}(),zw=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new jw(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),$w=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Bw(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new jw(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new zw(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new jw(n._firestore,r))}))},t.prototype.isEqual=function(t){return rw(this._delegate,t._delegate)},t}(),Kw=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return zo(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Rw(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Rw(this.firestore,void 0===t?cb(this._delegate):cb(this._delegate,t))}catch(e){throw Fw(e,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e,n,r,i,o,s=this;return(e=this._delegate,n=t,r=eb(e.firestore,pb),i=cb(e),o=gw(e.converter,n),Sw(r,[Ab(Ob(e.firestore),"addDoc",i._key,o,null!==e.converter,{}).toMutation(i._key,Yf.exists(!1))]).then((function(){return i}))).then((function(t){return new Rw(s.firestore,t)}))},e.prototype.isEqual=function(t){return lb(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Pw.su(this.firestore,t)):this._delegate.withConverter(null))},e}(Bw);function Gw(t){return eb(t,ob)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ww,Hw=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(bb.bind.apply(bb,Qo([void 0],t)))}return t.documentId=function(){return new t(bh.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=cs(t))instanceof bb&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Qw=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new xb("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Cb("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Lb("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Pb("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=new Rb("increment",e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),Zw={Firestore:Cw,GeoPoint:Eb,Timestamp:hh,Blob:Ow,Transaction:xw,WriteBatch:Lw,DocumentReference:Rw,DocumentSnapshot:Uw,Query:Bw,QueryDocumentSnapshot:jw,QuerySnapshot:$w,CollectionReference:Kw,FieldPath:Hw,FieldValue:Qw,setLogLevel:function(t){var e;e=t,Yl.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};function Yw(t,{delay:e=0,duration:n=400,easing:r=Rt,start:i=0,opacity:o=0}={}){const s=getComputedStyle(t),a=+s.opacity,u="none"===s.transform?"":s.transform,c=1-i,l=a*(1-o);return{delay:e,duration:n,easing:r,css:(t,e)=>`\n\t\t\ttransform: ${u} scale(${1-c*e});\n\t\t\topacity: ${a-l*e}\n\t\t`}}function Jw(t,e,n={}){const r=getComputedStyle(t),i="none"===r.transform?"":r.transform,o=e.from.width/t.clientWidth,s=e.from.height/t.clientHeight,a=(e.from.left-e.to.left)/o,u=(e.from.top-e.to.top)/s,l=Math.sqrt(a*a+u*u),{delay:h=0,duration:f=(t=>120*Math.sqrt(t)),easing:d=Rt}=n;return{delay:h,duration:c(f)?f(l):f,easing:d,css:(t,e)=>`transform: ${i} translate(${e*a}px, ${e*u}px);`}}(Ww=Vs).INTERNAL.registerComponent(new ls("firestore",(function(t){return function(t,e){return new Cw(t,new pb(t,e),new Aw)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Zw))),Ww.registerVersion("@firebase/firestore","2.3.2");export{ut as $,o as A,gt as B,Pt as C,et as D,N as E,U as F,E as G,r as H,h as I,f as J,p as K,q as L,C as M,u as N,qt as O,Fi as P,Uo as Q,_ as R,xt as S,x as T,js as U,j as V,m as W,c as X,H as Y,Q as Z,W as _,L as a,Et as a0,St as a1,Jw as a2,Yw as a3,It as a4,M as b,P as c,S as d,k as e,I as f,R as g,V as h,Mt as i,Nt as j,O as k,A as l,Dt as m,F as n,Ot as o,_t as p,kt as q,wt as r,l as s,D as t,vt as u,bt as v,At as w,tt as x,X as y,J as z};
